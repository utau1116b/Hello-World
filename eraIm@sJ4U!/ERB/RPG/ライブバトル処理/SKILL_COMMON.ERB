;MPチェック
;ARG:0	対象キャラ
;ARG:1	消費量
;RETURN 0:足りない	1:足りてる
@CHECK_MP(ARG:0, ARG:1)
LOCAL:0 = ARG:1
IF CFLAG:(ARG:0):消費ハート軽減
	LOCAL:0 = LOCAL:0 * (100 - CFLAG:(ARG:0):消費ハート軽減) / 100
ENDIF
IF BASE:(ARG:0):MP < LOCAL:0
	RETURN 0
ELSE
	RETURN 1
ENDIF


@SHOW_SKILL_NOWAIT(ARG:0, ARG:1)

;TRYCCALLFORM SHOW_SKILL_EXPLAIN_{ARG:1}(ARG:0)
;	RETURN RESULT
;CATCH
;	PRINTL このスキルの説明表示は未実装です
;	RETURN 0
;ENDCATCH

;消費MP表示
;ARG:0	対象キャラ登録番号
;ARG:1	元の消費MP
@SHOW_EXPEND_MP(ARG:0, ARG:1)
LOCAL:0 = ARG:1
IF CFLAG:(ARG:0):消費ハート軽減
	LOCAL:0 = LOCAL:0 * (100 - CFLAG:(ARG:0):消費ハート軽減) / 100
	PRINTFORM 消費
	CALL HEARTMARK_P
	PRINTFORML ：{LOCAL:0}({ARG:1})
ELSE
	PRINTFORM 消費
	CALL HEARTMARK_P
	PRINTFORML ：{ARG:1}
ENDIF

;集中開始の共通処理
;ARG:0	対象キャラ登録番号
@START_CONCENTRATE(ARG:0)
;集中フラグ
CFLAG:(ARG:0):集中フラグ = 1
PRINTFORML %CALLNAME:(ARG:0)%は集中しはじめた！
CALL BMSG_WAIT(1)

;ショップ画面からスキルを使うとき
@USE_SKILL_IN_STAGE
;初期化
LOCAL:0 = 0
LOCAL:1 = 0

$START
DRAWLINE
PRINTL 誰の特技を使用しますか？
DRAWLINE

;PTメンバー表示
FOR LOCAL:1, 80, 85
	IF FLAG:(LOCAL:1 + 1000) > 0
		PRINTFORML [{LOCAL:1 - 79}] %CALLNAME:(FLAG:(LOCAL:1 + 1000)),10,LEFT% Lv{BASE:(FLAG:(LOCAL:1 + 1000)):戦闘レベル,2}
	ENDIF
NEXT
PRINTL [0] 戻る

$INPUT_LOOP
INPUT

IF RESULT == 0
	RETURN
ELSEIF RESULT >= 1 && RESULT <= 5 && FLAG:(RESULT + 1079) >= 0
	CALL SHOW_SKILL_LIST(FLAG:(RESULT + 1079))
ELSE
	REUSELASTLINE 入力値が不正です。再入力してください
	GOTO INPUT_LOOP
ENDIF

GOTO START