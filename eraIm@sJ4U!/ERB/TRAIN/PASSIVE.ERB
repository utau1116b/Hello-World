;--------------------------------------------------------------------------------------------------
;パートナーのターン追加（元々は誘うコマンド）
;パートナーのターン追加コンフィグをONにすることでコマンド選択前にパートナーが行動するようになります
;--------------------------------------------------------------------------------------------------
@PASSIVE_NAME
;TFLAG:53 何をされるかの内容名称
TSTR:0 = 何もしない
TSTR:1 = 臍を舐める
TSTR:2 = 背中を舐める
TSTR:3 = 首筋を舐める
TSTR:4 = 耳を舐める
TSTR:5 = 乳首を舐める
TSTR:6 = 前から抱きつく
TSTR:7 = 後ろから抱きつく
TSTR:8 = バードキス
TSTR:9 = ソフトキス
TSTR:10 = ディープキス
TSTR:11 = 目元を舐める
TSTR:12 = 頭を撫でる
TSTR:13 = 膝枕をしてもらう
TSTR:14 = 膝枕される
TSTR:15 = 愛を囁く
TSTR:16 = 擽る
TSTR:17 = 寄り添う
TSTR:18 = 指フェラ
TSTR:19 = 指フェラさせられる
TSTR:20 = 髪の毛に顔を埋める
TSTR:21 = 微笑む
TSTR:22 = 談笑する
TSTR:23 = 視姦
TSTR:24 = 尻を撫でる
TSTR:25 = 太ももを撫でる

TSTR:31 = 玉揉み
TSTR:32 = 竿扱き
TSTR:33 = 玉含み
TSTR:34 = フェラチオ
TSTR:35 = 秘裂なぞり
TSTR:36 = 陰核擦り
TSTR:37 = 秘裂舐め
TSTR:38 = 秘裂舌挿入
TSTR:39 = パイズリ
TSTR:40 = 性器擦り合い

TSTR:41 = 顔面騎乗クンニ
TSTR:42 = 顔面騎乗アナル
TSTR:43 = 手で愛撫させる
TSTR:44 = 胸を揉ませる
TSTR:45 = 胸を舌で愛撫させる
TSTR:46 = ぱふぱふ

@BEFORE_PASSIVE
;TFLAG:53 何をされるかの内容部分
;TFLAG:54 コマンド入力ミス時に1

;暫定的に確率は均等化、後に経験、素質、ソース等から優劣を付加する予定
;→暫定的に主導権基準値等をもとにかなり低ければソフト系のみ、かなり高ければハード系のみ選択される処理追加
;また、絶頂、射精に関わるコマンドは随時追加予定

;パートナーのターン追加コンフィグOFFならRETURN
;●友情パッチ用改変
;暫定的に友情パッチ適用キャラもスルー
SIF (FLAG:62 & 1p4) == 0 || IS_友情(TARGET)
	RETURN 0
;●ここまで

;緊縛中、触手中は、暫定的に何もできない（後に専用反応を追加予定）
IF TEQUIP:90 || TEQUIP:43 || TEQUIP:44 || TEQUIP:45
	TFLAG:53 = 0
	RETURN 0
ENDIF

;誘うコマンド内容決定。TFLAG:53に代入
SIF TFLAG:53 <= 0
	CALL GET_PASSIVE_NO

IF TFLAG:53 && FLAG:6 && (CFLAG:99 & 2) == 0
	DRAWLINE
	PRINTL 
	;キャラ別誘うコマンド口上呼び出し
	TRYCCALLFORM KOJO_PASSIVE_K{NO:TARGET}
	CATCH
		;キャラ別誘うコマンド口上がないなら地の文表示
		CALL PASSIVE_MESSAGE
	ENDCATCH
	PRINTL 
	DRAWLINE
ENDIF

RETURN 1

;コマンド内容地の文呼び出し
@PASSIVE_MESSAGE
CALLFORM PASSIVE_MESSAGE_{TFLAG:53}

;誘うコマンド内容決定
@GET_PASSIVE_NO
;@GET_BOSS_NOと同じ、選択可能なコマンドをF:0〜に順番に追加していき最後にRANDで選ぶ方式
VARSET LOCAL, 0
VARSET F, 0
;SKIPDISPを1にして地の文が表示されないようにする
SKIPDISP 1
FOR LOCAL, 0, 50
	;コマンドがあるかメッセージの有無で判別
	TRYCCALLFORM PASSIVE_MESSAGE_{LOCAL}
		;コマンドがあったら誘うコマンド内容実行判定
		TFLAG:53 = LOCAL
		CALL BEFORE_PASSIVE_ABLE
		IF RESULT == 1
			F:(LOCAL:1) = LOCAL
			LOCAL:1 += 1
		ENDIF
	CATCH
		;メッセージないならCONTINUE
		CONTINUE
	ENDCATCH
NEXT
;SKIPDISP解除
SKIPDISP 0

LOCAL:2 = RAND:(LOCAL:1)
TFLAG:53 = F:(LOCAL:2)

;誘うコマンド内容実行判定
@BEFORE_PASSIVE_ABLE
;非ウフフ中
IF TFLAG:44 == 0
	;親密Lv10以上もしくは好感度5000以上の場合、接触有ソフト系、接触無ソフト系はOK
	IF ABL:0 >= 10 || CFLAG:2 > 5000
		;ハード系コマンドはダメ
		SIF TFLAG:53 >= 31
			RETURN 0
	ELSE
		;上の条件を満たしていない場合、接触無ソフト系以外はダメ
		SIF TFLAG:53 != 21 && TFLAG:53 != 22
			RETURN 0
	ENDIF
;ウフフ中
ELSE
	;コマンド選択基準値を計算して0以下ならハード系コマンドはダメ。200以上ならソフト系コマンドはダメ
	CALL PASSIVE_RATE
	SIF A <= 0 && (TFLAG:53 >= 31)
		RETURN 0
	SIF A >= 200 && (TFLAG:53 <= 30)
		RETURN 0
ENDIF

;愛を囁くは恋慕がないとダメ
SIF TALENT:85 == 0 && TFLAG:53 == 15
	RETURN 0
;汚れ無視がなく、性器に我慢できない汚れが付いている場合は顔面騎乗クンニ、胸を舌で愛撫させる、ぱふぱふはダメ
SIF STAIN:Ｖ & 14 && TALENT:MASTER:64 == 0 && (TFLAG:53 == 41 || TFLAG:53 == 45 || TFLAG:53 == 46)
	RETURN 0
;調教者がオトコで、秘裂愛撫系コマンドはダメ
SIF TALENT:PLAYER:122 && TFLAG:53 >= 35 && TFLAG:53 <= 38
	RETURN 0
;調教者にティムティムがなく、フェラ系コマンドはダメ
SIF (TALENT:PLAYER:122 == 0 && TALENT:PLAYER:121 == 0) && ((TFLAG:53 >= 31 && TFLAG:53 <= 34) || TFLAG:53 == 39)
	RETURN 0
;フェラ未経験の場合、フェラ系コマンドはダメ
SIF EXP:22 == 0 && ((TFLAG:53 >= 31 && TFLAG:53 <= 34) || TFLAG:53 == 39)
	RETURN 0
;アナル経験不足または汚れ無視がない場合、アナル系コマンドはダメ
SIF (EXP:1 < 100 || TALENT:PLAYER:64 == 0) && TFLAG:53 == 42
	RETURN 0
;キス未経験の場合、キスはダメ
SIF EXP:96 == 0 && TFLAG:53 >= 8 && TFLAG:53 <= 10
	RETURN 0
;パートナーがオトコで、顔面騎乗クンニ、胸を使うコマンドはダメ
SIF TALENT:TARGET:122 && TFLAG:53 >= 35 && (TFLAG:53 <= 39 || TFLAG:53 == 41 || TFLAG:53 == 44 || TFLAG:53 == 45 || TFLAG:53 == 46)
	RETURN 0
;該当しなければそのコマンドはOK
RETURN 1

;-------------------------------------------------
;ソース処理
;-------------------------------------------------
@PASSIVE_TURN
;TFLAG:53(コマンド内容）が0（何もしない）ならRETURN
SIF TFLAG:53 == 0
	RETURN 0

;行動内容によってソース処理を分化。
TRYCCALLFORM PASSIVE_T{TFLAG:53}
CATCH
	;行動内容別ソース処理がないならその他
	CALL PASSIVE_ETC
ENDCATCH

;TFLAG:53初期化
TFLAG:53 = 0

;---------------------------------------------------------
;コマンド選択基準値を計算してAに代入
;---------------------------------------------------------
@PASSIVE_RATE
VARSET A, 0
;主導権基準値
T = TARGET
CALL GET_INITIATIVE_RATE
A = R

;主導権
IF TFLAG:45 == 1
	;パートナーに主導権
	A += 30
ELSE
	;主人公に主導権
	A -= 30
ENDIF

;ランダムでA増加
A += RAND:50

;ABL関係は2/3にして影響力低下
;欲望
A += ABL:1*2/3
;奉仕精神
A += ABL:6*2/3

;欲情
IF PALAM:5 < PALAMLV:1
	A += 0
ELSEIF PALAM:5 < PALAMLV:2
	A += 3
ELSEIF PALAM:5 < PALAMLV:3
	A += 6
ELSEIF PALAM:5 < PALAMLV:4
	A += 9
ELSEIF PALAM:5 < PALAMLV:5
	A += 12
ELSEIF PALAM:5 < PALAMLV:6
	A += 15
ELSEIF PALAM:5 < PALAMLV:7
	A += 18
ELSEIF PALAM:5 < PALAMLV:8
	A += 21
ELSEIF PALAM:5 < PALAMLV:9
	A += 24
ELSEIF PALAM:5 < 500000
	A += 27
ELSEIF PALAM:5 < 1000000
	A += 30
ELSEIF PALAM:5 < 5000000
	A += 33
ELSEIF PALAM:5 < 10000000
	A += 36
ELSE
	A += 39
ENDIF
;恐怖
IF PALAM:10 < PALAMLV:1
	A -= 0
ELSEIF PALAM:10 < PALAMLV:2
	A -= 1
ELSEIF PALAM:10 < PALAMLV:3
	A -= 4
ELSEIF PALAM:10 < PALAMLV:4
	A -= 9
ELSEIF PALAM:10 < PALAMLV:5
	A -= 16
ELSEIF PALAM:10 < PALAMLV:6
	A -= 25
ELSEIF PALAM:10 < PALAMLV:7
	A -= 36
ELSEIF PALAM:10 < PALAMLV:8
	A -= 49
ELSEIF PALAM:10 < PALAMLV:9
	A -= 64
ELSEIF PALAM:10 < 500000
	A -= 81
ELSE
	A -= 100
ENDIF
;不快
IF PALAM:12 < PALAMLV:1
	A -= 0
ELSEIF PALAM:12 < PALAMLV:2
	A -= 2
ELSEIF PALAM:12 < PALAMLV:3
	A -= 4
ELSEIF PALAM:12 < PALAMLV:4
	A -= 6
ELSEIF PALAM:12 < PALAMLV:5
	A -= 8
ELSEIF PALAM:12 < PALAMLV:6
	A -= 10
ELSEIF PALAM:12 < PALAMLV:7
	A -= 12
ELSEIF PALAM:12 < PALAMLV:8
	A -= 14
ELSEIF PALAM:12 < PALAMLV:9
	A -= 16
ELSEIF PALAM:12 < 500000
	A -= 18
ELSEIF PALAM:12 < 1000000
	A -= 20
ELSEIF PALAM:12 < 5000000
	A -= 22
ELSEIF PALAM:12 < 10000000
	A -= 24
ELSE
	A -= 26
ENDIF

RETURN 0

;-------------------------------------------------
;誘うコマンド内容地の文
;-------------------------------------------------
;臍を舐める
@PASSIVE_MESSAGE_1
PRINTFORML %CALLNAME:TARGET%は%CALLNAME:PLAYER%のおへそを舌でねぶった…
;背中を舐める
@PASSIVE_MESSAGE_2
PRINTFORML %CALLNAME:TARGET%は%CALLNAME:PLAYER%の背筋を舐め上げた…
;首筋を舐める
@PASSIVE_MESSAGE_3
PRINTFORML %CALLNAME:TARGET%は%CALLNAME:PLAYER%の首筋やうなじに舌を這わせた…
;耳を舐める
@PASSIVE_MESSAGE_4
PRINTFORML %CALLNAME:TARGET%は%CALLNAME:PLAYER%の耳に息を吹きかけ、軽く舐めてから耳たぶを甘噛みした…
;乳首を舐める
@PASSIVE_MESSAGE_5
PRINTFORML %CALLNAME:TARGET%は%CALLNAME:PLAYER%の胸に顔を近付け、
PRINTFORML 乳首に舌を這わせて吸い始めた…
;前から抱きつく
@PASSIVE_MESSAGE_6
PRINTFORM %CALLNAME:TARGET%は
SIF TALENT:85 && TALENT:152
	PRINTFORML 慈愛のこもった表情で
PRINTFORML 正面から%CALLNAME:PLAYER%に抱きついてきた…
;後ろから抱きつく
@PASSIVE_MESSAGE_7
PRINTFORM %CALLNAME:TARGET%は
SIF TALENT:85 && TALENT:152
	PRINTFORML 微笑みを漏らしながら
PRINTFORML 背後から%CALLNAME:PLAYER%の体を抱きしめてきた…
;バードキス
@PASSIVE_MESSAGE_8
A = RAND:3
IF EXP:96 >= 50 && A == 0
	PRINTFORML %CALLNAME:TARGET%は%CALLNAME:PLAYER%と何度も何度も口づけあった…
ELSE
	PRINTFORML %CALLNAME:TARGET%は%CALLNAME:PLAYER%に軽く口づけた…
ENDIF
;ソフトキス
@PASSIVE_MESSAGE_9
PRINTFORML %CALLNAME:TARGET%は%CALLNAME:PLAYER%の口を、自分の口で塞いだ…
;ディープキス
@PASSIVE_MESSAGE_10
A = RAND:2
PRINTFORM %CALLNAME:TARGET%は%CALLNAME:PLAYER%の口腔を隅々まで舐め回
IF EXP:96 >= 50 && A == 0
	PRINTFORML し、ねっとりと舌を絡め、唾液を交換しようとしてきた…
ELSEIF EXP:96 >= 50
	PRINTFORML し、積極的に舌を絡めてきた…
ELSE
	PRINTFORML した…
ENDIF
;目元を舐める
@PASSIVE_MESSAGE_11
PRINTFORML %CALLNAME:TARGET%は%CALLNAME:PLAYER%の目元を舐めた…
;頭を撫でる
@PASSIVE_MESSAGE_12
PRINTFORML %CALLNAME:TARGET%は%CALLNAME:PLAYER%の頭を撫でた…
;膝枕をしてもらう
@PASSIVE_MESSAGE_13
PRINTFORML %CALLNAME:TARGET%は%CALLNAME:PLAYER%に膝枕をしてくれた…
;膝枕される
@PASSIVE_MESSAGE_14
PRINTFORM %CALLNAME:TARGET%は自らの頭を%CALLNAME:PLAYER%の膝の上に乗せ
IF TALENT:85 && TALENT:152
	PRINTFORML すっかりとだらけた表情で身を%CALLNAME:PLAYER%に委ねている…
ELSE
	PRINTFORML 軽く体重を乗せてきた…
ENDIF
;愛を囁く
@PASSIVE_MESSAGE_15
PRINTFORML %CALLNAME:TARGET%は%CALLNAME:PLAYER%の耳元で愛を囁いた…
;擽る
@PASSIVE_MESSAGE_16
PRINTFORML %CALLNAME:TARGET%は%CALLNAME:PLAYER%を擽った…
;寄り添う
@PASSIVE_MESSAGE_17
PRINTFORM %CALLNAME:TARGET%は%CALLNAME:PLAYER%に寄り添
IF TALENT:85 && TALENT:152
	PRINTFORML い、
	PRINTFORML 全身の力を抜いてその身を%CALLNAME:PLAYER%に委ねた…
ELSE
	PRINTFORML った…
ENDIF
;指フェラ
@PASSIVE_MESSAGE_18
PRINTFORM %CALLNAME:TARGET%は
SIF TALENT:85
	PRINT 慈しむような表情で、
PRINTFORML %CALLNAME:PLAYER%の指を咥えて舐め回している…
;指フェラさせられる
@PASSIVE_MESSAGE_19
A = RAND:2
PRINTFORM %CALLNAME:TARGET%は指を数本%CALLNAME:PLAYER%の口元へ差し込
IF (ABL:15 >= 5 || TALENT:83) && A == 0
	PRINTFORML み、
	PRINTFORML 激しく指を突き立て、頬の壁を指の腹で蹂躙した…
ELSEIF TALENT:85 && TALENT:152
	PRINTFORML むと、
	PRINTFORML 熱心に指を頬張る%CALLNAME:PLAYER%に慈愛の籠った眼差しを注ぎながら
	PRINTFORML 指で舌を優しく愛撫し始めた…
ELSE
	PRINTFORML んだ…
ENDIF
;髪の毛に顔を埋める
@PASSIVE_MESSAGE_20
PRINTFORML %CALLNAME:TARGET%は%CALLNAME:PLAYER%を後ろから抱きしめ、髪の香りを堪能した…
;微笑む
@PASSIVE_MESSAGE_21
A = RAND:4
PRINTFORM %CALLNAME:TARGET%は
	IF TALENT:88 && TALENT:89 && A == 0
		PRINTFORM 完全に愛情の篭った眼差しを向けながら
	ELSEIF (TALENT:88 || TALENT:89) && A == 1
		PRINTFORM うっとりとした表情で
	ELSEIF TALENT:85 && TALENT:152 && A == 2
		PRINTFORM 慈しむような表情で
	ELSEIF TALENT:85 || TALENT:152
		PRINTFORM 嬉しそうに
	ELSE
	ENDIF
PRINTFORML %CALLNAME:PLAYER%に微笑んだ…
;談笑する
@PASSIVE_MESSAGE_22
A = RAND:3
IF TALENT:85
	PRINTFORM %CALLNAME:TARGET%は%CALLNAME:PLAYER%に
	IF A == 0
		PRINTFORML 今の気分について聞いてみた…
	ELSEIF A == 1
		PRINTFORML 性についての知識を語り始めた…
	ELSE
		PRINTFORML 優しい微笑みを向けて話しかけた…
	ENDIF
ELSE
	PRINTFORML %CALLNAME:TARGET%は%CALLNAME:PLAYER%に他愛の無い話をかけてきた…
ENDIF
;視姦
@PASSIVE_MESSAGE_23
A = RAND:4
PRINTFORM %CALLNAME:TARGET%は
IF A >= 2
	PRINTFORML %CALLNAME:PLAYER%を潤んだ瞳でじっと見つめている…
ELSE
	
	IF (TALENT:10 || TALENT:14 || TALENT:22 || TALENT:30 || TALENT:32 || TALENT:35 || TALENT:70 || TALENT:71) && A == 0
		PRINTFORM 自身恥ずかしそうに顔を紅潮させつつも
	ELSEIF (TALENT:11 || TALENT:15 || TALENT:23 || TALENT:25 || TALENT:36 || TALENT:83) && A == 0
		PRINTFORM 意地の悪い笑みを浮かべつつ
	ELSEIF TALENT:85
		PRINTFORM いやらしくもうっとりとした視線で
	ENDIF
	PRINTFORML %CALLNAME:PLAYER%の痴態を隅から隅まで見定めている…
ENDIF
;尻を撫でる
@PASSIVE_MESSAGE_24
PRINTFORML %CALLNAME:TARGET%は%CALLNAME:PLAYER%のお尻を撫でてきた…
;太ももを撫でる
@PASSIVE_MESSAGE_25
PRINTFORML %CALLNAME:TARGET%は%CALLNAME:PLAYER%の太ももを撫でてきた…
;玉揉み
@PASSIVE_MESSAGE_31
PRINTFORML %CALLNAME:TARGET%は%CALLNAME:PLAYER%の陰嚢に手を伸ばし優しく揉みほぐしてきた…
;竿扱き
@PASSIVE_MESSAGE_32
PRINTFORML %CALLNAME:TARGET%は期待に満ちた表情で%CALLNAME:PLAYER%の目を見つめながら、
PRINTFORML 丁寧に男性器をしごきあげた…
;玉含み
@PASSIVE_MESSAGE_33
A = RAND:3
PRINTFORM %CALLNAME:TARGET%は
IF A == 0
	PRINTFORML %CALLNAME:PLAYER%の陰嚢を口に含み、舌で転がし始めた…
ELSEIF A == 1
	PRINTFORML %CALLNAME:PLAYER%の玉袋を唇で挟み、頬を窄ませて吸付いた…
ELSE
	PRINTFORML すっぽりと%CALLNAME:PLAYER%の睾丸を咥え込み、
	PRINTFORML 淫らしい水音をたてて吸引し始めた…
ENDIF
;フェラチオ
@PASSIVE_MESSAGE_34
A = RAND:3
PRINTFORM %CALLNAME:TARGET%は
IF A == 0
	PRINTFORML %CALLNAME:PLAYER%のペニスを咥え、唇で亀頭をしごいている…
ELSEIF A == 1
	PRINTFORML 限界まで勃起した%CALLNAME:PLAYER%のペニスを根元まで飲み込み激しく頭を動かしている…
ELSE
	PRINTFORML 喉奥までくわえ込んだペニスを激しく吸引し%CALLNAME:PLAYER%を高めていった…
ENDIF
;秘裂なぞり
@PASSIVE_MESSAGE_35
PRINTFORML %CALLNAME:TARGET%は%CALLNAME:PLAYER%の股間に手を伸ばし、指で秘裂をなぞり始めた…
;陰核擦り
@PASSIVE_MESSAGE_36
PRINTFORML %CALLNAME:TARGET%は期待に満ちた表情で%CALLNAME:PLAYER%の目を見つめながら、
PRINTFORML 充血した陰核を擦り上げた…
;秘裂クンニ
@PASSIVE_MESSAGE_37
PRINTFORML %CALLNAME:TARGET%は%CALLNAME:PLAYER%の秘所に舌を這わせた…
;秘裂舌挿入
@PASSIVE_MESSAGE_38
PRINTFORML %CALLNAME:TARGET%は%CALLNAME:PLAYER%の膣口に唇を重ね、
PRINTFORML 先端を尖らせた舌を膣内へ挿入した…
;パイズリ
@PASSIVE_MESSAGE_39
PRINTFORM %CALLNAME:TARGET%は%CALLNAME:PLAYER%の男性器を胸
IF TALENT:109
	PRINTFORML に押し当てこすりつけている…
ELSEIF TALENT:110
	PRINTFORML で包み込みこすりはじめた…
ELSE
	PRINTFORML ではさんでこすりはじめた…
ENDIF
;性器の擦り合い
@PASSIVE_MESSAGE_40
;調教者がキャラに素股をさせられる
IF TALENT:PLAYER:122
	PRINTFORML %CALLNAME:TARGET%は%CALLNAME:PLAYER%の男性器を太ももではさんで擦り始めた…
;調教者がキャラに素股される
ELSEIF TALENT:122 || TALENT:121
	PRINTFORML %CALLNAME:TARGET%は自身の男性器を%CALLNAME:PLAYER%の太ももに差し込み腰を振い始めた…
;貝合わせ
ELSE
	PRINTFORML %CALLNAME:TARGET%は二人の女性器をぴったり重ねて擦りつけ始めた…
ENDIF
;顔面騎乗クンニ
@PASSIVE_MESSAGE_41
PRINTFORML %CALLNAME:TARGET%は%CALLNAME:PLAYER%の顔面にまたがり陰唇を開いて舐めるように命令した…
;顔面騎乗アナル
@PASSIVE_MESSAGE_42
PRINTFORML %CALLNAME:TARGET%は%CALLNAME:PLAYER%の顔面にまたがりアヌスを舐めるように命令した…
;手で愛撫させる
@PASSIVE_MESSAGE_43
PRINTFORML %CALLNAME:TARGET%は%CALLNAME:PLAYER%に
PRINTFORML 自分の性器を手で愛撫しろと命令した…
;胸を揉ませる
@PASSIVE_MESSAGE_44
PRINTFORM %CALLNAME:TARGET%は%CALLNAME:PLAYER%の手を
IF TALENT:109
	PRINTFORM 控えめな双丘に
ELSEIF TFLAG:110
	PRINTFORM 自慢のバストに
ELSE
	PRINTFORM 整った形の乳房に
ENDIF
PRINTFORML 導いた…
;胸を舌で愛撫させる
@PASSIVE_MESSAGE_45
PRINTFORM %CALLNAME:TARGET%は%CALLNAME:PLAYER%の口元に
IF TALENT:109
	PRINTFORM 控えめな双丘を
ELSEIF TFLAG:110
	PRINTFORM 自慢のバストを
ELSE
	PRINTFORM 整った形の乳房を
ENDIF
PRINTFORML 突き出し口で奉仕するよう誘惑している…
;ぱふぱふ
@PASSIVE_MESSAGE_46
PRINTFORM %CALLNAME:TARGET%は%CALLNAME:PLAYER%の顔を両側から
IF TALENT:109
	PRINTFORM 控えめな双丘で
ELSEIF TFLAG:110
	PRINTFORM 自慢のバストで
ELSE
	PRINTFORM 整った形の乳房で
ENDIF
PRINTFORML 優しく包んだ…

;-------------------------------------------------
;各行動内容のソース処理
;-------------------------------------------------
;バードキス
@PASSIVE_T8
;キス経験で気力消費軽減
IF EXP:96 < 100
	DOWNBASE:1 += 25
ELSEIF EXP:96 < 500
	DOWNBASE:1 += 20
ELSE
	DOWNBASE:1 += 10
ENDIF

;Ｍ感覚を設定している場合快Ｍソース等取得
;SIF FLAG:62 & 4194304
;	CALL SOURCE_M_COM340
	
Y = 0
;愛液の汚れ
SIF STAIN:PLAYER:口 & 1
	Y += 1
;精液の汚れ
SIF STAIN:PLAYER:口 & 4
	Y += 3
;アナルの汚れ
SIF STAIN:PLAYER:口 & 8
	Y += 7
SIF STAIN:PLAYER:口 & 16
	Y += 15

SIF TALENT:61
	Y /= 3
SIF TALENT:62
	Y *= 2

;キスでは汚れがそれほど影響しない
Y /= 2

;上のほうで計算した汚れデータ
SOURCE:8 = Y*20 + 10

;固定で獲得するソース
SOURCE:9 += 500

;ABL:従順をみる
IF ABL:0 <= 1
	SOURCE:9 += (ABL:0 * 65)
ELSEIF ABL:0 <= 3
	SOURCE:9 += 200 + (ABL:0 * 70)
ELSEIF ABL:0 <= 5
	SOURCE:9 += 500 + (ABL:0 * 70)
ELSEIF ABL:0 <= 8
	SOURCE:9 += 700 + (ABL:0 * 80)
ELSEIF ABL:0 <= 11
	SOURCE:9 += 1200 + (ABL:0 * 85)
ELSE
	SOURCE:9 += 2000 + (ABL:0 * 40)
ENDIF

;主導権をチェック
IF TFLAG:45 == 0
	;主導権が主人公側
	;ABL:従順をみる
	IF ABL:0 <= 1
		SOURCE:21 += 300 + (ABL:0 * 50)
	ELSEIF ABL:0 <= 3
		SOURCE:21 += 600 + (ABL:0 * 100)
	ELSEIF ABL:0 <= 5
		SOURCE:21 += 800 + (ABL:0 * 120)
	ELSEIF ABL:0 <= 8
		SOURCE:21 += 1000 + (ABL:0 * 140)
	ELSEIF ABL:0 <= 11
		SOURCE:21 += 1200 + (ABL:0 * 160)
	ELSE
		SOURCE:21 += 1500 + (ABL:0 * 180)
	ENDIF
ELSE
	;主導権が相手側
	;ABL:サドっ気をみる
	IF ABL:15 == 0
		SOURCE:20 += 600
	ELSEIF ABL:15 == 1
		SOURCE:20 += 900
	ELSEIF ABL:15 == 2
		SOURCE:20 += 1200
	ELSEIF ABL:15 == 3
		SOURCE:20 += 1600
	ELSEIF ABL:15 == 4
		SOURCE:20 += 2000
	ELSE
		SOURCE:20 += 1000 + (ABL:15 * 300)
	ENDIF
ENDIF

PRINTFORML %EXPNAME:96%＋１
EXP:96 += 1
EXP:PLAYER:96 += 1

IF TALENT:122 == 0 && TALENT:PLAYER:122 == 0
	PRINTS EXPNAME:40
	PRINTL +1
	EXP:40 += 1
	EXP:PLAYER:40 += 1
ELSEIF TALENT:122 == 1 && TALENT:PLAYER:122 == 1
	PRINTS EXPNAME:41
	PRINTL +1
	EXP:41 += 1
	EXP:PLAYER:41 += 1
ENDIF
STAIN:口 |= STAIN:PLAYER:口
STAIN:PLAYER:口 |= STAIN:口

;ソフトキス
@PASSIVE_T9
;キス経験で気力消費軽減（何度もキスしたがる、の再現だとでも脳内補完）
IF EXP:96 < 100
	DOWNBASE:1 += 50
ELSEIF EXP:96 < 500
	DOWNBASE:1 += 30
ELSE
	DOWNBASE:1 += 15
ENDIF

;Ｍ感覚を設定している場合快Ｍソース等取得
;バードキスの快Ｍソース計算を使用
IF FLAG:62 & 4194304
	;CALL SOURCE_M_COM340
	SOURCE:24 = SOURCE:24 * 4
ENDIF

;固定で獲得するソース
SOURCE:9 += 700

Y = 0
;愛液の汚れ
SIF STAIN:PLAYER:口 & 1
	Y += 1
;精液の汚れ
SIF STAIN:PLAYER:口 & 4
	Y += 3
;アナルの汚れ
SIF STAIN:PLAYER:口 & 8
	Y += 7
SIF STAIN:PLAYER:口 & 16
	Y += 15

SIF TALENT:61
	Y /= 3
SIF TALENT:62
	Y *= 2

;キスでは汚れがそれほど影響しない
Y /= 2

;上のほうで計算した汚れデータ
SOURCE:8 += Y*20 + 10

;ABL:従順をみる
IF ABL:0 <= 1
	SOURCE:9 += (ABL:0 * 80)
ELSEIF ABL:0 <= 3
	SOURCE:9 += 200 + (ABL:0 * 85)
ELSEIF ABL:0 <= 5
	SOURCE:9 += 500 + (ABL:0 * 90)
ELSEIF ABL:0 <= 8
	SOURCE:9 += 700 + (ABL:0 * 100)
ELSEIF ABL:0 <= 11
	SOURCE:9 += 1200 + (ABL:0 * 110)
ELSE
	SOURCE:9 += 2000 + (ABL:0 * 70)
ENDIF


;ABL:奉仕精神をみる
IF ABL:6 == 0
	SOURCE:4 += 50
	SOURCE:5 += 10
ELSEIF ABL:6 == 1
	SOURCE:4 += 150
	SOURCE:5 += 50
ELSEIF ABL:6 == 2
	SOURCE:4 += 200
	SOURCE:5 += 100
ELSEIF ABL:6 == 3
	SOURCE:4 += 250
	SOURCE:5 += 180
ELSEIF ABL:6 == 4
	SOURCE:4 += 300
	SOURCE:5 += 300
ELSE
	SOURCE:4 += 225 + (ABL:6 * 25)
	SOURCE:5 += ABL:6 * 100
ENDIF

;ABL:技巧をみる
IF ABL:2 == 0
	TIMES SOURCE:4 , 0.50
	TIMES SOURCE:5 , 0.50
ELSEIF ABL:2 == 1
	TIMES SOURCE:4 , 0.80
	TIMES SOURCE:5 , 0.80
ELSEIF ABL:2 == 2
	TIMES SOURCE:4 , 1.00
	TIMES SOURCE:5 , 1.00
ELSEIF ABL:2 == 3
	TIMES SOURCE:4 , 1.50
	TIMES SOURCE:5 , 1.50
ELSEIF ABL:2 == 4
	TIMES SOURCE:4 , 2.50
	TIMES SOURCE:5 , 2.50
ELSE
	SOURCE:4 = SOURCE:4 * (ABL:2 * 75 + 25) / 100
	SOURCE:5 = SOURCE:5 * (ABL:2 * 75 + 25) / 100
ENDIF

;プレイヤーのABL:技巧をみる
IF ABL:PLAYER:2 == 0
	SOURCE:3 += 100
	SOURCE:10 += 0
ELSEIF ABL:PLAYER:2 == 1
	SOURCE:3 += 150
	SOURCE:10 += 0
ELSEIF ABL:PLAYER:2 == 2
	SOURCE:3 += 200
	SOURCE:10 += 0
ELSEIF ABL:PLAYER:2 == 3
	SOURCE:3 += 300
	SOURCE:10 += 50
ELSEIF ABL:PLAYER:2 == 4
	SOURCE:3 += 500
	SOURCE:10 += 100
ELSE
	SOURCE:3 += 50 + (ABL:PLAYER:2 * 150)
	SOURCE:10 += (ABL:PLAYER:2 * 50) - 50
ENDIF

;TALENT:恋慕をみる
SIF TALENT:85
	TIMES SOURCE:3 , 1.50
;TALENT:恋人をみる
SIF TALENT:153
	TIMES SOURCE:3 , 1.50
;TALENT:親愛をみる
SIF TALENT:88
	TIMES SOURCE:3 , 2.00


;キスの種類補正		面倒なんで、殆どのソースをコピペして、ここだけ弄ってみる
TIMES SOURCE:3 , 0.60
TIMES SOURCE:4 , 0.60
TIMES SOURCE:5 , 0.60
TIMES SOURCE:10 , 0.60



;主導権をチェック
IF TFLAG:45 == 0
	;主導権が主人公側
	;ABL:従順をみる
	IF ABL:0 <= 1
		SOURCE:21 += 300 + (ABL:0 * 50)
	ELSEIF ABL:0 <= 3
		SOURCE:21 += 600 + (ABL:0 * 100)
	ELSEIF ABL:0 <= 5
		SOURCE:21 += 800 + (ABL:0 * 120)
	ELSEIF ABL:0 <= 8
		SOURCE:21 += 1000 + (ABL:0 * 140)
	ELSEIF ABL:0 <= 11
		SOURCE:21 += 1200 + (ABL:0 * 160)
	ELSE
		SOURCE:21 += 1500 + (ABL:0 * 180)
	ENDIF
ELSE
	;主導権が相手側
	;ABL:サドっ気をみる
	IF ABL:15 == 0
		SOURCE:20 += 600
	ELSEIF ABL:15 == 1
		SOURCE:20 += 900
	ELSEIF ABL:15 == 2
		SOURCE:20 += 1200
	ELSEIF ABL:15 == 3
		SOURCE:20 += 1600
	ELSEIF ABL:15 == 4
		SOURCE:20 += 2000
	ELSE
		SOURCE:20 += 1000 + (ABL:15 * 300)
	ENDIF
ENDIF

PRINTFORML %EXPNAME:96%＋１
EXP:96 += 1
EXP:PLAYER:96 += 1

IF TALENT:122 == 0 && TALENT:PLAYER:122 == 0
	PRINTS EXPNAME:40
	PRINTL +2
	EXP:40 += 2
	EXP:PLAYER:40 += 2
ELSEIF TALENT:122 == 1 && TALENT:PLAYER:122 == 1
	PRINTS EXPNAME:41
	PRINTL +2
	EXP:41 += 2
	EXP:PLAYER:41 += 2
ENDIF
STAIN:口 |= STAIN:PLAYER:口
STAIN:PLAYER:口 |= STAIN:口

;ディープキス
@PASSIVE_T10
;キス経験で気力消費軽減（何度もキスしたがる、の再現だとでも脳内補完）
IF EXP:96 < 100
	DOWNBASE:1 += 50
ELSEIF EXP:96 < 500
	DOWNBASE:1 += 40
ELSE
	DOWNBASE:1 += 25
ENDIF

;Ｍ感覚を設定している場合快Ｍソース等取得
;バードキスの快Ｍソース計算を使用
IF FLAG:62 & 4194304
	;CALL SOURCE_M_COM340
	SOURCE:24 = SOURCE:24 * 10
ENDIF

;固定で獲得するソース
SOURCE:9 += 900

Y = 0
;愛液の汚れ
SIF STAIN:PLAYER:口 & 1
	Y += 1
;精液の汚れ
SIF STAIN:PLAYER:口 & 4
	Y += 3
;アナルの汚れ
SIF STAIN:PLAYER:口 & 8
	Y += 7
SIF STAIN:PLAYER:口 & 16
	Y += 15

SIF TALENT:61
	Y /= 3
SIF TALENT:62
	Y *= 2

;キスでは汚れがそれほど影響しない
Y /= 2

;上のほうで計算した汚れデータ
SOURCE:8 += Y*20 + 10

;ABL:従順をみる
IF ABL:0 <= 1
	SOURCE:9 += (ABL:0 * 90)
ELSEIF ABL:0 <= 3
	SOURCE:9 += 200 + (ABL:0 * 95)
ELSEIF ABL:0 <= 5
	SOURCE:9 += 500 + (ABL:0 * 100)
ELSEIF ABL:0 <= 8
	SOURCE:9 += 700 + (ABL:0 * 110)
ELSEIF ABL:0 <= 11
	SOURCE:9 += 1200 + (ABL:0 * 125)
ELSE
	SOURCE:9 += 2000 + (ABL:0 * 80)
ENDIF

;ABL:奉仕精神をみる
IF ABL:6 == 0
	SOURCE:4 += 50
	SOURCE:5 += 10
ELSEIF ABL:6 == 1
	SOURCE:4 += 150
	SOURCE:5 += 50
ELSEIF ABL:6 == 2
	SOURCE:4 += 200
	SOURCE:5 += 100
ELSEIF ABL:6 == 3
	SOURCE:4 += 250
	SOURCE:5 += 180
ELSEIF ABL:6 == 4
	SOURCE:4 += 300
	SOURCE:5 += 300
ELSE
	SOURCE:4 += 225 + (ABL:6 * 25)
	SOURCE:5 += ABL:6 * 100
ENDIF

;ABL:技巧をみる
IF ABL:2 == 0
	TIMES SOURCE:4 , 0.50
	TIMES SOURCE:5 , 0.50
ELSEIF ABL:2 == 1
	TIMES SOURCE:4 , 0.80
	TIMES SOURCE:5 , 0.80
ELSEIF ABL:2 == 2
	TIMES SOURCE:4 , 1.00
	TIMES SOURCE:5 , 1.00
ELSEIF ABL:2 == 3
	TIMES SOURCE:4 , 1.50
	TIMES SOURCE:5 , 1.50
ELSEIF ABL:2 == 4
	TIMES SOURCE:4 , 2.50
	TIMES SOURCE:5 , 2.50
ELSE
	SOURCE:4 += SOURCE:4 * (ABL:2 * 75 + 25) / 100
	SOURCE:5 += SOURCE:5 * (ABL:2 * 75 + 25) / 100
ENDIF

;プレイヤーのABL:技巧をみる
IF ABL:PLAYER:2 == 0
	SOURCE:3 += 100
	SOURCE:10 += 0
ELSEIF ABL:PLAYER:2 == 1
	SOURCE:3 += 150
	SOURCE:10 += 0
ELSEIF ABL:PLAYER:2 == 2
	SOURCE:3 += 200
	SOURCE:10 += 0
ELSEIF ABL:PLAYER:2 == 3
	SOURCE:3 += 300
	SOURCE:10 += 50
ELSEIF ABL:PLAYER:2 == 4
	SOURCE:3 += 500
	SOURCE:10 += 100
ELSE
	SOURCE:3 += 50 + (ABL:PLAYER:2 * 150)
	SOURCE:10 += (ABL:PLAYER:2 * 50) - 50
ENDIF

;TALENT:恋慕をみる
SIF TALENT:85
	TIMES SOURCE:3 , 1.50
;TALENT:恋人をみる
SIF TALENT:153
	TIMES SOURCE:3 , 1.50
;TALENT:親愛をみる
SIF TALENT:88
	TIMES SOURCE:3 , 2.00


;キスの種類補正		面倒なんで、殆どのソースをコピペして、ここだけ弄ってみる
TIMES SOURCE:3 , 0.90
TIMES SOURCE:4 , 0.90
TIMES SOURCE:5 , 0.90
TIMES SOURCE:10 , 0.90



;主導権をチェック
IF TFLAG:45 == 0
	;主導権が主人公側
	;ABL:従順をみる
	IF ABL:0 <= 1
		SOURCE:21 += 300 + (ABL:0 * 50)
	ELSEIF ABL:0 <= 3
		SOURCE:21 += 600 + (ABL:0 * 100)
	ELSEIF ABL:0 <= 5
		SOURCE:21 += 800 + (ABL:0 * 120)
	ELSEIF ABL:0 <= 8
		SOURCE:21 += 1000 + (ABL:0 * 140)
	ELSEIF ABL:0 <= 11
		SOURCE:21 += 1200 + (ABL:0 * 160)
	ELSE
		SOURCE:21 += 1500 + (ABL:0 * 180)
	ENDIF
ELSE
	;主導権が相手側
	;ABL:サドっ気をみる
	IF ABL:15 == 0
		SOURCE:20 += 600
	ELSEIF ABL:15 == 1
		SOURCE:20 += 900
	ELSEIF ABL:15 == 2
		SOURCE:20 += 1200
	ELSEIF ABL:15 == 3
		SOURCE:20 += 1600
	ELSEIF ABL:15 == 4
		SOURCE:20 += 2000
	ELSE
		SOURCE:20 += 1000 + (ABL:15 * 300)
	ENDIF
ENDIF

PRINTFORML %EXPNAME:96%＋１
EXP:96 += 1
EXP:PLAYER:96 += 1

IF TALENT:122 == 0 && TALENT:PLAYER:122 == 0
	PRINTS EXPNAME:40
	PRINTL +3
	EXP:40 += 3
	EXP:PLAYER:40 += 3
ELSEIF TALENT:122 == 1 && TALENT:PLAYER:122 == 1
	PRINTS EXPNAME:41
	PRINTL +3
	EXP:41 += 3
	EXP:PLAYER:41 += 3
ENDIF
STAIN:口 |= STAIN:PLAYER:口
STAIN:PLAYER:口 |= STAIN:口

;愛を囁く
@PASSIVE_T15
DOWNBASE:1 += 20

;奉仕精神をみる
IF ABL:6 == 0
	SOURCE:3 += 20
ELSEIF ABL:6 == 1
	SOURCE:3 += 60
ELSEIF ABL:6 == 2
	SOURCE:3 += 160
ELSEIF ABL:6 == 3
	SOURCE:3 += 300
ELSEIF ABL:6 == 4
	SOURCE:3 += 460
ELSE
	SOURCE:3 += 400 + (ABL:6 * 40)
ENDIF

;主導権をチェック
IF TFLAG:45 == 0
	;主導権が主人公側
	;ABL:従順をみる
	IF ABL:0 == 0
		SOURCE:21 += 100
	ELSEIF ABL:0 == 1
		SOURCE:21 += 200
	ELSEIF ABL:0 == 2
		SOURCE:21 += 350
	ELSEIF ABL:0 == 3
		SOURCE:21 += 500
	ELSEIF ABL:0 == 4
		SOURCE:21 += 700
	ELSE
		SOURCE:21 += 1000 + (ABL:0 * 100)
	ENDIF
ELSE
	;主導権が相手側
	;ABL:サドっ気をみる
	IF ABL:15 == 0
		SOURCE:20 += 500
	ELSEIF ABL:15 == 1
		SOURCE:20 += 700
	ELSEIF ABL:15 == 2
		SOURCE:20 += 900
	ELSEIF ABL:15 == 3
		SOURCE:20 += 1100
	ELSEIF ABL:15 == 4
		SOURCE:20 += 1300
	ELSE
		SOURCE:20 += 1000 + (ABL:15 * 150)
	ENDIF
ENDIF

;指フェラ
@PASSIVE_T18
DOWNBASE:1 += 25

SOURCE:13 += 500
SOURCE:14 += 200

;Ｍ感覚を設定している場合快Ｍソース等取得
;SIF FLAG:62 & 4194304
	;CALL SOURCE_M_COM201

Y = 0
;愛液の汚れ
SIF STAIN:PLAYER:手 & 1
	Y += 1
;精液の汚れ
SIF STAIN:PLAYER:手 & 4
	Y += 3
;アナルの汚れ
SIF STAIN:PLAYER:手 & 8
	Y += 7
SIF STAIN:PLAYER:手 & 16
	Y += 15
SIF TALENT:61
	Y /= 3
SIF TALENT:62
	Y *= 2

;上のほうで計算した汚れデータ
SOURCE:8 += Y*20 + 10

;ABL:奉仕精神をみる
IF ABL:6 == 0
	SOURCE:4 += 210
	SOURCE:5 += 100
	TIMES SOURCE:8 , 4.00
ELSEIF ABL:6 == 1
	SOURCE:4 += 250
	SOURCE:5 += 200
	TIMES SOURCE:8 , 2.50
ELSEIF ABL:6 == 2
	SOURCE:4 += 290
	SOURCE:5 += 400
	TIMES SOURCE:8 , 1.50
ELSEIF ABL:6 == 3
	SOURCE:4 += 330
	SOURCE:5 += 600
	TIMES SOURCE:8 , 1.00
ELSEIF ABL:6 == 4
	SOURCE:4 += 370
	SOURCE:5 += 1000
	TIMES SOURCE:8 , 0.50
ELSE
	SOURCE:4 += 310 + (ABL:6 * 20)
	SOURCE:5 += 300 + (ABL:6 * 240)
	TIMES SOURCE:8 , 0.10
ENDIF

;ABL:技巧をみる
IF ABL:2 == 0
	TIMES SOURCE:4 , 0.50
	TIMES SOURCE:5 , 0.50
ELSEIF ABL:2 == 1
	TIMES SOURCE:4 , 0.80
	TIMES SOURCE:5 , 0.80
ELSEIF ABL:2 == 2
	TIMES SOURCE:4 , 1.00
	TIMES SOURCE:5 , 1.00
ELSEIF ABL:2 == 3
	TIMES SOURCE:4 , 1.50
	TIMES SOURCE:5 , 1.50
ELSEIF ABL:2 == 4
	TIMES SOURCE:4 , 2.50
	TIMES SOURCE:5 , 2.50
ELSE
	SOURCE:4 += SOURCE:4 * (ABL:2 * 75 + 25) / 100
	SOURCE:5 += SOURCE:5 * (ABL:2 * 75 + 25) / 100
ENDIF


;主導権をチェック
IF TFLAG:45 == 0
	;主導権が主人公側
	;ABL:従順をみる
	IF ABL:0 <= 1
		SOURCE:21 += 300 + (ABL:0 * 50)
	ELSEIF ABL:0 <= 3
		SOURCE:21 += 600 + (ABL:0 * 100)
	ELSEIF ABL:0 <= 5
		SOURCE:21 += 800 + (ABL:0 * 120)
	ELSEIF ABL:0 <= 8
		SOURCE:21 += 1000 + (ABL:0 * 140)
	ELSEIF ABL:0 <= 11
		SOURCE:21 += 1200 + (ABL:0 * 160)
	ELSE
		SOURCE:21 += 1500 + (ABL:0 * 180)
	ENDIF
ELSE
	;主導権が相手側
	;ABL:サドっ気をみる
	IF ABL:15 == 0
		SOURCE:20 += 600
	ELSEIF ABL:15 == 1
		SOURCE:20 += 900
	ELSEIF ABL:15 == 2
		SOURCE:20 += 1200
	ELSEIF ABL:15 == 3
		SOURCE:20 += 1600
	ELSEIF ABL:15 == 4
		SOURCE:20 += 2000
	ELSE
		SOURCE:20 += 1000 + (ABL:15 * 300)
	ENDIF
ENDIF

;奴隷の口⇔調教者の手の汚れが移動
STAIN:口 |= STAIN:PLAYER:手
STAIN:PLAYER:手 |= STAIN:口

;PRINTFORML %EXPNAME:22%＋１
;EXP:22 += 1

IF TALENT:122 == 0 && TALENT:PLAYER:122 == 0
	PRINTFORML %EXPNAME:40%＋3
	EXP:40 += 3
ENDIF

TFLAG:100 = 1

;微笑む
@PASSIVE_T21
DOWNBASE:1 += 20

;奉仕精神をみる
IF ABL:6 == 0
	SOURCE:3 += 10
ELSEIF ABL:6 == 1
	SOURCE:3 += 30
ELSEIF ABL:6 == 2
	SOURCE:3 += 80
ELSEIF ABL:6 == 3
	SOURCE:3 += 150
ELSEIF ABL:6 == 4
	SOURCE:3 += 230
ELSE
	SOURCE:3 += 200 + (ABL:6 * 20)
ENDIF

;主導権をチェック
IF TFLAG:45 == 0
	;主導権が主人公側
	;ABL:従順をみる
	IF ABL:0 == 0
		SOURCE:21 += 100
	ELSEIF ABL:0 == 1
		SOURCE:21 += 200
	ELSEIF ABL:0 == 2
		SOURCE:21 += 350
	ELSEIF ABL:0 == 3
		SOURCE:21 += 500
	ELSEIF ABL:0 == 4
		SOURCE:21 += 700
	ELSE
		SOURCE:21 += 1000 + (ABL:0 * 100)
	ENDIF
ELSE
	;主導権が相手側
	;ABL:サドっ気をみる
	IF ABL:15 == 0
		SOURCE:20 += 500
	ELSEIF ABL:15 == 1
		SOURCE:20 += 700
	ELSEIF ABL:15 == 2
		SOURCE:20 += 900
	ELSEIF ABL:15 == 3
		SOURCE:20 += 1100
	ELSEIF ABL:15 == 4
		SOURCE:20 += 1300
	ELSE
		SOURCE:20 += 1000 + (ABL:15 * 150)
	ENDIF
ENDIF

;談笑する
@PASSIVE_T22
CALL PASSIVE_T21

;視姦
@PASSIVE_T23
DOWNBASE:1 += 20

;欲情追加
SOURCE:11 += 50

;奉仕精神をみる
IF ABL:6 == 0
	SOURCE:3 += 10
ELSEIF ABL:6 == 1
	SOURCE:3 += 30
ELSEIF ABL:6 == 2
	SOURCE:3 += 80
ELSEIF ABL:6 == 3
	SOURCE:3 += 150
ELSEIF ABL:6 == 4
	SOURCE:3 += 230
ELSE
	SOURCE:3 += 200 + (ABL:6 * 20)
ENDIF

;主導権をチェック
IF TFLAG:45 == 0
	;主導権が主人公側
	;ABL:従順をみる
	IF ABL:0 == 0
		SOURCE:21 += 100
	ELSEIF ABL:0 == 1
		SOURCE:21 += 200
	ELSEIF ABL:0 == 2
		SOURCE:21 += 350
	ELSEIF ABL:0 == 3
		SOURCE:21 += 500
	ELSEIF ABL:0 == 4
		SOURCE:21 += 700
	ELSE
		SOURCE:21 += 1000 + (ABL:0 * 100)
	ENDIF
ELSE
	;主導権が相手側
	;ABL:サドっ気をみる
	IF ABL:15 == 0
		SOURCE:20 += 500
	ELSEIF ABL:15 == 1
		SOURCE:20 += 700
	ELSEIF ABL:15 == 2
		SOURCE:20 += 900
	ELSEIF ABL:15 == 3
		SOURCE:20 += 1100
	ELSEIF ABL:15 == 4
		SOURCE:20 += 1300
	ELSE
		SOURCE:20 += 1000 + (ABL:15 * 150)
	ENDIF
ENDIF

;玉揉み
@PASSIVE_T31
;-------------------------------------------------
;射精ゲージチェック
;-------------------------------------------------
B = 0

;ABL:技巧をみる
IF ABL:2 <= 1
	B = 200 + ABL:2 * 100
ELSEIF ABL:2 <= 3
	B = 300 + ABL:2 * 100
ELSEIF ABL:2 <= 5
	B = 300 + ABL:2 * 150
ELSEIF ABL:2 <= 8
	B = 500 + ABL:2 * 150
ELSEIF ABL:2 <= 11
	B = 200 + ABL:2 * 200
ELSE
	B = 500 + ABL:2 * 200
ENDIF

;ABL:従順をみる
IF ABL:0 <= 1
	TIMES B , 0.80
ELSEIF ABL:0 <= 3
	TIMES B , 0.90
ELSEIF ABL:0 <= 5
	TIMES B , 1.00
ELSEIF ABL:0 <= 8
	TIMES B , 1.10
ELSEIF ABL:0 <= 11
	TIMES B , 1.20
ELSE
	B = B * (ABL:0 * 2 + 105) / 100
ENDIF

;ABL:奉仕精神をみる
IF ABL:6 <= 1
	TIMES B , 0.50
ELSEIF ABL:6 <= 3
	TIMES B , 0.80
ELSEIF ABL:6 <= 5
	TIMES B , 1.20
ELSEIF ABL:6 <= 8
	TIMES B , 1.50
ELSEIF ABL:6 <= 11
	TIMES B , 1.80
ELSE
	B = B * (ABL:6 * 10 + 90) / 100
ENDIF

;プレイヤーのABL:Ｃ感覚をみる
IF ABL:PLAYER:3 == 0
	TIMES B , 1.00
ELSEIF ABL:PLAYER:3 == 1
	TIMES B , 1.50
ELSEIF ABL:PLAYER:3 == 2
	TIMES B , 2.00
ELSEIF ABL:PLAYER:3 == 3
	TIMES B , 2.50
ELSEIF ABL:PLAYER:3 == 4
	TIMES B , 3.50
ELSE
	B = B * ABL:PLAYER:3
ENDIF

SIF TALENT:PLAYER:119 || TALENT:PLAYER:122  || TALENT:PLAYER:121
	BASE:PLAYER:2 += B

;-------------------------------------------------
;ソースの計算
;-------------------------------------------------
DOWNBASE:1 += 50

SOURCE:13 += 500
SOURCE:14 += 100
Y = 0
;愛液の汚れ
SIF STAIN:PLAYER:Ｐ & 1
	Y += 1
;精液の汚れ
SIF STAIN:PLAYER:Ｐ & 4
	Y += 3
;アナルの汚れ
SIF STAIN:PLAYER:Ｐ & 8
	Y += 7
SIF STAIN:PLAYER:Ｐ & 16
	Y += 15

SIF TALENT:61
	Y /= 3
SIF TALENT:62
	Y *= 2

;手淫では汚れがそれほど影響しない
Y /= 3
;上のほうで計算した汚れデータ
SOURCE:8 += Y*5 + 20

;ABL:奉仕精神をみる
IF ABL:6 == 0
	SOURCE:4 += 250
	SOURCE:5 += 50
	TIMES SOURCE:8 , 4.00
ELSEIF ABL:6 == 1
	SOURCE:4 += 300
	SOURCE:5 += 100
	TIMES SOURCE:8 , 2.50
ELSEIF ABL:6 == 2
	SOURCE:4 += 350
	SOURCE:5 += 200
	TIMES SOURCE:8 , 1.50
ELSEIF ABL:6 == 3
	SOURCE:4 += 400
	SOURCE:5 += 300
	TIMES SOURCE:8 , 1.00
ELSEIF ABL:6 == 4
	SOURCE:4 += 450
	SOURCE:5 += 500
	TIMES SOURCE:8 , 0.50
ELSE
	SOURCE:4 += 375 + (ABL:6 * 25)
	SOURCE:5 += 125 + (ABL:6 * 125)
	TIMES SOURCE:8 , 0.10
ENDIF


;ABL:技巧をみる
IF ABL:2 == 0
	TIMES SOURCE:4 , 0.50
	TIMES SOURCE:5 , 0.50
ELSEIF ABL:2 == 1
	TIMES SOURCE:4 , 0.80
	TIMES SOURCE:5 , 0.80
ELSEIF ABL:2 == 2
	TIMES SOURCE:4 , 1.00
	TIMES SOURCE:5 , 1.00
ELSEIF ABL:2 == 3
	TIMES SOURCE:4 , 1.20
	TIMES SOURCE:5 , 1.20
ELSEIF ABL:2 == 4
	TIMES SOURCE:4 , 1.50
	TIMES SOURCE:5 , 1.50
ELSE
	SOURCE:4 = SOURCE:4 * (ABL:2 * 25 + 75) / 100
	SOURCE:5 = SOURCE:5 * (ABL:2 * 25 + 75) / 100
ENDIF


;主導権をチェック
IF TFLAG:45 == 0
	;主導権が主人公側
	;ABL:従順をみる
	IF ABL:0 <= 1
		SOURCE:21 += 300 + (ABL:0 * 50)
	ELSEIF ABL:0 <= 3
		SOURCE:21 += 600 + (ABL:0 * 100)
	ELSEIF ABL:0 <= 5
		SOURCE:21 += 800 + (ABL:0 * 120)
	ELSEIF ABL:0 <= 8
		SOURCE:21 += 1000 + (ABL:0 * 140)
	ELSEIF ABL:0 <= 11
		SOURCE:21 += 1200 + (ABL:0 * 160)
	ELSE
		SOURCE:21 += 1500 + (ABL:0 * 180)
	ENDIF
ELSE
	;主導権が相手側
	;ABL:サドっ気をみる
	IF ABL:15 == 0
		SOURCE:20 += 800
	ELSEIF ABL:15 == 1
		SOURCE:20 += 1100
	ELSEIF ABL:15 == 2
		SOURCE:20 += 1400
	ELSEIF ABL:15 == 3
		SOURCE:20 += 1800
	ELSEIF ABL:15 == 4
		SOURCE:20 += 2300
	ELSE
		SOURCE:20 += 1000 + (ABL:15 * 350)
	ENDIF
ENDIF

;-------------------------------------------------
;読心手淫の場合効果アップ（2倍）
;-------------------------------------------------

;対象が恋慕さとりだと変化
IF NAME_CSV(NO:TARGET, 0) == "さとり" && TALENT:85
	TIMES SOURCE:4 , 2.00
	TIMES SOURCE:5 , 2.00
	SIF TALENT:PLAYER:119 || TALENT:PLAYER:122  || TALENT:PLAYER:121
		BASE:PLAYER:2 += B
ENDIF
;奴隷の指⇔調教者のＰの汚れが移動
IF TALENT:PLAYER:119 || TALENT:PLAYER:122  || TALENT:PLAYER:121
	STAIN:手 |= STAIN:PLAYER:Ｐ
	STAIN:PLAYER:Ｐ |= STAIN:手
;奴隷の指⇔調教者のＶの汚れが移動
ELSE
	STAIN:Ｖ |= STAIN:PLAYER:Ｐ
	STAIN:PLAYER:Ｐ |= STAIN:Ｖ
ENDIF

IF TALENT:122 == 0 && TALENT:PLAYER:122 == 0
	PRINTS EXPNAME:40
	PRINTL +4
	EXP:40 += 4
	EXP:PLAYER:40 += 4
ELSEIF TALENT:122 == 1 && TALENT:PLAYER:122 == 1
	PRINTS EXPNAME:41
	PRINTL +4
	EXP:41 += 4
	EXP:PLAYER:41 += 4
ENDIF

TFLAG:100 = 1

;調教者がふたなり
IF TALENT:PLAYER:121
	SOURCE:13 /= 2
ENDIF

;竿扱き
@PASSIVE_T32
CALL PASSIVE_T31

;玉含み
@PASSIVE_T33
;-------------------------------------------------
;射精ゲージチェック
;-------------------------------------------------
B = 0

;ABL:技巧をみる
IF ABL:2 <= 1
	B = 400 + ABL:2 * 130
ELSEIF ABL:2 <= 3
	B = 600 + ABL:2 * 150
ELSEIF ABL:2 <= 5
	B = 600 + ABL:2 * 180
ELSEIF ABL:2 <= 8
	B = 1000 + ABL:2 * 200
ELSEIF ABL:2 <= 11
	B = 400 + ABL:2 * 240
ELSE
	B = 1000 + ABL:2 * 250
ENDIF

;ABL:従順をみる
IF ABL:0 <= 1
	TIMES B , 0.80
ELSEIF ABL:0 <= 3
	TIMES B , 0.90
ELSEIF ABL:0 <= 5
	TIMES B , 1.00
ELSEIF ABL:0 <= 8
	TIMES B , 1.10
ELSEIF ABL:0 <= 11
	TIMES B , 1.20
ELSE
	B = B * (ABL:0 * 2 + 105) / 100
ENDIF

;ABL:奉仕精神をみる
IF ABL:6 <= 1
	TIMES B , 0.50
ELSEIF ABL:6 <= 3
	TIMES B , 0.80
ELSEIF ABL:6 <= 5
	TIMES B , 1.20
ELSEIF ABL:6 <= 8
	TIMES B , 1.50
ELSEIF ABL:6 <= 11
	TIMES B , 1.80
ELSE
	B = B * (ABL:6 * 10 + 90) / 100
ENDIF

;ABL:精液中毒をみる
IF ABL:11 == 0
	TIMES B , 1.00
ELSEIF ABL:11 == 1
	TIMES B , 1.20
ELSEIF ABL:11 == 2
	TIMES B , 1.30
ELSEIF ABL:11 == 3
	TIMES B , 1.50
ELSEIF ABL:11 == 4
	TIMES B , 1.70
ELSE
	B = B * (ABL:11 * 15 + 125) / 100
ENDIF

;TALENT:舌使いをみる
SIF TALENT:52
	TIMES B , 2.00

;プレイヤーのABL:Ｃ感覚をみる
IF ABL:PLAYER:3 == 0
	TIMES B , 1.00
ELSEIF ABL:PLAYER:3 == 1
	TIMES B , 1.50
ELSEIF ABL:PLAYER:3 == 2
	TIMES B , 2.00
ELSEIF ABL:PLAYER:3 == 3
	TIMES B , 2.50
ELSEIF ABL:PLAYER:3 == 4
	TIMES B , 3.50
ELSE
	B = B * ABL:PLAYER:3
ENDIF

SIF TALENT:PLAYER:119 || TALENT:PLAYER:122  || TALENT:PLAYER:121
	BASE:PLAYER:2 += B


;-------------------------------------------------
;ソースの計算
;-------------------------------------------------
DOWNBASE:1 += 70

SOURCE:13 += 1500
SOURCE:14 += 500

Y = 0
;愛液の汚れ
SIF STAIN:PLAYER:Ｐ & 1
	Y += 1
;精液の汚れ
SIF STAIN:PLAYER:Ｐ & 4
	Y += 3
;アナルの汚れ
SIF STAIN:PLAYER:Ｐ & 8
	Y += 7
SIF STAIN:PLAYER:Ｐ & 16
	Y += 15

SIF TALENT:61
	Y /= 3
SIF TALENT:62
	Y *= 2
	
;上のほうで計算した汚れデータ
SOURCE:8 = Y*20 + 50

;Ｍ感覚を設定している場合快Ｍソース等取得
;SIF FLAG:62 & 4194304
;	CALL SOURCE_M_COM31

;ABL:奉仕精神をみる
IF ABL:6 == 0
	SOURCE:4 += 420
	SOURCE:5 += 150
	TIMES SOURCE:8 , 4.00
ELSEIF ABL:6 == 1
	SOURCE:4 += 500
	SOURCE:5 += 300
	TIMES SOURCE:8 , 2.50
ELSEIF ABL:6 == 2
	SOURCE:4 += 580
	SOURCE:5 += 600
	TIMES SOURCE:8 , 1.50
ELSEIF ABL:6 == 3
	SOURCE:4 += 660
	SOURCE:5 += 900
	TIMES SOURCE:8 , 1.00
ELSEIF ABL:6 == 4
	SOURCE:4 += 740
	SOURCE:5 += 1500
	TIMES SOURCE:8 , 0.50
ELSE
	SOURCE:4 += 620 + (ABL:6 * 40)
	SOURCE:5 += 450 + (ABL:6 * 350)
	TIMES SOURCE:8 , 0.10
ENDIF

;ABL:技巧をみる
IF ABL:2 == 0
	TIMES SOURCE:4 , 0.50
	TIMES SOURCE:5 , 0.50
ELSEIF ABL:2 == 1
	TIMES SOURCE:4 , 0.80
	TIMES SOURCE:5 , 0.80
ELSEIF ABL:2 == 2
	TIMES SOURCE:4 , 1.00
	TIMES SOURCE:5 , 1.00
ELSEIF ABL:2 == 3
	TIMES SOURCE:4 , 1.20
	TIMES SOURCE:5 , 1.20
ELSEIF ABL:2 == 4
	TIMES SOURCE:4 , 1.50
	TIMES SOURCE:5 , 1.50
ELSE
	SOURCE:4 = SOURCE:4 * (ABL:2 * 25 + 75) / 100
	SOURCE:5 = SOURCE:5 * (ABL:2 * 25 + 75) / 100
ENDIF

;主導権をチェック
IF TFLAG:45 == 0
	;主導権が主人公側
	;ABL:従順をみる
	IF ABL:0 <= 1
		SOURCE:21 += 300 + (ABL:0 * 50)
	ELSEIF ABL:0 <= 3
		SOURCE:21 += 600 + (ABL:0 * 100)
	ELSEIF ABL:0 <= 5
		SOURCE:21 += 800 + (ABL:0 * 120)
	ELSEIF ABL:0 <= 8
		SOURCE:21 += 1000 + (ABL:0 * 140)
	ELSEIF ABL:0 <= 11
		SOURCE:21 += 1200 + (ABL:0 * 160)
	ELSE
		SOURCE:21 += 1500 + (ABL:0 * 180)
	ENDIF
ELSE
	;主導権が相手側
	;ABL:サドっ気をみる
	IF ABL:15 == 0
		SOURCE:20 += 800
	ELSEIF ABL:15 == 1
		SOURCE:20 += 1100
	ELSEIF ABL:15 == 2
		SOURCE:20 += 1400
	ELSEIF ABL:15 == 3
		SOURCE:20 += 1800
	ELSEIF ABL:15 == 4
		SOURCE:20 += 2300
	ELSE
		SOURCE:20 += 1000 + (ABL:15 * 350)
	ENDIF
ENDIF

;-------------------------------------------------
;読心フェラの場合効果アップ（2倍）
;-------------------------------------------------

;対象が恋慕さとりだと変化
IF NAME_CSV(NO:TARGET, 0) == "さとり" && TALENT:85
	TIMES SOURCE:4 , 2.00
	TIMES SOURCE:5 , 2.00
	SIF TALENT:PLAYER:119 || TALENT:PLAYER:122  || TALENT:PLAYER:121
		BASE:PLAYER:2 += B
ENDIF

PRINTFORML %EXPNAME:22%+1
EXP:22 += 1

;奴隷の口⇔調教者のＰの汚れが移動
STAIN:口 |= STAIN:PLAYER:Ｐ
STAIN:PLAYER:Ｐ |= STAIN:口

;奉仕精神ＬＶ２以上、技巧ＬＶ２以上なら汚れをなめ取る
IF ABL:6 >= 2 && ABL:2 >= 2
	STAIN:PLAYER:Ｐ = 2
	SIF E >= 1
		TFLAG:8 = 1
ENDIF

IF TALENT:122 == 0 && TALENT:PLAYER:122 == 0
	PRINTS EXPNAME:40
	PRINTL +7
	EXP:40 += 7
	EXP:PLAYER:40 += 7
ELSEIF TALENT:122 == 1 && TALENT:PLAYER:122 == 1
	PRINTS EXPNAME:41
	PRINTL +7
	EXP:41 += 7
	EXP:PLAYER:41 += 7
ENDIF

SIF ASSIPLAY == 0 && EXP:22 >= EXPLV:3
	TFLAG:30 += 1

;調教者がふたなり
IF TALENT:PLAYER:121
	SOURCE:13 /= 2
ENDIF

TFLAG:100 = 1

;フェラチオ
@PASSIVE_T34
CALL PASSIVE_T33

;秘裂なぞり
@PASSIVE_T35
;-------------------------------------------------
;ソースの計算
;-------------------------------------------------
DOWNBASE:1 += 50

SOURCE:13 += 500
SOURCE:14 += 100

Y = 0
;愛液の汚れ
SIF STAIN:PLAYER:Ｖ & 1
	Y += 1
;精液の汚れ
SIF STAIN:PLAYER:Ｖ & 4
	Y += 3
;アナルの汚れ
SIF STAIN:PLAYER:Ｖ & 8
	Y += 7
SIF STAIN:PLAYER:Ｖ & 16
	Y += 15

SIF TALENT:61
	Y /= 3
SIF TALENT:62
	Y *= 2

;手淫では汚れがそれほど影響しない
Y /= 3
;上のほうで計算した汚れデータ
SOURCE:8 = Y*5 + 10

;ABL:奉仕精神をみる
IF ABL:6 == 0
	SOURCE:4 += 250
	SOURCE:5 += 50
	TIMES SOURCE:8 , 4.00
ELSEIF ABL:6 == 1
	SOURCE:4 += 300
	SOURCE:5 += 100
	TIMES SOURCE:8 , 2.50
ELSEIF ABL:6 == 2
	SOURCE:4 += 350
	SOURCE:5 += 200
	TIMES SOURCE:8 , 1.50
ELSEIF ABL:6 == 3
	SOURCE:4 += 400
	SOURCE:5 += 300
	TIMES SOURCE:8 , 1.00
ELSEIF ABL:6 == 4
	SOURCE:4 += 450
	SOURCE:5 += 500
	TIMES SOURCE:8 , 0.50
ELSE
	SOURCE:4 += 375 + (ABL:6 * 25)
	SOURCE:5 += 125 + (ABL:6 * 125)
	TIMES SOURCE:8 , 0.10
ENDIF


;ABL:技巧をみる
IF ABL:2 == 0
	TIMES SOURCE:4 , 0.50
	TIMES SOURCE:5 , 0.50
ELSEIF ABL:2 == 1
	TIMES SOURCE:4 , 0.80
	TIMES SOURCE:5 , 0.80
ELSEIF ABL:2 == 2
	TIMES SOURCE:4 , 1.00
	TIMES SOURCE:5 , 1.00
ELSEIF ABL:2 == 3
	TIMES SOURCE:4 , 1.20
	TIMES SOURCE:5 , 1.20
ELSEIF ABL:2 == 4
	TIMES SOURCE:4 , 1.50
	TIMES SOURCE:5 , 1.50
ELSE
	SOURCE:4 += SOURCE:4 * (ABL:2 * 25 + 75) / 100
	SOURCE:5 += SOURCE:5 * (ABL:2 * 25 + 75) / 100
ENDIF


;主導権をチェック
IF TFLAG:45 == 0
	;主導権が主人公側
	;ABL:従順をみる
	IF ABL:0 <= 1
		SOURCE:21 += 300 + (ABL:0 * 50)
	ELSEIF ABL:0 <= 3
		SOURCE:21 += 600 + (ABL:0 * 100)
	ELSEIF ABL:0 <= 5
		SOURCE:21 += 800 + (ABL:0 * 120)
	ELSEIF ABL:0 <= 8
		SOURCE:21 += 1000 + (ABL:0 * 140)
	ELSEIF ABL:0 <= 11
		SOURCE:21 += 1200 + (ABL:0 * 160)
	ELSE
		SOURCE:21 += 1500 + (ABL:0 * 180)
	ENDIF
ELSE
	;主導権が相手側
	;ABL:サドっ気をみる
	IF ABL:15 == 0
		SOURCE:20 += 800
	ELSEIF ABL:15 == 1
		SOURCE:20 += 1100
	ELSEIF ABL:15 == 2
		SOURCE:20 += 1400
	ELSEIF ABL:15 == 3
		SOURCE:20 += 1800
	ELSEIF ABL:15 == 4
		SOURCE:20 += 2300
	ELSE
		SOURCE:20 += 1000 + (ABL:15 * 350)
	ENDIF
ENDIF

;-------------------------------------------------
;読心手淫の場合効果アップ（2倍）
;-------------------------------------------------

;対象が恋慕さとりだと変化
IF NAME_CSV(NO:TARGET, 0) == "さとり" && TALENT:85
	TIMES SOURCE:4 , 2.00
	TIMES SOURCE:5 , 2.00
	SIF TALENT:PLAYER:119 || TALENT:PLAYER:122  || TALENT:PLAYER:121
		BASE:PLAYER:2 += B
ENDIF
;奴隷の指⇔調教者のＶの汚れが移動
STAIN:Ｖ |= STAIN:PLAYER:Ｐ
STAIN:PLAYER:Ｐ |= STAIN:Ｖ

IF TALENT:122 == 0 && TALENT:PLAYER:122 == 0
	PRINTS EXPNAME:40
	PRINTL +4
	EXP:40 += 4
	EXP:PLAYER:40 += 4
ELSEIF TALENT:122 == 1 && TALENT:PLAYER:122 == 1
	PRINTS EXPNAME:41
	PRINTL +4
	EXP:41 += 4
	EXP:PLAYER:41 += 4
ENDIF

TFLAG:100 = 1

;陰核擦り
@PASSIVE_T36
CALL PASSIVE_T35

;秘裂舐め
@PASSIVE_T37
;-------------------------------------------------
;ソースの計算
;-------------------------------------------------
DOWNBASE:1 += 50

SOURCE:13 += 500

;上のほうで計算した汚れデータ
SOURCE:8 = Y*80 + 50

;ABL:奉仕精神をみる
IF ABL:6 == 0
	SOURCE:4 += 420
	SOURCE:5 += 150
	TIMES SOURCE:8 , 4.00
ELSEIF ABL:6 == 1
	SOURCE:4 += 500
	SOURCE:5 += 300
	TIMES SOURCE:8 , 2.50
ELSEIF ABL:6 == 2
	SOURCE:4 += 580
	SOURCE:5 += 600
	TIMES SOURCE:8 , 1.50
ELSEIF ABL:6 == 3
	SOURCE:4 += 660
	SOURCE:5 += 900
	TIMES SOURCE:8 , 1.00
ELSEIF ABL:6 == 4
	SOURCE:4 += 740
	SOURCE:5 += 1500
	TIMES SOURCE:8 , 0.50
ELSE
	SOURCE:4 += 620 + (ABL:6 * 40)
	SOURCE:5 += 450 + (ABL:6 * 350)
	TIMES SOURCE:8 , 0.10
ENDIF


;ABL:技巧をみる
IF ABL:2 == 0
	TIMES SOURCE:4 , 0.50
	TIMES SOURCE:5 , 0.50
ELSEIF ABL:2 == 1
	TIMES SOURCE:4 , 0.80
	TIMES SOURCE:5 , 0.80
ELSEIF ABL:2 == 2
	TIMES SOURCE:4 , 1.00
	TIMES SOURCE:5 , 1.00
ELSEIF ABL:2 == 3
	TIMES SOURCE:4 , 1.50
	TIMES SOURCE:5 , 1.50
ELSEIF ABL:2 == 4
	TIMES SOURCE:4 , 2.50
	TIMES SOURCE:5 , 2.50
ELSE
	SOURCE:4 = SOURCE:4 * (ABL:2 * 75 + 25) / 100
	SOURCE:5 = SOURCE:5 * (ABL:2 * 75 + 25) / 100
ENDIF


;主導権をチェック
IF TFLAG:45 == 0
	;主導権が主人公側
	;ABL:従順をみる
	IF ABL:0 <= 1
		SOURCE:21 += 300 + (ABL:0 * 50)
	ELSEIF ABL:0 <= 3
		SOURCE:21 += 600 + (ABL:0 * 100)
	ELSEIF ABL:0 <= 5
		SOURCE:21 += 800 + (ABL:0 * 120)
	ELSEIF ABL:0 <= 8
		SOURCE:21 += 1000 + (ABL:0 * 140)
	ELSEIF ABL:0 <= 11
		SOURCE:21 += 1200 + (ABL:0 * 160)
	ELSE
		SOURCE:21 += 1500 + (ABL:0 * 180)
	ENDIF
ELSE
	;主導権が相手側
	;ABL:サドっ気をみる
	IF ABL:15 == 0
		SOURCE:20 += 600
	ELSEIF ABL:15 == 1
		SOURCE:20 += 900
	ELSEIF ABL:15 == 2
		SOURCE:20 += 1200
	ELSEIF ABL:15 == 3
		SOURCE:20 += 1600
	ELSEIF ABL:15 == 4
		SOURCE:20 += 2000
	ELSE
		SOURCE:20 += 1000 + (ABL:15 * 300)
	ENDIF
ENDIF
;奴隷の口⇔調教者のＶの汚れが移動
STAIN:口 |= STAIN:PLAYER:Ｖ
STAIN:PLAYER:Ｖ |= STAIN:口

IF TALENT:122 == 0 && TALENT:PLAYER:122 == 0
	PRINTS EXPNAME:40
	PRINTL +6
	EXP:40 += 6
	EXP:PLAYER:40 += 6
ENDIF

TFLAG:100 = 1

;秘裂舌挿入
@PASSIVE_T38
CALL PASSIVE_T37

;パイズリ
@PASSIVE_T39
;-------------------------------------------------
;ソースの計算
;-------------------------------------------------
DOWNBASE:1 += 70

SOURCE:13 += 1800
SOURCE:14 += 900

;ABL:奉仕精神をみる
IF ABL:6 == 0
	SOURCE:4 += 420
	SOURCE:5 += 150
	SOURCE:8 += 400
ELSEIF ABL:6 == 1
	SOURCE:4 += 500
	SOURCE:5 += 300
	SOURCE:8 += 300
ELSEIF ABL:6 == 2
	SOURCE:4 += 580
	SOURCE:5 += 600
	SOURCE:8 += 150
ELSEIF ABL:6 == 3
	SOURCE:4 += 660
	SOURCE:5 += 900
	SOURCE:8 += 50
ELSEIF ABL:6 == 4
	SOURCE:4 += 740
	SOURCE:5 += 1500
	SOURCE:8 += 20
ELSE
	SOURCE:4 += 620 + (ABL:6 * 40)
	SOURCE:5 += 450 + (ABL:6 * 350)
	SOURCE:8 += 0
ENDIF

;尿道刺激、ボールギャグ使用中は不可
;Ｍ感覚発生もこちらに
;Ｍ感覚を設定している場合快Ｍソース等取得
IF TEQUIP:45 == 0 && (FLAG:62 & 4194304)
	DOWNBASE:1 += 10

	IF ABL:15 == 3
		SOURCE:4 += 50
		SOURCE:5 += 10
	ELSEIF ABL:15 == 4
		SOURCE:4 += 80
		SOURCE:5 += 30
	ELSEIF ABL:15 >= 5
		SOURCE:4 += 100
		SOURCE:5 += 50
	ENDIF

	;Ｍ感覚について
	;快Ｍのソース・Ｍ感覚を見る
	IF ABL:17 == 1
		SOURCE:24 += 10
	ELSEIF ABL:17 == 2
		SOURCE:24 += 30
	ELSEIF ABL:17 == 3
		SOURCE:24 += 70
	ELSEIF ABL:17 == 4
		SOURCE:24 += 100
	ELSEIF ABL:17 >= 5
		SOURCE:24 += 100 +(50 * (ABL:17 - 4))
	ENDIF

	;好感度（既成事実で代用）を見る
	IF MARK:2 == 1
		TIMES SOURCE:24 , 1.00
	ELSEIF MARK:2 == 2
		TIMES SOURCE:24 , 1.20
	ELSEIF TALENT:85== 0 && MARK:2 == 3
		TIMES SOURCE:24 , 1.40
	ELSEIF TALENT:85 && CFLAG:2 < 3500
		TIMES SOURCE:24 , 1.60
	ELSEIF TALENT:85 && CFLAG:2 >= 3500
		TIMES SOURCE:24 , 1.80
	ENDIF

	;ABL:精液中毒をみる
	IF ABL:11 <= 2
		TIMES SOURCE:24 , 0.00
	ELSEIF ABL:11 == 3
		TIMES SOURCE:24 , 0.50
	ELSEIF ABL:11 == 4
		TIMES SOURCE:24 , 1.00
	ELSE
		TIMES SOURCE:24 , 1.25
	ENDIF
ENDIF

;ABL:Ｂ感覚をみる
IF ABL:14 == 0
	A = 100
ELSEIF ABL:14 == 1
	A = 200
ELSEIF ABL:14== 2
	A = 400
ELSEIF ABL:14 == 3
	A = 800
ELSEIF ABL:14 == 4
	A = 1200
ELSE
	A = 750 + (ABL:14 * 150)
ENDIF

IF TALENT:110
	TIMES A , 1.20
ENDIF
IF TALENT:108
	TIMES A , 1.20
ELSEIF TALENT:107
	TIMES A , 0.70
ENDIF

SOURCE:17 += A
;ABL:技巧をみる
IF ABL:2 == 0
	TIMES SOURCE:4 , 0.50
	TIMES SOURCE:5 , 0.50
ELSEIF ABL:2 == 1
	TIMES SOURCE:4 , 0.80
	TIMES SOURCE:5 , 0.80
ELSEIF ABL:2 == 2
	TIMES SOURCE:4 , 1.00
	TIMES SOURCE:5 , 1.00
ELSEIF ABL:2 == 3
	TIMES SOURCE:4 , 1.20
	TIMES SOURCE:5 , 1.20
ELSEIF ABL:2 == 4
	TIMES SOURCE:4 , 1.50
	TIMES SOURCE:5 , 1.50
ELSE
	SOURCE:4 = SOURCE:4 * (ABL:2 * 25 + 75) / 100
	SOURCE:5 = SOURCE:5 * (ABL:2 * 25 + 75) / 100
ENDIF


;主導権をチェック
IF TFLAG:45 == 0
	;主導権が主人公側
	;ABL:従順をみる
	IF ABL:0 <= 1
		SOURCE:21 += 300 + (ABL:0 * 50)
	ELSEIF ABL:0 <= 3
		SOURCE:21 += 600 + (ABL:0 * 100)
	ELSEIF ABL:0 <= 5
		SOURCE:21 += 800 + (ABL:0 * 120)
	ELSEIF ABL:0 <= 8
		SOURCE:21 += 1000 + (ABL:0 * 140)
	ELSEIF ABL:0 <= 11
		SOURCE:21 += 1200 + (ABL:0 * 160)
	ELSE
		SOURCE:21 += 1500 + (ABL:0 * 180)
	ENDIF
ELSE
	;主導権が相手側
	;ABL:サドっ気をみる
	IF ABL:15 == 0
		SOURCE:20 += 800
	ELSEIF ABL:15 == 1
		SOURCE:20 += 1100
	ELSEIF ABL:15 == 2
		SOURCE:20 += 1400
	ELSEIF ABL:15 == 3
		SOURCE:20 += 1800
	ELSEIF ABL:15 == 4
		SOURCE:20 += 2300
	ELSE
		SOURCE:20 += 1000 + (ABL:15 * 350)
	ENDIF
ENDIF
PRINTFORML %EXPNAME:22%＋１
EXP:22 += 1

;奴隷の口⇔調教者のＰの汚れが移動
STAIN:口 |= STAIN:PLAYER:Ｐ
STAIN:PLAYER:Ｐ |= STAIN:口

;奉仕精神ＬＶ２以上、技巧ＬＶ２以上なら汚れをなめ取る
IF ABL:6 >= 2 && ABL:2 >= 2
	STAIN:PLAYER:Ｐ = 2
	SIF E >= 1
		TFLAG:8 = 1
ENDIF

IF TALENT:122 == 0 && TALENT:PLAYER:122 == 0
	PRINTS EXPNAME:40
	PRINTL +7
	EXP:40 += 7
	EXP:PLAYER:40 += 7
ELSEIF TALENT:122 == 1 && TALENT:PLAYER:122 == 1
	PRINTS EXPNAME:41
	PRINTL +7
	EXP:41 += 7
	EXP:PLAYER:41 += 7
ENDIF
;奴隷のＢ⇔調教者のＰの汚れが移動
STAIN:Ｂ |= STAIN:PLAYER:Ｐ
STAIN:PLAYER:Ｐ |= STAIN:Ｂ

TFLAG:100 = 1

;性器擦り合い
@PASSIVE_T40
IF TALENT:PLAYER:122
	;-------------------------------------------------
	;射精ゲージチェック
	;-------------------------------------------------
	B = 0
	
	;ABL:技巧をみる
	IF ABL:2 <= 1
		B = 250 + ABL:2 * 100
	ELSEIF ABL:2 <= 3
		B = 400 + ABL:2 * 100
	ELSEIF ABL:2 <= 5
		B = 400 + ABL:2 * 170
	ELSEIF ABL:2 <= 8
		B = 600 + ABL:2 * 190
	ELSEIF ABL:2 <= 11
		B = 500 + ABL:2 * 250
	ELSE
		B = 700 + ABL:2 * 300
	ENDIF
	
	;PALAM:潤滑
	IF PALAM:3 < PALAMLV:1
		B += 0
	ELSEIF PALAM:3 < PALAMLV:2
		B += 0
	ELSEIF PALAM:3 < PALAMLV:3
		B += 0
	ELSEIF PALAM:3 < PALAMLV:4
		B += 300
	ELSEIF PALAM:3 < PALAMLV:5
		B += 600
	ELSE
		B += 1000
	ENDIF
	
	;ABL:従順をみる
	IF ABL:0 <= 1
		TIMES B , 0.80
	ELSEIF ABL:0 <= 3
		TIMES B , 0.90
	ELSEIF ABL:0 <= 5
		TIMES B , 1.00
	ELSEIF ABL:0 <= 8
		TIMES B , 1.10
	ELSEIF ABL:0 <= 11
		TIMES B , 1.20
	ELSE
		B = B * (ABL:0 * 2 + 105) / 100
	ENDIF
	
	;ABL:奉仕精神をみる
	IF ABL:6 <= 1
		TIMES B , 0.50
	ELSEIF ABL:6 <= 3
		TIMES B , 0.80
	ELSEIF ABL:6 <= 5
		TIMES B , 1.20
	ELSEIF ABL:6 <= 8
		TIMES B , 1.50
	ELSEIF ABL:6 <= 11
		TIMES B , 1.80
	ELSE
		B = B * (ABL:6 * 10 + 90) / 100
	ENDIF
	
	;プレイヤーのABL:Ｃ感覚をみる
	IF ABL:PLAYER:3 == 0
		TIMES B , 1.00
	ELSEIF ABL:PLAYER:3 == 1
		TIMES B , 1.50
	ELSEIF ABL:PLAYER:3 == 2
		TIMES B , 2.00
	ELSEIF ABL:PLAYER:3 == 3
		TIMES B , 2.50
	ELSEIF ABL:PLAYER:3 == 4
		TIMES B , 3.50
	ELSE
		B = B * ABL:PLAYER:3
	ENDIF
	
	SIF TALENT:PLAYER:119 || TALENT:PLAYER:122  || TALENT:PLAYER:121
		BASE:PLAYER:2 += B
	
	
	;-------------------------------------------------
	;ソースの計算
	;-------------------------------------------------
	DOWNBASE:1 += 60
	
	SOURCE:13 += 1200
	SOURCE:14 += 400
		Y = 0
	;愛液の汚れ
	SIF STAIN:PLAYER:Ｐ & 1
		Y += 1
	;精液の汚れ
	SIF STAIN:PLAYER:Ｐ & 4
		Y += 3
	;アナルの汚れ
	SIF STAIN:PLAYER:Ｐ & 8
		Y += 7
	SIF STAIN:PLAYER:Ｐ & 16
		Y += 15
	
	SIF TALENT:61
		Y /= 3
	SIF TALENT:62
		Y *= 2
	
	;素股では汚れの影響が少なめ
	Y /= 3
	;上のほうで計算した汚れデータ
	SOURCE:8 += Y*5 + 20
	
	;ABL:奉仕精神をみる
	IF ABL:6 == 0
		SOURCE:4 += 200
		SOURCE:5 += 100
		TIMES SOURCE:8 , 4.00
	ELSEIF ABL:6 == 1
		SOURCE:4 += 250
		SOURCE:5 += 180
		TIMES SOURCE:8 , 2.50
	ELSEIF ABL:6 == 2
		SOURCE:4 += 300
		SOURCE:5 += 250
		TIMES SOURCE:8 , 1.50
	ELSEIF ABL:6 == 3
		SOURCE:4 += 350
		SOURCE:5 += 350
		TIMES SOURCE:8 , 1.00
	ELSEIF ABL:6 == 4
		SOURCE:4 += 400
		SOURCE:5 += 500
		TIMES SOURCE:8 , 0.50
	ELSE
		SOURCE:4 += 325 + (ABL:6 * 25)
		SOURCE:5 += 50 + (ABL:6 * 150)
		TIMES SOURCE:8 , 0.10
	ENDIF
	
	
	;ABL:技巧をみる
	IF ABL:2 == 0
		TIMES SOURCE:4 , 0.70
		TIMES SOURCE:5 , 0.70
	ELSEIF ABL:2 == 1
		TIMES SOURCE:4 , 0.90
		TIMES SOURCE:5 , 0.90
	ELSEIF ABL:2 == 2
		TIMES SOURCE:4 , 1.00
		TIMES SOURCE:5 , 1.00
	ELSEIF ABL:2 == 3
		TIMES SOURCE:4 , 1.20
		TIMES SOURCE:5 , 1.20
	ELSEIF ABL:2 == 4
		TIMES SOURCE:4 , 1.40
		TIMES SOURCE:5 , 1.40
	ELSE
		SOURCE:4 += SOURCE:4 * (ABL:2 * 10 + 110) / 100
		SOURCE:5 += SOURCE:5 * (ABL:2 * 10 + 110) / 100
	ENDIF
	
	;ABL:Ｃ感覚をみる
	IF ABL:3 == 0
		SOURCE:0 += 0
	ELSEIF ABL:3 == 1
		SOURCE:0 += 10
	ELSEIF ABL:3 == 2
		SOURCE:0 += 50
	ELSEIF ABL:3 == 3
		SOURCE:0 += 200
	ELSEIF ABL:3 == 4
		SOURCE:0 += 600
	ELSE
		SOURCE:0 += (ABL:3 * 700) - 1500
	ENDIF
	
	;PALAM:潤滑
	IF PALAM:3 < PALAMLV:1
		TIMES SOURCE:0 , 0.30
		TIMES SOURCE:4 , 0.60
	ELSEIF PALAM:3 < PALAMLV:2
		TIMES SOURCE:0 , 0.60
		TIMES SOURCE:4 , 0.80
	ELSEIF PALAM:3 < PALAMLV:3
		TIMES SOURCE:0 , 1.00
		TIMES SOURCE:4 , 1.00
	ELSEIF PALAM:3 < PALAMLV:4
		TIMES SOURCE:0 , 1.50
		TIMES SOURCE:4 , 1.20
	ELSEIF PALAM:3 < PALAMLV:5
		TIMES SOURCE:0 , 2.00
		TIMES SOURCE:4 , 1.40
	ELSE
		TIMES SOURCE:0 , 2.50
		TIMES SOURCE:4 , 1.60
	ENDIF
	
	
	;主導権をチェック
	IF TFLAG:45 == 0
		;主導権が主人公側
		;ABL:従順をみる
		IF ABL:0 <= 1
			SOURCE:21 += 300 + (ABL:0 * 50)
		ELSEIF ABL:0 <= 3
			SOURCE:21 += 600 + (ABL:0 * 100)
		ELSEIF ABL:0 <= 5
			SOURCE:21 += 800 + (ABL:0 * 120)
		ELSEIF ABL:0 <= 8
			SOURCE:21 += 1000 + (ABL:0 * 140)
		ELSEIF ABL:0 <= 11
			SOURCE:21 += 1200 + (ABL:0 * 160)
		ELSE
			SOURCE:21 += 1500 + (ABL:0 * 180)
		ENDIF
	ELSE
		;主導権が相手側
		;ABL:サドっ気をみる
		IF ABL:15 == 0
			SOURCE:20 += 800
		ELSEIF ABL:15 == 1
			SOURCE:20 += 1100
		ELSEIF ABL:15 == 2
			SOURCE:20 += 1400
		ELSEIF ABL:15 == 3
			SOURCE:20 += 1800
		ELSEIF ABL:15 == 4
			SOURCE:20 += 2300
		ELSE
			SOURCE:20 += 1000 + (ABL:15 * 350)
		ENDIF
	ENDIF
	STAIN:Ｖ |= STAIN:PLAYER:Ｐ
	STAIN:PLAYER:Ｐ |= STAIN:Ｖ
	
	IF TALENT:122 == 0 && TALENT:PLAYER:122 == 0
		PRINTS EXPNAME:40
		PRINTL +7
		EXP:40 += 7
		EXP:PLAYER:40 += 7
	ELSEIF TALENT:122 == 1 && TALENT:PLAYER:122 == 1
		PRINTS EXPNAME:41
		PRINTL +7
		EXP:41 += 7
		EXP:PLAYER:41 += 7
	ENDIF
	
	SIF ASSIPLAY == 0
		TFLAG:30 += 1
	
	TFLAG:100 = 1
	;調教者がふたなり
	IF TALENT:PLAYER:121
		SOURCE:13 /= 2
	ENDIF
ELSEIF TALENT:122 || TALENT:121
	DOWNBASE:1 += 80
	
	SOURCE:3 += 1200
	SOURCE:5 += 1200
	SOURCE:12 += 250
	
	;ABL:Ｃ感覚をみる
	IF ABL:3 == 0
		SOURCE:0 += 1000
		SOURCE:7 += 800
	ELSEIF ABL:3 == 1
		SOURCE:0 += 1600
		SOURCE:7 += 1000
	ELSEIF ABL:3 == 2
		SOURCE:0 += 2200
		SOURCE:7 += 1300
	ELSEIF ABL:3 == 3
		SOURCE:0 += 2700
		SOURCE:7 += 1700
	ELSEIF ABL:3 == 4
		SOURCE:0 += 3300
		SOURCE:7 += 2200
	ELSE
		SOURCE:0 += 1500 + ABL:3 * 500
		SOURCE:7 += 2800
	ENDIF
	
	;奴隷のＰ⇔調教者のＶの汚れが移動
	STAIN:Ｐ |= STAIN:PLAYER:Ｖ
	STAIN:PLAYER:Ｖ |= STAIN:Ｐ
	
	
	IF TALENT:122 == 0 && TALENT:PLAYER:122 == 0
		PRINTS EXPNAME:40
		PRINTL +1
		EXP:40 += 1
		EXP:PLAYER:40 += 1
	ELSEIF TALENT:122 == 1 && TALENT:PLAYER:122 == 1
		PRINTS EXPNAME:41
		PRINTL +1
		EXP:41 += 1
		EXP:PLAYER:41 += 1
	ENDIF
	
	;プレイヤーのABL:技巧をみる
	IF ABL:PLAYER:2 == 0
		TIMES SOURCE:0 , 0.50
		TIMES SOURCE:7 , 0.50
	ELSEIF ABL:PLAYER:2 == 1
		TIMES SOURCE:0 , 0.80
		TIMES SOURCE:7 , 0.80
	ELSEIF ABL:PLAYER:2 == 2
		TIMES SOURCE:0 , 1.00
		TIMES SOURCE:7 , 1.00
	ELSEIF ABL:PLAYER:2 == 3
		TIMES SOURCE:0 , 1.20
		TIMES SOURCE:7 , 1.50
	ELSEIF ABL:PLAYER:2 == 4
		TIMES SOURCE:0 , 1.50
		TIMES SOURCE:7 , 2.50
	ELSE
		SOURCE:0 = SOURCE:0 * (ABL:PLAYER:2 * 75 + 25) / 200
		SOURCE:7 = SOURCE:7 * (ABL:PLAYER:2 * 75 + 25) / 100
	ENDIF
	
	;ABL:奉仕精神をみる
	IF ABL:PLAYER:6 == 0
		TIMES SOURCE:3 , 0.60
	;	TIMES SOURCE:7 , 0.60
	ELSEIF ABL:PLAYER:6 == 1
		TIMES SOURCE:3 , 0.80
	;	TIMES SOURCE:7 , 0.80
	ELSEIF ABL:PLAYER:6 == 2
		TIMES SOURCE:3 , 1.00
	;	TIMES SOURCE:7 , 1.00
	ELSEIF ABL:PLAYER:6 == 3
		TIMES SOURCE:3 , 1.50
	;	TIMES SOURCE:7 , 1.50
	ELSEIF ABL:PLAYER:6 == 4
		TIMES SOURCE:3 , 2.50
	;	TIMES SOURCE:7 , 2.50
	ELSE
		SOURCE:3 = SOURCE:3 * (ABL:PLAYER:2 * 75 + 25) / 100
	;	SOURCE:7 = SOURCE:7 * (ABL:PLAYER:2 * 75 + 25) / 100
	ENDIF
	
	;主導権をチェック
	IF TFLAG:45 == 0
		;主導権が主人公側
		;ABL:従順をみる
		IF ABL:0 <= 1
			SOURCE:21 += 300 + (ABL:0 * 50)
		ELSEIF ABL:0 <= 3
			SOURCE:21 += 600 + (ABL:0 * 100)
		ELSEIF ABL:0 <= 5
			SOURCE:21 += 800 + (ABL:0 * 120)
		ELSEIF ABL:0 <= 8
			SOURCE:21 += 1000 + (ABL:0 * 140)
		ELSEIF ABL:0 <= 11
			SOURCE:21 += 1200 + (ABL:0 * 160)
		ELSE
			SOURCE:21 += 1500 + (ABL:0 * 180)
		ENDIF
	ELSE
		;主導権が相手側
		;ABL:サドっ気をみる
		IF ABL:15 == 0
			SOURCE:20 += 600
		ELSEIF ABL:15 == 1
			SOURCE:20 += 900
		ELSEIF ABL:15 == 2
			SOURCE:20 += 1200
		ELSEIF ABL:15 == 3
			SOURCE:20 += 1600
		ELSEIF ABL:15 == 4
			SOURCE:20 += 2000
		ELSE
			SOURCE:20 += 1000 + (ABL:15 * 300)
		ENDIF
	ENDIF
ELSE
	;-------------------------------------------------
	;ソースの計算
	;-------------------------------------------------
	DOWNBASE:1 += 40
	
	SOURCE:9 += 500
	SOURCE:12 += 250
	SOURCE:13 += 400
	SOURCE:14 += 300
	
	;ABL:従順をみる
	IF ABL:0 == 0
		SOURCE:11 += 200
	ELSEIF ABL:0 == 1
		SOURCE:11 += 120
	ELSEIF ABL:0 == 2
		SOURCE:11 += 60
	ELSEIF ABL:0 == 3
		SOURCE:11 += 20
	ELSEIF ABL:0 == 4
		SOURCE:11 += 0
	ELSE
		SOURCE:11 += 0
	ENDIF
	
	;ABL:Ｃ感覚をみる
	IF ABL:3 == 0
		SOURCE:0 += 20
		SOURCE:4 += 0
		SOURCE:5 += 0
		SOURCE:13 += 20
		TIMES SOURCE:12 , 0.80
	ELSEIF ABL:3 == 1
		SOURCE:0 += 80
		SOURCE:4 += 10
		SOURCE:5 += 50
		SOURCE:13 += 20
		TIMES SOURCE:12 , 0.90
	ELSEIF ABL:3 == 2
		SOURCE:0 += 350
		SOURCE:4 += 50
		SOURCE:5 += 100
		SOURCE:13 += 20
		TIMES SOURCE:12 , 1.00
	ELSEIF ABL:3 == 3
		SOURCE:0 += 750
		SOURCE:4 += 100
		SOURCE:5 += 300
		SOURCE:13 += 20
		TIMES SOURCE:12 , 1.10
	ELSEIF ABL:3 == 4
		SOURCE:0 += 1200
		SOURCE:4 += 700
		SOURCE:5 += 600
		SOURCE:13 += 20
		TIMES SOURCE:12 , 1.20
	ELSE
		SOURCE:0 += 625 + (ABL:3 * 225)
		SOURCE:4 += (ABL:3 * 650) - 1250
		SOURCE:5 += ABL:3 * 200
		SOURCE:13 += 20
		SOURCE:12 = SOURCE:12 * (ABL:3 * 5 + 105) / 100
	ENDIF
	
	;ABL:技巧をみる
	IF ABL:2 == 0
		TIMES SOURCE:4  , 0.70
		TIMES SOURCE:5  , 0.75
		TIMES SOURCE:13 , 0.50
	ELSEIF ABL:2 == 1
		TIMES SOURCE:4  , 0.80
		TIMES SOURCE:5  , 0.90
		TIMES SOURCE:13 , 0.60
	ELSEIF ABL:2 == 2
		TIMES SOURCE:4  , 1.00
		TIMES SOURCE:5  , 1.00
		TIMES SOURCE:13 , 0.70
	ELSEIF ABL:2 == 3
		TIMES SOURCE:4  , 1.20
		TIMES SOURCE:5  , 1.25
		TIMES SOURCE:13 , 0.80
	ELSEIF ABL:2 == 4
		TIMES SOURCE:4  , 1.40
		TIMES SOURCE:5  , 1.50
		TIMES SOURCE:13 , 0.90
	ELSE
		TIMES SOURCE:4  , 1.60
		TIMES SOURCE:5  , 1.75
		TIMES SOURCE:13 , 1.00
	ENDIF
	
	;ABL:奉仕精神をみる
	IF ABL:6 == 0
		TIMES SOURCE:5 , 0.50
	ELSEIF ABL:6 == 1
		TIMES SOURCE:5 , 1.00
	ELSEIF ABL:6 == 2
		TIMES SOURCE:5 , 1.20
	ELSEIF ABL:6 == 3
		TIMES SOURCE:5 , 1.40
	ELSEIF ABL:6 == 4
		TIMES SOURCE:5 , 1.70
	ELSE
		SOURCE:5 = SOURCE:5 * (ABL:6 * 15 + 125) / 100
	ENDIF
	
	
	;調教者のABL:従順をみる
	IF ABL:PLAYER:0 == 0
		TIMES SOURCE:4 , 0.80
		TIMES SOURCE:5 , 0.50
	ELSEIF ABL:PLAYER:0 == 1
		TIMES SOURCE:4 , 0.90
		TIMES SOURCE:5 , 0.70
	ELSEIF ABL:PLAYER:0 == 2
		TIMES SOURCE:4 , 1.00
		TIMES SOURCE:5 , 1.00
	ELSEIF ABL:PLAYER:0 == 3
		TIMES SOURCE:4 , 1.10
		TIMES SOURCE:5 , 1.20
	ELSEIF ABL:PLAYER:0 == 4
		TIMES SOURCE:4 , 1.20
		TIMES SOURCE:5 , 1.40
	ELSE
		SOURCE:4 = SOURCE:4 * (ABL:PLAYER:0 * 5 + 105) / 100
		SOURCE:5 = SOURCE:5 * (ABL:PLAYER:0 * 15 + 95) / 100
	ENDIF
	
	
	;奴隷のＶ⇔調教者のＶの汚れが移動
	STAIN:Ｖ |= STAIN:PLAYER:Ｖ
	STAIN:PLAYER:Ｖ |= STAIN:Ｖ
	
	IF TALENT:122 == 0 && TALENT:PLAYER:122 == 0
		PRINTS EXPNAME:40
		PRINTL +8
		EXP:40 += 8
		EXP:PLAYER:40 += 8
	ENDIF
	
	SIF ASSIPLAY == 0 && ABL:3 >= 3
			TFLAG:30 += 1
	
	TFLAG:100 = 1
	
	
	;主導権をチェック
	IF TFLAG:45 == 0
		;主導権が主人公側
		;ABL:従順をみる
		IF ABL:0 <= 1
			SOURCE:21 += 300 + (ABL:0 * 50)
		ELSEIF ABL:0 <= 3
			SOURCE:21 += 600 + (ABL:0 * 100)
		ELSEIF ABL:0 <= 5
			SOURCE:21 += 800 + (ABL:0 * 120)
		ELSEIF ABL:0 <= 8
			SOURCE:21 += 1000 + (ABL:0 * 140)
		ELSEIF ABL:0 <= 11
			SOURCE:21 += 1200 + (ABL:0 * 160)
		ELSE
			SOURCE:21 += 1500 + (ABL:0 * 180)
		ENDIF
	ELSE
		;主導権が相手側
		;ABL:サドっ気をみる
		IF ABL:15 == 0
			SOURCE:20 += 600
		ELSEIF ABL:15 == 1
			SOURCE:20 += 900
		ELSEIF ABL:15 == 2
			SOURCE:20 += 1200
		ELSEIF ABL:15 == 3
			SOURCE:20 += 1600
		ELSEIF ABL:15 == 4
			SOURCE:20 += 2000
		ELSE
			SOURCE:20 += 1000 + (ABL:15 * 300)
		ENDIF
	ENDIF
ENDIF

;顔面騎乗クンニ
@PASSIVE_T41
;クンニ
DOWNBASE:1 += 20

SOURCE:10 += 100
SOURCE:12 += 220
SOURCE:14 += 50

;ABL:Ｃ感覚をみる
IF ABL:3 == 0
	SOURCE:0 += 40
ELSEIF ABL:3 == 1
	SOURCE:0 += 160
ELSEIF ABL:3 == 2
	SOURCE:0 += 700
ELSEIF ABL:3 == 3
	SOURCE:0 += 1500
ELSEIF ABL:3 == 4
	SOURCE:0 += 2400
ELSE
	SOURCE:0 += 1050 + (ABL:3 * 450)
ENDIF

;クスコ装着中は効果変動
IF TEQUIP:61
	TIMES SOURCE:0 , 0.30
	SOURCE:12 += 500
ENDIF

;調教者のTALENT:舌使いをみる
IF TALENT:PLAYER:52
	TIMES SOURCE:0 , 2.00
	SOURCE:16 += SOURCE:0/20
ENDIF

;奴隷のＶ⇔調教者の口の汚れが移動
STAIN:Ｖ |= STAIN:PLAYER:口
STAIN:PLAYER:口 |= STAIN:Ｖ

IF TALENT:122 == 0 && TALENT:PLAYER:122 == 0
	PRINTS EXPNAME:40
	PRINTL +3
	EXP:40 += 3
	EXP:PLAYER:40 += 3
ENDIF


;主導権をチェック
IF TFLAG:45 == 0
	;主導権が主人公側
	;ABL:従順をみる
	IF ABL:0 <= 1
		SOURCE:21 += 300 + (ABL:0 * 50)
	ELSEIF ABL:0 <= 3
		SOURCE:21 += 600 + (ABL:0 * 100)
	ELSEIF ABL:0 <= 5
		SOURCE:21 += 800 + (ABL:0 * 120)
	ELSEIF ABL:0 <= 8
		SOURCE:21 += 1000 + (ABL:0 * 140)
	ELSEIF ABL:0 <= 11
		SOURCE:21 += 1200 + (ABL:0 * 160)
	ELSE
		SOURCE:21 += 1500 + (ABL:0 * 180)
	ENDIF
ELSE
	;主導権が相手側
	;ABL:サドっ気をみる
	IF ABL:15 == 0
		SOURCE:20 += 600
	ELSEIF ABL:15 == 1
		SOURCE:20 += 900
	ELSEIF ABL:15 == 2
		SOURCE:20 += 1200
	ELSEIF ABL:15 == 3
		SOURCE:20 += 1600
	ELSEIF ABL:15 == 4
		SOURCE:20 += 2000
	ELSE
		SOURCE:20 += 1000 + (ABL:15 * 300)
	ENDIF
ENDIF

;顔面騎乗アナル
@PASSIVE_T42
;アナル舐め
DOWNBASE:1 += 20

SOURCE:10 += 50
SOURCE:12 += 300
SOURCE:14 += 500

;ABL:Ａ感覚をみる
IF ABL:5 == 0
	SOURCE:2 += 5
ELSEIF ABL:5 == 1
	SOURCE:2 += 50
ELSEIF ABL:5 == 2
	SOURCE:2 += 200
ELSEIF ABL:5 == 3
	SOURCE:2 += 500
ELSEIF ABL:5 == 4
	SOURCE:2 += 1000
ELSE
	SOURCE:2 += (ABL:5 * 400) - 200
ENDIF

;調教者のTALENT:舌使いをみる
IF TALENT:PLAYER:52
	TIMES SOURCE:2 , 2.00
	SOURCE:16 += SOURCE:0/20
ENDIF

EXP:1 += 1
PRINTL Ａ経験＋１

;奴隷のＡ⇔調教者の口の汚れが移動
STAIN:Ａ |= STAIN:PLAYER:口
STAIN:PLAYER:口 |= STAIN:Ａ

IF TALENT:122 == 0 && TALENT:PLAYER:122 == 0
	PRINTS EXPNAME:40
	PRINTL +3
	EXP:40 += 3
	EXP:PLAYER:40 += 3
ENDIF

;手で愛撫させる
@PASSIVE_T43
DOWNBASE:1 += 20

SOURCE:4 += 60
SOURCE:8 += 30
SOURCE:12 += 100

;ABL:Ｃ感覚をみる
IF ABL:3 == 0
	SOURCE:0 += 20
	SOURCE:3 += 50
ELSEIF ABL:3 == 1
	SOURCE:0 += 100
	SOURCE:3 += 100
ELSEIF ABL:3 == 2
	SOURCE:0 += 500
	SOURCE:3 += 160
ELSEIF ABL:3 == 3
	SOURCE:0 += 1200
	SOURCE:3 += 200
ELSEIF ABL:3 == 4
	SOURCE:0 += 2000
	SOURCE:3 += 230
ELSE
	SOURCE:0 += 800 + (ABL:3 * 400)
	SOURCE:3 += 200 + (ABL:3 * 10)
ENDIF
IF TALENT:122 == 0 && TALENT:PLAYER:122 == 0
	PRINTS EXPNAME:40
	PRINTL +5
	EXP:40 += 5
	EXP:PLAYER:40 += 5
ELSEIF TALENT:122 == 1 && TALENT:PLAYER:122 == 1
	PRINTS EXPNAME:41
	PRINTL +5
	EXP:41 += 5
	EXP:PLAYER:41 += 5
ENDIF

;主導権をチェック
IF TFLAG:45 == 0
	;主導権が主人公側
	;ABL:従順をみる
	IF ABL:0 <= 1
		SOURCE:21 += 300 + (ABL:0 * 50)
	ELSEIF ABL:0 <= 3
		SOURCE:21 += 600 + (ABL:0 * 100)
	ELSEIF ABL:0 <= 5
		SOURCE:21 += 800 + (ABL:0 * 120)
	ELSEIF ABL:0 <= 8
		SOURCE:21 += 1000 + (ABL:0 * 140)
	ELSEIF ABL:0 <= 11
		SOURCE:21 += 1200 + (ABL:0 * 160)
	ELSE
		SOURCE:21 += 1500 + (ABL:0 * 180)
	ENDIF
ELSE
	;主導権が相手側
	;ABL:サドっ気をみる
	IF ABL:15 == 0
		SOURCE:20 += 600
	ELSEIF ABL:15 == 1
		SOURCE:20 += 900
	ELSEIF ABL:15 == 2
		SOURCE:20 += 1200
	ELSEIF ABL:15 == 3
		SOURCE:20 += 1600
	ELSEIF ABL:15 == 4
		SOURCE:20 += 2000
	ELSE
		SOURCE:20 += 1000 + (ABL:15 * 300)
	ENDIF
ENDIF

;胸を揉ませる
@PASSIVE_T44
DOWNBASE:1 += 20

SOURCE:4 += 60
SOURCE:8 += 20
SOURCE:12 += 100

;ABL:Ｂ感覚をみる
IF ABL:14 == 0
	SOURCE:17 += 20
	SOURCE:3 += 50
ELSEIF ABL:14 == 1
	SOURCE:17 += 100
	SOURCE:3 += 100
ELSEIF ABL:14 == 2
	SOURCE:17 += 500
	SOURCE:3 += 160
ELSEIF ABL:14 == 3
	SOURCE:17 += 1200
	SOURCE:3 += 200
ELSEIF ABL:14 == 4
	SOURCE:17 += 2000
	SOURCE:3 += 230
ELSE
	SOURCE:17 += 800 + (ABL:14 * 400)
	SOURCE:3 += 200 + (ABL:14 * 10)
ENDIF

;調教者が［幼児退行］
IF TALENT:PLAYER:131
	TIMES SOURCE:17 , 1.20
	TIMES SOURCE:3 , 1.20
ENDIF

;調教者が［幼稚］
IF TALENT:PLAYER:132
	TIMES SOURCE:17 , 1.20
	TIMES SOURCE:3 , 1.20
ENDIF
IF TFLAG:53 == 44
	STAIN:Ｂ |= STAIN:PLAYER:手
	STAIN:PLAYER:手 |= STAIN:Ｂ
ELSEIF TFLAG:53 == 45
	STAIN:Ｂ |= STAIN:PLAYER:口
	STAIN:PLAYER:口 |= STAIN:Ｂ
ENDIF


IF TALENT:122 == 0 && TALENT:PLAYER:122 == 0
	PRINTS EXPNAME:40
	PRINTL +5
	EXP:40 += 5
	EXP:PLAYER:40 += 5
ELSEIF TALENT:122 == 1 && TALENT:PLAYER:122 == 1
	PRINTS EXPNAME:41
	PRINTL +5
	EXP:41 += 5
	EXP:PLAYER:41 += 5
ENDIF


;主導権をチェック
IF TFLAG:45 == 0
	;主導権が主人公側
	;ABL:従順をみる
	IF ABL:0 <= 1
		SOURCE:21 += 300 + (ABL:0 * 50)
	ELSEIF ABL:0 <= 3
		SOURCE:21 += 600 + (ABL:0 * 100)
	ELSEIF ABL:0 <= 5
		SOURCE:21 += 800 + (ABL:0 * 120)
	ELSEIF ABL:0 <= 8
		SOURCE:21 += 1000 + (ABL:0 * 140)
	ELSEIF ABL:0 <= 11
		SOURCE:21 += 1200 + (ABL:0 * 160)
	ELSE
		SOURCE:21 += 1500 + (ABL:0 * 180)
	ENDIF
ELSE
	;主導権が相手側
	;ABL:サドっ気をみる
	IF ABL:15 == 0
		SOURCE:20 += 600
	ELSEIF ABL:15 == 1
		SOURCE:20 += 900
	ELSEIF ABL:15 == 2
		SOURCE:20 += 1200
	ELSEIF ABL:15 == 3
		SOURCE:20 += 1600
	ELSEIF ABL:15 == 4
		SOURCE:20 += 2000
	ELSE
		SOURCE:20 += 1000 + (ABL:15 * 300)
	ENDIF
ENDIF

;胸を舌で愛撫させる
@PASSIVE_T45
CALL PASSIVE_T44

;ぱふぱふ
@PASSIVE_T46
CALL PASSIVE_T44

;その他
@PASSIVE_ETC
DOWNBASE:1 += 20
;固定で獲得するソース
SOURCE:9 += 500


;奉仕精神をみる
IF ABL:6 == 0
	SOURCE:3 += 10
ELSEIF ABL:6 == 1
	SOURCE:3 += 30
ELSEIF ABL:6 == 2
	SOURCE:3 += 80
ELSEIF ABL:6 == 3
	SOURCE:3 += 150
ELSEIF ABL:6 == 4
	SOURCE:3 += 230
ELSE
	SOURCE:3 += 200 + (ABL:6 * 20)
ENDIF

;ABL:従順をみる
IF ABL:0 <= 1
	SOURCE:9 += (ABL:0 * 30)
ELSEIF ABL:0 <= 3
	SOURCE:9 += 200 + (ABL:0 * 30)
ELSEIF ABL:0 <= 5
	SOURCE:9 += 400 + (ABL:0 * 30)
ELSEIF ABL:0 <= 8
	SOURCE:9 += 600 + (ABL:0 * 40)
ELSEIF ABL:0 <= 11
	SOURCE:9 += 800 + (ABL:0 * 40)
ELSE
	SOURCE:9 += 1800 + (ABL:0 * 20)
ENDIF


;主導権をチェック
IF TFLAG:45 == 0
	;主導権が主人公側
	;ABL:従順をみる
	IF ABL:0 == 0
		SOURCE:21 += 100
	ELSEIF ABL:0 == 1
		SOURCE:21 += 200
	ELSEIF ABL:0 == 2
		SOURCE:21 += 350
	ELSEIF ABL:0 == 3
		SOURCE:21 += 500
	ELSEIF ABL:0 == 4
		SOURCE:21 += 700
	ELSE
		SOURCE:21 += 1000 + (ABL:0 * 100)
	ENDIF
ELSE
	;主導権が相手側
	;ABL:サドっ気をみる
	IF ABL:15 == 0
		SOURCE:20 += 500
	ELSEIF ABL:15 == 1
		SOURCE:20 += 700
	ELSEIF ABL:15 == 2
		SOURCE:20 += 900
	ELSEIF ABL:15 == 3
		SOURCE:20 += 1100
	ELSEIF ABL:15 == 4
		SOURCE:20 += 1300
	ELSE
		SOURCE:20 += 1000 + (ABL:15 * 150)
	ENDIF
ENDIF

