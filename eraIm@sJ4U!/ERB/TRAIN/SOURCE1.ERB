;FileName_SOURCE1.ERB ------------------------------ Rev1.00
;非TARGET依存性SOURCE
;CALL		USER
;ARG		キャラNO
;RETURN		VOID
;COMMENT	
;-----------------------------------------------------------
@SOURCE_EXP(ARG)
VARSET LOCAL
SIF SOURCE:ARG:快Ｃ
	EXP:ARG:Ｃ経験 ++
SIF SOURCE:ARG:快Ｖ && (!TALENT:ARG:処女 || !TFLAG:破瓜抑制)
	EXP:ARG:Ｖ経験 ++
SIF SOURCE:ARG:快Ａ
	EXP:ARG:Ａ経験 ++
SIF SOURCE:ARG:快Ｂ
	EXP:ARG:Ｂ経験 ++
SIF SOURCE:ARG:快Ｍ
	EXP:ARG:Ｍ経験 ++

;FileName_SOURCE1.ERB ------------------------------ Rev1.00
;快Ｃのソース処理
;CALL		USER
;ARG		キャラNO
;RETURN		VOID
;COMMENT	
;-----------------------------------------------------------
@SOURCE_快Ｃ(ARG)
VARSET LOCAL
;Ｃ敏感とＣ鈍感はここで処理
SIF TALENT:ARG:Ｃ鈍感
	TIMES SOURCE:0 , 0.50
SIF TALENT:ARG:Ｃ敏感
	TIMES SOURCE:0 , 2.00

;C感覚
SOURCE:ARG:快Ｃ = SOURCE:ARG:快Ｃ * SOURCE_REVISION1(ABL:ARG:Ｃ感覚) / 10

LOCAL = SOURCE:ARG:快Ｃ
;PALAM:欲情をみる
IF PALAM:ARG:欲情 < PALAMLV:1
	TIMES LOCAL , 0.80
ELSEIF PALAM:ARG:欲情 < PALAMLV:2
	TIMES LOCAL , 1.00
ELSEIF PALAM:ARG:欲情 < PALAMLV:3
	TIMES LOCAL , 1.20
ELSEIF PALAM:ARG:欲情 < PALAMLV:4
	TIMES LOCAL , 1.40
ELSEIF PALAM:ARG:欲情 >= PALAMLV:4
	TIMES LOCAL , 1.60
ENDIF
CUP:ARG:快Ｃ += LOCAL

LOCAL = SOURCE:ARG:快Ｃ
;ABL:欲望をみる
LOCAL = LOCAL * SOURCE_REVISION2(ABL:ARG:欲望) / 100

CUP:ARG:欲情 += LOCAL

;FileName_SOURCE1.ERB ------------------------------ Rev1.00
;快Ｖのソース処理
;CALL		USER
;ARG		キャラNO
;RETURN		VOID
;COMMENT	
;-----------------------------------------------------------
@SOURCE_快Ｖ(ARG)
VARSET LOCAL
;Ｖ敏感とＶ鈍感はここで処理
SIF TALENT:ARG:Ｖ鈍感
	TIMES SOURCE:1 , 0.50
SIF TALENT:ARG:Ｖ敏感
	TIMES SOURCE:1 , 2.00
	
;V感覚
SOURCE:ARG:快Ｖ = SOURCE:ARG:快Ｖ * SOURCE_REVISION1(ABL:ARG:Ｖ感覚) / 10

;EXP:Ｖ経験をみる
IF EXP:ARG:Ｖ経験 < EXPLV:1
	TIMES SOURCE:ARG:快Ｖ , 0.30
ELSEIF EXP:ARG:Ｖ経験 < EXPLV:2
	TIMES SOURCE:ARG:快Ｖ , 0.50
ELSEIF EXP:ARG:Ｖ経験 < EXPLV:3
	TIMES SOURCE:ARG:快Ｖ , 0.80
ELSEIF EXP:ARG:Ｖ経験 < EXPLV:4
	TIMES SOURCE:ARG:快Ｖ , 1.00
ELSEIF EXP:ARG:Ｖ経験 < EXPLV:5
	TIMES SOURCE:ARG:快Ｖ , 1.20
ELSEIF EXP:ARG:Ｖ経験 >= EXPLV:5
	TIMES SOURCE:ARG:快Ｖ , 1.50
ENDIF

;PALAM:潤滑をみる
IF PALAM:ARG:潤滑 < PALAMLV:1
	TIMES SOURCE:ARG:快Ｖ , 0.10
ELSEIF PALAM:ARG:潤滑 < PALAMLV:2
	TIMES SOURCE:ARG:快Ｖ , 0.40
ELSEIF PALAM:ARG:潤滑 < PALAMLV:3
	TIMES SOURCE:ARG:快Ｖ , 0.60
ELSEIF PALAM:ARG:潤滑 < PALAMLV:4
	TIMES SOURCE:ARG:快Ｖ , 0.80
ELSEIF PALAM:ARG:潤滑 >= PALAMLV:4
	TIMES SOURCE:ARG:快Ｖ , 1.00
ENDIF

LOCAL = SOURCE:ARG:快Ｖ
LOCAL:1 = SOURCE:ARG:快Ｖ

;PALAM:欲情をみる
IF PALAM:ARG:欲情 < PALAMLV:1
	TIMES LOCAL , 0.60
ELSEIF PALAM:ARG:欲情 < PALAMLV:2
	TIMES LOCAL , 0.80
ELSEIF PALAM:ARG:欲情 < PALAMLV:3
	TIMES LOCAL , 1.00
ELSEIF PALAM:ARG:欲情 < PALAMLV:4
	TIMES LOCAL , 1.20
ELSEIF PALAM:ARG:欲情 >= PALAMLV:4
	TIMES LOCAL , 1.50
ENDIF

;ABL:欲望をみる
LOCAL:1 = LOCAL:1 * SOURCE_REVISION2(ABL:ARG:欲望) / 100

;小人体型
IF TALENT:ARG:小人体型
	TIMES LOCAL , 0.80
	TIMES LOCAL:1 , 1.20
ENDIF

CUP:ARG:快Ｖ += LOCAL
CUP:ARG:欲情 += LOCAL:1

;FileName_SOURCE1.ERB ------------------------------ Rev1.00
;快Ａのソース処理
;CALL		USER
;ARG		キャラNO
;RETURN		VOID
;COMMENT	
;-----------------------------------------------------------
@SOURCE_快Ａ(ARG)
VARSET LOCAL

;Ａ敏感とＡ鈍感はここで処理
SIF TALENT:ARG:Ａ鈍感
	TIMES SOURCE:2 , 0.50
SIF TALENT:ARG:Ａ敏感
	TIMES SOURCE:2 , 2.00

;A感覚
SOURCE:ARG:快Ａ = SOURCE:ARG:快Ａ * SOURCE_REVISION1(ABL:ARG:Ａ感覚) / 10
;EXP:Ａ経験をみる
IF EXP:ARG:Ａ経験 < EXPLV:1
	TIMES SOURCE:ARG:快Ａ , 0.30
ELSEIF EXP:ARG:Ａ経験 < EXPLV:2
	TIMES SOURCE:ARG:快Ａ , 0.50
ELSEIF EXP:ARG:Ａ経験 < EXPLV:3
	TIMES SOURCE:ARG:快Ａ , 0.80
ELSEIF EXP:ARG:Ａ経験 < EXPLV:4
	TIMES SOURCE:ARG:快Ａ , 1.00
ELSEIF EXP:ARG:Ａ経験 < EXPLV:5
	TIMES SOURCE:ARG:快Ａ , 1.20
ELSEIF EXP:ARG:Ａ経験 >= EXPLV:5
	TIMES SOURCE:ARG:快Ａ , 1.50
ENDIF

;PALAM:潤滑をみる
IF PALAM:ARG:潤滑 < PALAMLV:1
	TIMES SOURCE:ARG:快Ａ , 0.40
ELSEIF PALAM:ARG:潤滑 < PALAMLV:2
	TIMES SOURCE:ARG:快Ａ , 0.60
ELSEIF PALAM:ARG:潤滑 < PALAMLV:3
	TIMES SOURCE:ARG:快Ａ , 0.80
ELSEIF PALAM:ARG:潤滑 < PALAMLV:4
	TIMES SOURCE:ARG:快Ａ , 0.90
ELSEIF PALAM:ARG:潤滑 >= PALAMLV:4
	TIMES SOURCE:ARG:快Ａ , 1.00
ENDIF

LOCAL = SOURCE:ARG:快Ａ
LOCAL:1 = SOURCE:ARG:快Ａ

;PALAM:欲情をみる
;快ＡはあまりPALAM:欲情では差が出ない
IF PALAM:ARG:欲情 < PALAMLV:1
	TIMES LOCAL , 0.90
ELSEIF PALAM:ARG:欲情 < PALAMLV:2
	TIMES LOCAL , 1.00
ELSEIF PALAM:ARG:欲情 < PALAMLV:3
	TIMES LOCAL , 1.10
ELSEIF PALAM:ARG:欲情 < PALAMLV:4
	TIMES LOCAL , 1.20
ELSEIF PALAM:ARG:欲情 >= PALAMLV:4
	TIMES LOCAL , 1.30
ENDIF

;ABL:欲望をみる
LOCAL:1 = LOCAL:1 * SOURCE_REVISION2(ABL:ARG:欲望) / 100

;小人体型
IF TALENT:ARG:小人体型
	TIMES LOCAL , 0.50
	TIMES LOCAL:1 , 1.50
ENDIF

;快Aのソースが0以上で処女で貞操観念のとき、屈服のソースを三分の一にする
IF EXP:ARG:Ｖ経験 == 0 && TALENT:ARG:貞操観念 && SOURCE:ARG:快Ａ > 0
	SOURCE:ARG:屈従 /= 3
ENDIF

CUP:ARG:快Ａ += LOCAL
CUP:ARG:欲情 += LOCAL:1

;FileName_SOURCE1.ERB ------------------------------ Rev1.00
;快Ｂのソース処理
;CALL		USER
;ARG		キャラNO
;RETURN		VOID
;COMMENT	
;-----------------------------------------------------------
@SOURCE_快Ｂ(ARG)
VARSET LOCAL
;Ｂ敏感とＢ鈍感はここで処理
SIF TALENT:ARG:Ｂ鈍感
	TIMES SOURCE:17 , 0.50
SIF TALENT:ARG:Ｂ敏感
	TIMES SOURCE:17 , 2.00

;B感覚
SOURCE:ARG:快Ｂ = SOURCE:ARG:快Ｂ * SOURCE_REVISION1(ABL:ARG:Ｂ感覚) / 10

LOCAL = SOURCE:ARG:快Ｂ

;PALAM:欲情をみる
IF PALAM:ARG:欲情 < PALAMLV:1
	TIMES LOCAL , 0.80
ELSEIF PALAM:ARG:欲情 < PALAMLV:2
	TIMES LOCAL , 1.00
ELSEIF PALAM:ARG:欲情 < PALAMLV:3
	TIMES LOCAL , 1.20
ELSEIF PALAM:ARG:欲情 < PALAMLV:4
	TIMES LOCAL , 1.40
ELSEIF PALAM:ARG:欲情 >= PALAMLV:4
	TIMES LOCAL , 1.60
ENDIF

CUP:ARG:快Ｂ += LOCAL

LOCAL = SOURCE:ARG:快Ｂ
;ABL:欲望をみる
LOCAL = LOCAL * SOURCE_REVISION2(ABL:ARG:欲望) / 100

CUP:ARG:欲情 += LOCAL


;FileName_SOURCE1.ERB ------------------------------ Rev1.00
;快Ｍのソース処理
;CALL		USER
;ARG		キャラNO
;RETURN		VOID
;COMMENT	
;-----------------------------------------------------------
@SOURCE_快Ｍ(ARG)
VARSET LOCAL
;コンフィグでＭ感覚がOFFになっていたら快Ｍソースを0にして終了
IF (FLAG:62 & 4194304) == 0
	SOURCE:ARG:快Ｍ = 0
	RETURN 0
ENDIF

;Ｍ敏感とＭ鈍感はここで処理
SIF TALENT:ARG:Ｍ鈍感
	TIMES SOURCE:ARG:快Ｍ , 0.50
SIF TALENT:ARG:Ｍ敏感
	TIMES SOURCE:ARG:快Ｍ , 2.00
;B感覚
SOURCE:ARG:快Ｍ = SOURCE:ARG:快Ｍ * SOURCE_REVISION1(ABL:ARG:Ｍ感覚) / 10

LOCAL = SOURCE:ARG:快Ｍ

;PALAM:欲情をみる・欲情による変動が少ない
IF PALAM:ARG:欲情 < PALAMLV:1
	TIMES LOCAL , 0.80
ELSEIF PALAM:ARG:欲情 < PALAMLV:2
	TIMES LOCAL , 0.90
ELSEIF PALAM:ARG:欲情 < PALAMLV:3
	TIMES LOCAL , 1.00
ELSEIF PALAM:ARG:欲情 < PALAMLV:4
	TIMES LOCAL , 1.10
ELSEIF PALAM:ARG:欲情 >= PALAMLV:4
	TIMES LOCAL , 1.20
ENDIF

CUP:ARG:快Ｍ += LOCAL

LOCAL = SOURCE:ARG:快Ｍ
;ABL:欲望をみる
LOCAL = LOCAL * SOURCE_REVISION2(ABL:ARG:欲望) / 100

CUP:ARG:欲情 += LOCAL
;CUP:ARG:恭順 += LOCAL


;FileName_SOURCE1.ERB ------------------------------ Rev1.00
;その他系ソース処理
;CALL		USER
;ARG		キャラNO
;RETURN		VOID
;COMMENT	
;-----------------------------------------------------------
@SOURCE_CVAB_EXTRA(ARG)
VARSET LOCAL
R = NO:PLAYER
;-------------------------------------------------
;気力０による上下の処理（快楽系）
;-------------------------------------------------
IF BASE:ARG:気力 <= 0
	;UP:0,1,2,3は絶頂に絡むので先に処理してある
	CUP:ARG:快Ｃ /= 2
	CUP:ARG:快Ｖ /= 2
	CUP:ARG:快Ａ /= 2
	CUP:ARG:快Ｂ /= 2
	CUP:ARG:快Ｍ /= 2
ENDIF
;-------------------------------------------------
;相性による上下の処理（快楽系）
;-------------------------------------------------
IF RELATION:ARG:R != 0
	CUP:ARG:快Ｃ *= RELATION:ARG:R
	CUP:ARG:快Ｃ /= 100
	CUP:ARG:快Ｖ *= RELATION:ARG:R
	CUP:ARG:快Ｖ /= 100
	CUP:ARG:快Ａ *= RELATION:ARG:R
	CUP:ARG:快Ａ /= 100
	CUP:ARG:快Ｂ *= RELATION:ARG:R
	CUP:ARG:快Ｂ /= 100
	CUP:ARG:快Ｍ *= RELATION:ARG:R
	CUP:ARG:快Ｍ /= 100
ENDIF
;-------------------------------------------------
;快感の否定は、快ソースの数値に応じて、抑鬱増加（淫乱で無効）
;-------------------------------------------------
SIF TALENT:ARG:快感の否定 && !TALENT:ARG:淫乱
	SOURCE:ARG:反感 += (CUP:ARG:快Ｃ + CUP:ARG:快Ｖ + CUP:ARG:快Ａ + CUP:ARG:快Ｂ+ CUP:ARG:快Ｍ)/10

;-------------------------------------------------
;素質などによる上下の処理（快楽系）
;-------------------------------------------------
;媚薬
IF TEQUIP:ARG:媚薬
	TIMES CUP:ARG:快Ｃ , 2.00
	TIMES CUP:ARG:快Ｖ , 2.00
	TIMES CUP:ARG:快Ａ , 2.00
	TIMES CUP:ARG:快Ｂ , 2.00
	TIMES CUP:ARG:快Ｍ , 2.00
ENDIF
	;利尿剤
IF TEQUIP:ARG:利尿剤
	TIMES CUP:ARG:快Ｃ , 0.70
	TIMES CUP:ARG:快Ｖ , 0.70
	TIMES CUP:ARG:快Ａ , 0.70
	TIMES CUP:ARG:快Ｂ , 0.70
	TIMES CUP:ARG:快Ｍ , 0.70
ENDIF
;-------------------------------------------------
;陥落素質
;-------------------------------------------------
;淫乱
IF TALENT:ARG:淫乱
	TIMES CUP:ARG:快Ｃ , 1.20
	TIMES CUP:ARG:快Ｖ , 1.20
	TIMES CUP:ARG:快Ａ , 1.20
	TIMES CUP:ARG:快Ｂ , 1.20
	TIMES CUP:ARG:快Ｍ , 1.20
ENDIF
;-------------------------------------------------
;素質
;-------------------------------------------------
;自制心
IF TALENT:ARG:自制心
	TIMES CUP:ARG:快Ｃ , 0.70
	TIMES CUP:ARG:快Ｖ , 0.90
	TIMES CUP:ARG:快Ａ , 1.00
	TIMES CUP:ARG:快Ｂ , 0.70
	TIMES CUP:ARG:快Ｍ , 0.70
ENDIF
	;即落ち
IF TALENT:ARG:即落ち
	TIMES CUP:ARG:快Ｃ , 2.00
	TIMES CUP:ARG:快Ｖ , 2.00
	TIMES CUP:ARG:快Ａ , 2.00
	TIMES CUP:ARG:快Ｂ , 2.00
	TIMES CUP:ARG:快Ｍ , 2.00
ENDIF
;陰核
SIF TALENT:ARG:淫核
	TIMES CUP:ARG:快Ｃ , 1.20
;淫壺
SIF TALENT:ARG:淫壷
	TIMES CUP:ARG:快Ｖ , 1.20
;尻穴狂い
SIF TALENT:ARG:尻穴狂い
	TIMES CUP:ARG:快Ａ , 1.20
;淫乳
SIF TALENT:ARG:淫乳
	TIMES CUP:ARG:快Ｂ , 1.20
;蕩唇
SIF TALENT:ARG:蕩唇
	TIMES CUP:ARG:快Ｍ , 1.20
;キス魔
SIF TALENT:ARG:キス魔
	TIMES CUP:ARG:快Ｍ , 1.20
;オトコ
SIF TALENT:ARG:オトコ
	TIMES CUP:ARG:快Ａ , 1.30
	
;淫蟲
IF TEQUIP:蟲風呂プレイ
	TIMES CUP:ARG:快Ｃ , 2.00
	TIMES CUP:ARG:快Ｖ , 2.00
	TIMES CUP:ARG:快Ａ , 2.00
	TIMES CUP:ARG:快Ｂ , 2.00
	TIMES CUP:ARG:快Ｍ , 2.00
ENDIF
;-------------------------------------------------
;難易度による上下の処理（快楽系）
;-------------------------------------------------
;CUP:ARG:快Ｃ = CUP:ARG:快Ｃ * (16 - 4 * FLAG:難易度) / 10
;CUP:ARG:快Ｖ = CUP:ARG:快Ｖ * (16 - 4 * FLAG:難易度) / 10
;CUP:ARG:快Ａ = CUP:ARG:快Ａ * (16 - 4 * FLAG:難易度) / 10
;CUP:ARG:快Ｂ = CUP:ARG:快Ｂ * (16 - 4 * FLAG:難易度) / 10
;CUP:ARG:快Ｍ = CUP:ARG:快Ｍ * (16 - 4 * FLAG:難易度) / 10
;EASY
IF FLAG:5 == 0
	TIMES CUP:ARG:快Ｃ , 1.60
	TIMES CUP:ARG:快Ｖ , 1.60
	TIMES CUP:ARG:快Ａ , 1.60
	TIMES CUP:ARG:快Ｂ , 1.60
	TIMES CUP:ARG:快Ｍ , 1.60
;NORMAL
ELSEIF FLAG:5 == 1
	TIMES CUP:ARG:快Ｃ , 1.20
	TIMES CUP:ARG:快Ｖ , 1.20
	TIMES CUP:ARG:快Ａ , 1.20
	TIMES CUP:ARG:快Ｂ , 1.20
	TIMES CUP:ARG:快Ｍ , 1.20
;HARD
ELSEIF FLAG:5 == 2
	TIMES CUP:ARG:快Ｃ , 0.80
	TIMES CUP:ARG:快Ｖ , 0.80
	TIMES CUP:ARG:快Ａ , 0.80
	TIMES CUP:ARG:快Ｂ , 0.80
	TIMES CUP:ARG:快Ｍ , 0.80
;MASTER
ELSEIF FLAG:5 == 3
	TIMES CUP:ARG:快Ｃ , 0.50
	TIMES CUP:ARG:快Ｖ , 0.50
	TIMES CUP:ARG:快Ａ , 0.50
	TIMES CUP:ARG:快Ｂ , 0.50
	TIMES CUP:ARG:快Ｍ , 0.50
ENDIF
;-------------------------------------------------
;愛液処理
;-------------------------------------------------
LOCAL:1 = CUP:ARG:快Ｃ + CUP:ARG:快Ｖ + CUP:ARG:快Ａ + CUP:ARG:快Ｂ + CUP:ARG:快Ｍ
;快Ｍは他の感覚より液体ソースへの影響が少ない
SIF CUP:ARG:快Ｍ > 1000
	LOCAL:1 += CUP:ARG:快Ｍ / 1000
;快Ｃ＋快Ｖ＋快Ａ＋快Ｂが合わせて100以上上昇ならその20%の液体のソースが加わる（オトコはダメ）
IF LOCAL:1 > 100 && !TALENT:オトコ
	;濡れやすいと濡れにくいはここで処理
	LOCAL:1 = LOCAL:1 * (10 + 5 * GET_TALENT_LV(ARG, "濡れやすさ")) / 10
	SOURCE:ARG:液体 += LOCAL:1 / 5
ENDIF

;=============================================================================
;ソース計算(快楽以外)
;=============================================================================

;FileName_SOURCE1.ERB ------------------------------ Rev1.00
;情愛のソース処理
;CALL		USER
;ARG		キャラNO
;RETURN		VOID
;COMMENT	
;-----------------------------------------------------------
@SOURCE_情愛(ARG)
VARSET LOCAL

LOCAL = SOURCE:ARG:情愛

;ABL:従順をみる
SELECTCASE ABL:ARG:親密
	CASE 0
		TIMES LOCAL , 0.10
	CASE 1
		TIMES LOCAL , 0.50
	CASE 2
		TIMES LOCAL , 1.00
	CASE 3
		TIMES LOCAL , 1.50
	CASE 4
		TIMES LOCAL , 2.00
	CASE 5
		TIMES LOCAL , 2.50
	CASE 6
		TIMES LOCAL , 3.00
	CASE 7
		TIMES LOCAL , 3.50
	CASE 8
		TIMES LOCAL , 4.00
	CASE 9
		TIMES LOCAL , 5.00
	CASEELSE
		LOCAL = LOCAL * (ABL:ARG:親密 - 4)
ENDSELECT

LOCAL:1 = SOURCE:ARG:情愛

;欲望を見る
SELECTCASE ABL:ARG:欲望
	CASE 0
		TIMES LOCAL:1 , 0.00
	CASE 1
		TIMES LOCAL:1 , 0.40
	CASE 2
		TIMES LOCAL:1 , 0.80
	CASE 3
		TIMES LOCAL:1 , 1.20
	CASE 4
		TIMES LOCAL:1 , 1.60
	CASE 5
		TIMES LOCAL:1 , 2.00
	CASE 6
		TIMES LOCAL:1 , 2.40
	CASE 7
		TIMES LOCAL:1 , 2.80
	CASE 8
		TIMES LOCAL:1 , 3.20
	CASE 9
		TIMES LOCAL:1 , 3.60
	CASEELSE
		LOCAL:1 = LOCAL:1 * ABL:ARG:欲望 * 50 / 100
ENDSELECT

CUP:ARG:恭順 += LOCAL
CUP:ARG:欲情 += LOCAL:1

;FileName_SOURCE1.ERB ------------------------------ Rev1.00
;性行動のソース処理
;CALL		USER
;ARG		キャラNO
;RETURN		VOID
;COMMENT	
;-----------------------------------------------------------
@SOURCE_性行動(ARG)
VARSET LOCAL

LOCAL = SOURCE:ARG:性行動
LOCAL:1 = SOURCE:ARG:性行動 / 5

;ABL:技巧をみる
SELECTCASE ABL:ARG:技巧
	CASE 0
		TIMES LOCAL , 0.60
	CASE 1
		TIMES LOCAL , 1.20
	CASE 2
		TIMES LOCAL , 1.80
	CASE 3
		TIMES LOCAL , 2.40
	CASE 4
		TIMES LOCAL , 3.00
	CASE 5
		TIMES LOCAL , 3.60
	CASE 6
		TIMES LOCAL , 4.20
	CASE 7
		TIMES LOCAL , 4.80
	CASE 8
		TIMES LOCAL , 5.40
	CASE 9
		TIMES LOCAL , 6.00
	CASEELSE
		LOCAL = LOCAL * (ABL:ARG:技巧 - 3)
ENDSELECT

;ABL:奉仕精神をみる
SELECTCASE ABL:ARG:奉仕精神
	CASE 0
		TIMES LOCAL , 0.60
	CASE 1
		TIMES LOCAL , 0.80
	CASE 2
		TIMES LOCAL , 1.00
	CASE 3
		TIMES LOCAL , 1.20
	CASE 4
		TIMES LOCAL , 1.40
	CASE 5
		TIMES LOCAL , 1.70
	CASE 6
		TIMES LOCAL , 2.00
	CASE 7
		TIMES LOCAL , 2.40
	CASE 8
		TIMES LOCAL , 2.80
	CASE 9
		TIMES LOCAL , 4.00
	CASEELSE
		LOCAL = LOCAL * (ABL:ARG:奉仕精神 - 5)
ENDSELECT

;抑圧か抵抗がある場合はPALAM:抑鬱が上がる
IF TALENT:ARG:抑圧 || TALENT:ARG:抵抗
	;ABL:奉仕精神をみる
	SELECTCASE ABL:ARG:奉仕精神
		CASE 0
			TIMES LOCAL:1 , 2.00
		CASE 1
			TIMES LOCAL:1 , 1.80
		CASE 2
			TIMES LOCAL:1 , 1.60
		CASE 3
			TIMES LOCAL:1 , 1.40
		CASE 4
			TIMES LOCAL:1 , 1.20
		CASE 5
			TIMES LOCAL:1 , 1.00
		CASE 6
			TIMES LOCAL:1 , 0.80
		CASE 7
			TIMES LOCAL:1 , 0.60
		CASE 8
			TIMES LOCAL:1 , 0.40
		CASE 9
			TIMES LOCAL:1 , 0.20
		CASEELSE
			LOCAL:1 = LOCAL:1 * (200 - GET_REVISION(ABL:ARG:奉仕精神, 200, 10)) / 1000
	ENDSELECT
ELSE
	LOCAL:1 = 0
ENDIF

CUP:ARG:習得 += LOCAL
CUP:ARG:抑鬱 += LOCAL:1

;FileName_SOURCE1.ERB ------------------------------ Rev1.00
;達成のソース処理
;CALL		USER
;ARG		キャラNO
;RETURN		VOID
;COMMENT	
;-----------------------------------------------------------
@SOURCE_達成(ARG)
VARSET LOCAL
LOCAL = SOURCE:ARG:達成

;ABL:従順をみる
SELECTCASE ABL:ARG:親密
	CASE 0
		TIMES LOCAL , 0.50
	CASE 1
		TIMES LOCAL , 1.00
	CASE 2
		TIMES LOCAL , 1.50
	CASE 3
		TIMES LOCAL , 2.00
	CASE 4
		TIMES LOCAL , 2.50
	CASE 5
		TIMES LOCAL , 3.00
	CASE 6
		TIMES LOCAL , 3.50
	CASE 7
		TIMES LOCAL , 4.00
	CASE 8
		TIMES LOCAL , 4.50
	CASE 9
		TIMES LOCAL , 5.00
	CASEELSE
		LOCAL = LOCAL * (ABL:ARG:親密 - 4)
ENDSELECT
;ABL:奉仕精神をみる
SELECTCASE ABL:ARG:奉仕精神
	CASE 0
		TIMES LOCAL , 0.00
	CASE 1
		TIMES LOCAL , 0.50
	CASE 2
		TIMES LOCAL , 1.00
	CASE 3
		TIMES LOCAL , 1.50
	CASE 4
		TIMES LOCAL , 2.00
	CASE 5
		TIMES LOCAL , 2.50
	CASE 6
		TIMES LOCAL , 3.00
	CASE 7
		TIMES LOCAL , 3.50
	CASE 8
		TIMES LOCAL , 4.00
	CASE 9
		TIMES LOCAL , 4.50
	CASEELSE
		LOCAL = LOCAL * (ABL:ARG:奉仕精神 * 150 - 900 ) / 100
ENDSELECT

CUP:ARG:恭順 += LOCAL

;FileName_SOURCE1.ERB ------------------------------ Rev1.00
;苦痛のソース処理
;CALL		USER
;ARG		キャラNO
;RETURN		VOID
;COMMENT	
;-----------------------------------------------------------
@SOURCE_痛み(ARG)
VARSET LOCAL
LOCAL = SOURCE:ARG:痛み
LOCAL:1 = SOURCE:ARG:痛み
LOCAL:2 = SOURCE:ARG:痛み / 20
LOCAL:3 = SOURCE:ARG:痛み

;相性による修正
;IF ARG == TARGET
;	LOCAL:1 *= LIMIT(100 + (GET_RELATION(ARG, PLAYER) - 100)/4 , 75, 125)
;	LOCAL:1 /= 100
;ENDIF

;マゾっ気
SELECTCASE ABL:ARG:マゾっ気
	CASE 0
		TIMES LOCAL:1 , 0.00
		TIMES LOCAL:3 , 1.00
	CASE 1
		TIMES LOCAL:1 , 0.10
		TIMES LOCAL:3 , 0.90
	CASE 2
		TIMES LOCAL:1 , 0.20
		TIMES LOCAL:3 , 0.80
	CASE 3
		TIMES LOCAL:1 , 0.30
		TIMES LOCAL:3 , 0.70
	CASE 4
		TIMES LOCAL:1 , 0.45
		TIMES LOCAL:3 , 0.60
	CASE 5
		TIMES LOCAL:1 , 0.60
		TIMES LOCAL:3 , 0.50
	CASE 6
		TIMES LOCAL:1 , 0.75
		TIMES LOCAL:3 , 0.40
	CASE 7
		TIMES LOCAL:1 , 0.90
		TIMES LOCAL:3 , 0.30
	CASE 8
		TIMES LOCAL:1 , 1.20
		TIMES LOCAL:3 , 0.20
	CASE 9
		TIMES LOCAL:1 , 1.50
		TIMES LOCAL:3 , 0.10
	CASEELSE
		LOCAL:1 = LOCAL:1 * (ABL:ARG:マゾっ気 * 30) / 100
		LOCAL:3 = LOCAL:3 * (100 - GET_REVISION(ABL:ARG:マゾっ気, 100, 20)) / 1000
ENDSELECT

SELECTCASE ABL:ARG:親密
	CASE 0
		TIMES LOCAL:2 , 1.20
		TIMES LOCAL:3 , 1.00
	CASE 1
		TIMES LOCAL:2 , 1.10
		TIMES LOCAL:3 , 0.90
	CASE 2
		TIMES LOCAL:2 , 1.00
		TIMES LOCAL:3 , 0.80
	CASE 3
		TIMES LOCAL:2 , 0.90
		TIMES LOCAL:3 , 0.70
	CASE 4
		TIMES LOCAL:2 , 0.80
		TIMES LOCAL:3 , 0.60
	CASE 5
		TIMES LOCAL:2 , 0.70
		TIMES LOCAL:3 , 0.50
	CASE 6
		TIMES LOCAL:2 , 0.60
		TIMES LOCAL:3 , 0.40
	CASE 7
		TIMES LOCAL:2 , 0.50
		TIMES LOCAL:3 , 0.30
	CASE 8
		TIMES LOCAL:2 , 0.40
		TIMES LOCAL:3 , 0.20
	CASE 9
		TIMES LOCAL:2 , 0.30
		TIMES LOCAL:3 , 0.10
	CASEELSE
		LOCAL:2 = LOCAL:2 * (300 - GET_REVISION(ABL:ARG:親密, 300, 30)) / 1000
		LOCAL:3 = LOCAL:3 * (100 - GET_REVISION(ABL:ARG:親密, 100, 50)) / 1000
ENDSELECT
;調教者のサドっ気を見る
SIF ABL:PLAYER:サドっ気 > 0
	LOCAL:1 = LOCAL:1 * (100 + ABL:PLAYER:サドっ気 * 10) / 100
	;LOCAL:3 = LOCAL:3 * (100 - GET_REVISION(ABL:PLAYER:サドっ気, 100, 20)) / 1000
;ENDSELECT

;助手によるプレイ
SIF ASSIPLAY
	TIMES LOCAL:3 , 0.40

;小人体型
IF TALENT:ARG:小人体型
	TIMES LOCAL , 2.00
	TIMES LOCAL:1 , 0.75
ENDIF

;調教者が【サド】
SIF TALENT:PLAYER:サド
	TIMES LOCAL:1 , 2.50

;臆病
SIF TALENT:ARG:臆病
	TIMES LOCAL:2 , 2.00

;マゾっ気があるとPALAM:欲情も上がる
;そのとき調教者が【サド】だと効果的
;苦痛に応じて恐怖のソースが増加する
;A
CUP:ARG:苦痛 += LOCAL
;D
CUP:ARG:欲情 += LOCAL:1
;B
CUP:ARG:恐怖 += LOCAL:2
;C
CUP:ARG:反感 += LOCAL:3

;FileName_SOURCE1.ERB ------------------------------ Rev1.00
;中毒充足のソース処理
;CALL		USER
;ARG		キャラNO
;RETURN		VOID
;COMMENT	
;-----------------------------------------------------------
@SOURCE_中毒(ARG)
VARSET LOCAL
LOCAL = SOURCE:ARG:中毒
LOCAL:1 = SOURCE:ARG:中毒

;欲望
SELECTCASE ABL:ARG:欲望
	CASE 0
		TIMES LOCAL , 0.40
		TIMES LOCAL:1 , 0.50
	CASE  1
		TIMES LOCAL , 0.60
		TIMES LOCAL:1 , 0.70
	CASE  2
		TIMES LOCAL , 0.80
		TIMES LOCAL:1 , 0.90
	CASE  3
		TIMES LOCAL , 1.00
		TIMES LOCAL:1 , 1.10
	CASE  4
		TIMES LOCAL , 1.20
		TIMES LOCAL:1 , 1.30
	CASE  5
		TIMES LOCAL , 1.40
		TIMES LOCAL:1 , 1.50
	CASE  6
		TIMES LOCAL , 1.60
		TIMES LOCAL:1 , 1.70
	CASE  7
		TIMES LOCAL , 1.80
		TIMES LOCAL:1 , 1.90
	CASE  8
		TIMES LOCAL , 2.00
		TIMES LOCAL:1 , 2.10
	CASE  9
		TIMES LOCAL , 2.20
		TIMES LOCAL:1 , 2.30
	CASEELSE
		LOCAL = LOCAL * ABL:ARG:欲望 * 25 / 10
		LOCAL:1 = LOCAL:1 * (ABL:ARG:欲望 * 40 - 130) / 10
ENDSELECT

;マゾ
IF TALENT:ARG:マゾ
	TIMES LOCAL , 1.20
	TIMES LOCAL:1 , 1.50
ENDIF

CUP:ARG:恭順 += LOCAL
CUP:ARG:欲情 += LOCAL:1


;FileName_SOURCE1.ERB ------------------------------ Rev1.00
;液体のソース処理
;CALL		USER
;ARG		キャラNO
;RETURN		VOID
;COMMENT	
;-----------------------------------------------------------
@SOURCE_液体(ARG)
VARSET LOCAL
LOCAL = SOURCE:ARG:液体
;小人体型
IF TALENT:ARG:小人体型
	SIF SELECTCOM != [[調教:ローション]] && SELECTCOM != 180
		TIMES LOCAL , 0.40
ENDIF

CUP:ARG:潤滑 += LOCAL

;FileName_SOURCE1.ERB ------------------------------ Rev1.00
;欲情のソース処理
;CALL		USER
;ARG		キャラNO
;RETURN		VOID
;COMMENT	
;-----------------------------------------------------------
@SOURCE_欲情(ARG)
VARSET LOCAL
LOCAL = SOURCE:ARG:欲情

;欲望を見る
SELECTCASE ABL:ARG:欲望
	CASE 0
		TIMES LOCAL , 0.20
	CASE 1
		TIMES LOCAL , 0.40
	CASE 2
		TIMES LOCAL , 0.80
	CASE 3
		TIMES LOCAL , 1.20
	CASE 4
		TIMES LOCAL , 1.60
	CASE 5
		TIMES LOCAL , 2.00
	CASE 6
		TIMES LOCAL , 2.40
	CASE 7
		TIMES LOCAL , 2.80
	CASE 8
		TIMES LOCAL , 3.20
	CASE 9
		TIMES LOCAL , 3.60
	CASEELSE
		LOCAL = LOCAL * (ABL:ARG:欲望 * 15 - 100) / 10
ENDSELECT

CUP:ARG:欲情 += LOCAL

;FileName_SOURCE1.ERB ------------------------------ Rev1.00
;恭順のソース処理
;CALL		USER
;ARG		キャラNO
;RETURN		VOID
;COMMENT	
;-----------------------------------------------------------
@SOURCE_恭順(ARG)
VARSET LOCAL
LOCAL = SOURCE:ARG:恭順

;ABL:従順をみる
SELECTCASE ABL:ARG:親密
	CASE 0
		TIMES LOCAL , 0.50
	CASE 1
		TIMES LOCAL , 0.80
	CASE 2
		TIMES LOCAL , 1.00
	CASE 3
		TIMES LOCAL , 1.20
	CASE 4
		TIMES LOCAL , 1.40
	CASE 5
		TIMES LOCAL , 1.60
	CASE 6
		TIMES LOCAL , 1.80
	CASE 7
		TIMES LOCAL , 2.00
	CASE 8
		TIMES LOCAL , 2.40
	CASE 9
		TIMES LOCAL , 3.00
	CASEELSE
		LOCAL = LOCAL * (ABL:ARG:親密 - 5) * 2 - LOCAL
ENDSELECT

CUP:ARG:恭順 += LOCAL

;FileName_SOURCE1.ERB ------------------------------ Rev1.00
;露出のソース処理
;CALL		USER
;ARG		キャラNO
;RETURN		VOID
;COMMENT	
;-----------------------------------------------------------
@SOURCE_露出(ARG)
VARSET LOCAL
;恥じらいと恥薄いはここで処理
SIF TALENT:ARG:恥薄い
	TIMES SOURCE:ARG:露出 , 2.00
SIF TALENT:ARG:恥じらい
	TIMES SOURCE:ARG:露出 , 0.50

;潤滑アップの50％を露出のソースに加える
;ただし液体追加のソースのぶんは引く
SOURCE:ARG:露出 += (CUP:ARG:潤滑 - SOURCE:ARG:液体) / 2

LOCAL = SOURCE:ARG:露出
LOCAL:1 = SOURCE:ARG:露出
LOCAL:2 = SOURCE:ARG:露出

;ABL:露出癖をみる
SELECTCASE ABL:ARG:露出癖
	CASE 0
		TIMES LOCAL , 0.00
		TIMES LOCAL:2 , 1.00
	CASE 1
		TIMES LOCAL , 0.10
		TIMES LOCAL:2 , 0.90
	CASE 2
		TIMES LOCAL , 0.20
		TIMES LOCAL:2 , 0.80
	CASE 3
		TIMES LOCAL , 0.40
		TIMES LOCAL:2 , 0.70
	CASE 4
		TIMES LOCAL , 0.60
		TIMES LOCAL:2 , 0.60
	CASE 5
		TIMES LOCAL , 0.80
		TIMES LOCAL:2 , 0.50
	CASE 6
		TIMES LOCAL , 1.00
		TIMES LOCAL:2 , 0.40
	CASE 7
		TIMES LOCAL , 1.20
		TIMES LOCAL:2 , 0.30
	CASE 8
		TIMES LOCAL , 1.40
		TIMES LOCAL:2 , 0.20
	CASE 9
		TIMES LOCAL , 1.60
		TIMES LOCAL:2 , 0.10
	CASEELSE
		LOCAL = LOCAL * (ABL:ARG:露出癖 * 40 - 200)/ 100
		LOCAL:2 = LOCAL:2 *  (100 - GET_REVISION(ABL:ARG:露出癖, 100, 50)) / 1000
ENDSELECT

;PALAM:恥情をみる
;恥ずかしさを感じれば感じるほどあまり恥ずかしくなくなる
IF PALAM:ARG:恥情 < PALAMLV:1
	TIMES LOCAL:1 , 1.00
ELSEIF PALAM:ARG:恥情 < PALAMLV:2
	TIMES LOCAL:1 , 0.90
ELSEIF PALAM:ARG:恥情 < PALAMLV:3
	TIMES LOCAL:1 , 0.80
ELSEIF PALAM:ARG:恥情 < PALAMLV:4
	TIMES LOCAL:1 , 0.70
ELSEIF PALAM:ARG:恥情 >= PALAMLV:4
	TIMES LOCAL:1 , 0.60
ENDIF



;ABL:従順をみる
SELECTCASE ABL:ARG:親密
	CASE 0
		TIMES LOCAL:2 , 0.50
	CASEELSE
		LOCAL:2 = LOCAL:2 * (50 - 5 * ABL:ARG:親密) / 100
		SIF LOCAL:2 < 0
			LOCAL:2 = 0
ENDSELECT

;マゾ
IF TALENT:ARG:マゾ
	TIMES LOCAL , 1.50
	TIMES LOCAL:1 , 1.50
	TIMES LOCAL:2 , 0.50
ENDIF


CUP:ARG:欲情 += LOCAL
CUP:ARG:恥情 += LOCAL:1
CUP:ARG:反感 += LOCAL:2

;FileName_SOURCE1.ERB ------------------------------ Rev1.00
;屈従のソース処理
;CALL		USER
;ARG		キャラNO
;RETURN		VOID
;COMMENT	
;-----------------------------------------------------------
@SOURCE_屈従(ARG)
VARSET LOCAL
LOCAL = SOURCE:ARG:屈従
LOCAL:1 = SOURCE:ARG:屈従

;ABL:従順をみる
SELECTCASE ABL:ARG:親密
	CASE 0
		TIMES LOCAL , 0.50
		TIMES LOCAL:1 , 0.20
	CASE 1
		TIMES LOCAL , 1.00
		TIMES LOCAL:1 , 0.18
	CASE 2
		TIMES LOCAL , 1.50
		TIMES LOCAL:1 , 0.16
	CASE 3
		TIMES LOCAL , 2.00
		TIMES LOCAL:1 , 0.14
	CASE 4
		TIMES LOCAL , 2.50
		TIMES LOCAL:1 , 0.12
	CASE 5
		TIMES LOCAL , 3.00
		TIMES LOCAL:1 , 0.10
	CASE 6
		TIMES LOCAL , 3.50
		TIMES LOCAL:1 , 0.08
	CASE 7
		TIMES LOCAL , 4.00
		TIMES LOCAL:1 , 0.06
	CASE 8
		TIMES LOCAL , 4.50
		TIMES LOCAL:1 , 0.04
	CASE 9
		TIMES LOCAL , 5.00
		TIMES LOCAL:1 , 0.02
	CASEELSE
		LOCAL = LOCAL * (ABL:ARG:親密 - 4)
		LOCAL:1 *= 0
ENDSELECT

;ABL:奉仕精神をみる
SELECTCASE ABL:ARG:奉仕精神
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 1.50
	CASE 2
		TIMES LOCAL , 2.00
	CASE 3
		TIMES LOCAL , 2.50
	CASE 4
		TIMES LOCAL , 3.00
	CASE 5
		TIMES LOCAL , 3.50
	CASE 6
		TIMES LOCAL , 4.00
	CASE 7
		TIMES LOCAL , 4.50
	CASE 8
		TIMES LOCAL , 5.00
	CASE 9
		TIMES LOCAL , 5.50
	CASE 10
		TIMES LOCAL , 7.00
	CASEELSE
		LOCAL = LOCAL * (ABL:ARG:奉仕精神 * 15 - 80) / 10
ENDSELECT

CUP:ARG:屈服 += LOCAL
CUP:ARG:抑鬱 += LOCAL:1


;---------------------------------------------------
;PLAYERにも影響を与えるSOURCE
;---------------------------------------------------
;FileName_SOURCE1.ERB ------------------------------ Rev1.00
;歓楽のソース処理
;CALL		USER
;ARG		キャラNO
;RETURN		VOID
;COMMENT	
;-----------------------------------------------------------
@SOURCE_歓楽(ARG)
VARSET LOCAL
LOCAL = SOURCE:ARG:歓楽

;恋慕
SIF TALENT:ARG:恋慕
	TIMES LOCAL , 1.50

;親愛
SIF TALENT:ARG:親愛
	TIMES LOCAL , 1.50
	
;恋人
SIF TALENT:ARG:恋人
	TIMES LOCAL , 1.20

;キス魔
;ボールギャグ装着中・縄拘束中・触手召喚中は無効
SIF TALENT:ARG:キス魔 && TEQUIP:ARG:縄 == 0 && TEQUIP:ARG:ボールギャグ == 0 && TEQUIP:ARG:触手プレイ == 0
	TIMES LOCAL , 1.20
;ABL:従順をみる
SELECTCASE ABL:ARG:親密
	CASE 0
		TIMES LOCAL , 0.10
	CASE 1
		TIMES LOCAL , 0.50
	CASE 2
		TIMES LOCAL , 1.00
	CASE 3
		TIMES LOCAL , 1.50
	CASE 4
		TIMES LOCAL , 2.00
	CASE 5
		TIMES LOCAL , 2.50
	CASE 6
		TIMES LOCAL , 3.00
	CASE 7
		TIMES LOCAL , 3.50
	CASE 8
		TIMES LOCAL , 4.00
	CASE 9
		TIMES LOCAL , 5.00
	CASEELSE
		LOCAL = LOCAL * (ABL:ARG:親密 - 4)
ENDSELECT

;ABL:従順をみる
SELECTCASE ABL:ARG:欲望
	CASE 0
		TIMES LOCAL , 0.10
	CASE 1
		TIMES LOCAL , 0.50
	CASE 2
		TIMES LOCAL , 1.00
	CASE 3
		TIMES LOCAL , 1.50
	CASE 4
		TIMES LOCAL , 2.00
	CASE 5
		TIMES LOCAL , 2.50
	CASE 6
		TIMES LOCAL , 3.00
	CASE 7
		TIMES LOCAL , 3.50
	CASE 8
		TIMES LOCAL , 4.00
	CASE 9
		TIMES LOCAL , 5.00
	CASEELSE
		LOCAL = LOCAL * (ABL:ARG:欲望 - 4)
ENDSELECT

;好感度を見る
SELECTCASE CFLAG:ARG:好感度
	CASE IS <= 10
		TIMES LOCAL , 0.50
	CASE IS <= 50
		TIMES LOCAL , 0.80
	CASE IS <= 100
		TIMES LOCAL , 1.00
	CASE IS <= 300
		TIMES LOCAL , 1.10
	CASE IS <= 500
		TIMES LOCAL , 1.20
	CASE IS <= 700
		TIMES LOCAL , 1.30
	CASE IS <= 1000
		TIMES LOCAL , 1.40
	CASE IS <= 3000
		TIMES LOCAL , 1.50
	CASE IS <= 5000
		TIMES LOCAL , 1.70
	CASEELSE
		LOCAL = LOCAL * (CFLAG:ARG:好感度 / 100 + 120) / 100
ENDSELECT

CUP:ARG:好意 += LOCAL
CUP:PLAYER:欲情 += MIN(LOCAL / 10 , 100)

;FileName_SOURCE1.ERB ------------------------------ Rev1.00
;征服のソース処理
;CALL		USER
;ARG		キャラNO
;RETURN		VOID
;COMMENT	
;-----------------------------------------------------------
@SOURCE_征服(ARG)
VARSET LOCAL
LOCAL = SOURCE:ARG:征服
LOCAL:1 = SOURCE:ARG:征服 / 4
LOCAL:2 = SOURCE:ARG:征服 / 2
;主導権基準値で分岐
T = ARG
CALL GET_INITIATIVE_RATE
IF R > 0
	LOCAL:1 = SOURCE:ARG:征服 / 4
	;ABL:欲望をみる
	SELECTCASE ABL:ARG:欲望
		CASE 0
			TIMES LOCAL:1 , 0.10
		CASE 1
			TIMES LOCAL:1 , 0.15
		CASE 2
			TIMES LOCAL:1 , 0.20
		CASE 3
			TIMES LOCAL:1 , 0.25
		CASE 4
			TIMES LOCAL:1 , 0.30
		CASEELSE
			LOCAL:1 = LOCAL:1 * (ABL:ARG:欲望 * 5 + 15) / 100
	ENDSELECT
	;ABL:サドっ気をみる
	SIF ABL:ARG:サドっ気 > 0
		LOCAL:1 = LOCAL:1 * (ABL:ARG:サドっ気 * 30 + 100) / 100
ELSE
	;弱気なキャラ
	LOCAL:2 = SOURCE:ARG:征服 / 2
	;ABL:親密をみる
	SELECTCASE ABL:ARG:親密
		CASE 0
			TIMES LOCAL:2 , 0.10
		CASE 1
			TIMES LOCAL:2 , 0.15
		CASE 2
			TIMES LOCAL:2 , 0.20
		CASE 3
			TIMES LOCAL:2 , 0.25
		CASE 4
			TIMES LOCAL:2 , 0.30
		CASEELSE
			LOCAL:2 = LOCAL:2 * (ABL:ARG:親密 * 5 + 15) / 100
	ENDSELECT
ENDIF

;ABL:サドっ気をみる
SELECTCASE ABL:ARG:サドっ気
	CASE 0
		TIMES LOCAL , 0.70
	CASE 1
		TIMES LOCAL , 1.00
	CASE 2
		TIMES LOCAL , 1.30
	CASE 3
		TIMES LOCAL , 1.70
	CASE 4
		TIMES LOCAL , 2.00
	CASEELSE
		LOCAL = LOCAL * (ABL:ARG:サドっ気 * 15 + 175) / 100
ENDSELECT

CUP:ARG:優越 += LOCAL
CUP:ARG:欲情 += LOCAL:1
CUP:ARG:恥情 += LOCAL:2
CUP:PLAYER:屈服 += LOCAL:1

;FileName_SOURCE1.ERB ------------------------------ Rev1.00
;受動のソース処理
;CALL		USER
;ARG		キャラNO
;RETURN		VOID
;COMMENT	
;-----------------------------------------------------------
@SOURCE_受動(ARG)
VARSET LOCAL
LOCAL = SOURCE:ARG:受動
LOCAL:1 = SOURCE:ARG:受動 / 3
LOCAL:2 = SOURCE:ARG:受動 / 2
;主導権基準値で分岐
T = ARG
CALL GET_INITIATIVE_RATE
IF R > 0
	;ABL:欲望をみる
	SELECTCASE ABL:ARG:欲望
		CASE 0
			TIMES LOCAL:1 , 0.30
		CASE 1
			TIMES LOCAL:1 , 0.35
		CASE 2
			TIMES LOCAL:1 , 0.40
		CASE 3
			TIMES LOCAL:1 , 0.45
		CASE 4
			TIMES LOCAL:1 , 0.50
		CASEELSE
			LOCAL:1 = LOCAL:1 * (ABL:ARG:欲望 * 10 + 10) / 100
	ENDSELECT
ELSE
	;弱気なキャラ
	;ABL:奉仕精神をみる
	SELECTCASE ABL:ARG:奉仕精神
		CASE 0
			TIMES LOCAL:2 , 0.30
		CASE 1
			TIMES LOCAL:2 , 0.35
		CASE 2
			TIMES LOCAL:2 , 0.40
		CASE 3
			TIMES LOCAL:2 , 0.45
		CASE 4
			TIMES LOCAL:2 , 0.50
		CASEELSE
			LOCAL:2 = LOCAL:2 * (ABL:ARG:奉仕精神 * 10 + 10) / 100
	ENDSELECT
ENDIF

;ABL:親密をみる
LOCAL = LOCAL * (ABL:ARG:親密 * 10 + 70) / 100

CUP:ARG:好意 += LOCAL
CUP:ARG:屈服 += LOCAL:1
CUP:ARG:恭順 += LOCAL:2
CUP:PLAYER:恭順 += LOCAL:1

;FileName_SOURCE1.ERB ------------------------------ Rev1.00
;接触のソース処理
;CALL		USER
;ARG		キャラNO
;RETURN		VOID
;COMMENT	
;-----------------------------------------------------------
@SOURCE_接触(ARG)
VARSET LOCAL
;恥じらいと恥薄いはここで処理
SIF TALENT:ARG:恥薄い
	TIMES SOURCE:ARG:接触 , 2.00
SIF TALENT:ARG:恥じらい
	TIMES SOURCE:ARG:接触 , 0.50

LOCAL = SOURCE:ARG:接触
LOCAL:1 = SOURCE:ARG:接触
;●友情パッチ用改変(男同士で接触のソースってのもどうかと思ったので)
;恋慕
SIF TALENT:ARG:恋慕 && !IS_友情(ARG)
	TIMES LOCAL , 1.50

;親愛
SIF TALENT:ARG:親愛  && !IS_友情(ARG)
	TIMES LOCAL , 2.00

;恋人
SIF TALENT:ARG:恋人 && !IS_友情(ARG)
	TIMES LOCAL , 1.50

;キス魔
;ボールギャグ装着中・縄拘束中・触手召喚中は無効
SIF TALENT:ARG:キス魔 && !TEQUIP:ARG:縄 && !TEQUIP:ARG:ボールギャグ && !TEQUIP:ARG:触手プレイ && !IS_友情(ARG)
	TIMES LOCAL , 1.20
;●ここまで
;天気：雪
SIF TIME:5 == 5 || TIME:5 == 6
	TIMES LOCAL:1 , 0.70
SIF TIME:5 == 8
	TIMES LOCAL:1 , 0.20

;ABL:従順をみる
SELECTCASE ABL:ARG:親密
	CASE 0
		TIMES LOCAL , 0.01
		TIMES LOCAL:1 , 1.50
	CASE 1
		TIMES LOCAL , 0.05
		TIMES LOCAL:1 , 1.20
	CASE 2
		TIMES LOCAL , 0.10
		TIMES LOCAL:1 , 1.00
	CASE 3
		TIMES LOCAL , 0.50
		TIMES LOCAL:1 , 0.70
	CASE 4
		TIMES LOCAL , 0.80
		TIMES LOCAL:1 , 0.55
	CASE 5
		TIMES LOCAL , 1.00
		TIMES LOCAL:1 , 0.40
	CASE 6
		TIMES LOCAL , 1.10
		TIMES LOCAL:1 , 0.30
	CASE 7
		TIMES LOCAL , 1.20
		TIMES LOCAL:1 , 0.20
	CASE 8
		TIMES LOCAL , 1.30
		TIMES LOCAL:1 , 0.10
	CASE 9
		TIMES LOCAL , 1.40
		TIMES LOCAL:1 , 0.05
	CASEELSE
		LOCAL = LOCAL * (ABL:ARG:親密 * 5 + 100) / 100
		TIMES LOCAL:1 , 0.00
ENDSELECT

;好感度を見る
SELECTCASE CFLAG:ARG:好感度
	CASE IS <= 10
		TIMES LOCAL , 0.01
		TIMES LOCAL:1 , 5.00
	CASE IS <= 50
		TIMES LOCAL , 0.05
		TIMES LOCAL:1 , 2.50
	CASE IS <= 100
		TIMES LOCAL , 0.10
		TIMES LOCAL:1 , 1.50
	CASE IS <= 300
		TIMES LOCAL , 0.20
		TIMES LOCAL:1 , 1.00
	CASE IS <= 500
		TIMES LOCAL , 0.50
		TIMES LOCAL:1 , 0.70
	CASE IS <= 700
		TIMES LOCAL , 1.00
		TIMES LOCAL:1 , 0.40
	CASE IS <= 1000
		TIMES LOCAL , 1.10
		TIMES LOCAL:1 , 0.30
	CASE IS <= 3000
		TIMES LOCAL , 1.30
		TIMES LOCAL:1 , 0.20
	CASE IS <= 5000
		TIMES LOCAL , 1.40
		TIMES LOCAL:1 , 0.10
	CASEELSE
		LOCAL = LOCAL * (CFLAG:ARG:好感度 / 100 + 90) / 100
		LOCAL:1 *= 0
ENDSELECT


CUP:ARG:恭順 += LOCAL
CUP:ARG:反感 += LOCAL:1

;FileName_SOURCE1.ERB ------------------------------ Rev1.00
;家務のソース処理
;CALL		USER
;ARG		キャラNO
;RETURN		VOID
;COMMENT	
;-----------------------------------------------------------
@SOURCE_家務(ARG)
VARSET LOCAL
LOCAL = SOURCE:ARG:家務
LOCAL:1 = SOURCE:ARG:家務

SIF TALENT:ARG:料理得意
	TIMES LOCAL:1 , 1.50
SIF TALENT:ARG:料理苦手
	TIMES LOCAL:1 , 0.50
SIF TALENT:ARG:調理名人
	TIMES LOCAL:1 , 2.00

;ABL:奉仕精神をみる
SELECTCASE ABL:ARG:奉仕精神
	CASE 0
		TIMES LOCAL , 0.30
		TIMES LOCAL:1 , 0.80
	CASE 1
		TIMES LOCAL , 0.50
		TIMES LOCAL:1 , 0.90
	CASE 2
		TIMES LOCAL , 0.70
		TIMES LOCAL:1 , 1.00
	CASE 3
		TIMES LOCAL , 0.80
		TIMES LOCAL:1 , 1.10
	CASE 4
		TIMES LOCAL , 0.90
		TIMES LOCAL:1 , 1.20
	CASEELSE
		LOCAL= LOCAL * (ABL:ARG:奉仕精神 * 10 + 50) / 100
		LOCAL:1 = LOCAL:1 * (ABL:ARG:奉仕精神 * 5 + 100) / 100
ENDSELECT

;ABL:技巧を見る
LOCAL:1 = LOCAL:1 * (ABL:ARG:技巧 * 10 + 80) / 100

CUP:ARG:習得 += LOCAL
CUP:ARG:生活 += LOCAL:1

RETURN 0

;FileName_SOURCE1.ERB ------------------------------ Rev1.00
;歌唱のソース処理
;CALL		USER
;ARG		キャラNO
;RETURN		VOID
;COMMENT	
;-----------------------------------------------------------
@SOURCE_歌唱(ARG)
VARSET LOCAL
LOCAL = SOURCE:ARG:歌唱
LOCAL:1 = SOURCE:ARG:歌唱

SIF TALENT:ARG:音感
	TIMES LOCAL:1 , 1.50
SIF TALENT:ARG:音痴
	TIMES LOCAL:1 , 0.50
SIF TALENT:ARG:歌姫
	TIMES LOCAL:1 , 2.00

;ABL:従順をみる
SELECTCASE ABL:ARG:親密
	CASE 0
		TIMES LOCAL , 0.20
		TIMES LOCAL:1 , 0.60
	CASE 1
		TIMES LOCAL , 0.30
		TIMES LOCAL:1 , 0.80
	CASE 2
		TIMES LOCAL , 0.40
		TIMES LOCAL:1 , 1.00
	CASE 3
		TIMES LOCAL , 0.50
		TIMES LOCAL:1 , 1.10
	CASE 4
		TIMES LOCAL , 0.60
		TIMES LOCAL:1 , 1.20
	CASE 5
		TIMES LOCAL , 0.70
		TIMES LOCAL:1 , 1.30
	CASE 6
		TIMES LOCAL , 0.90
		TIMES LOCAL:1 , 1.40
	CASE 7
		TIMES LOCAL , 1.20
		TIMES LOCAL:1 , 1.50
	CASE 8
		TIMES LOCAL , 1.40
		TIMES LOCAL:1 , 1.60
	CASE 9
		TIMES LOCAL , 1.60
		TIMES LOCAL:1 , 1.80
	CASEELSE
		LOCAL = LOCAL * (ABL:ARG:親密 * 10 + 80) / 100
		LOCAL = LOCAL * (ABL:ARG:親密 * 10 + 100) / 100
ENDSELECT

;ABL:技巧をみる
SELECTCASE ABL:ARG:技巧
	CASE 0
		TIMES LOCAL , 0.40
		TIMES LOCAL:1 , 0.80
	CASE 1
		TIMES LOCAL , 0.50
		TIMES LOCAL:1 , 1.00
	CASE 2
		TIMES LOCAL , 0.60
		TIMES LOCAL:1 , 1.20
	CASE 3
		TIMES LOCAL , 0.70
		TIMES LOCAL:1 , 1.40
	CASE 4
		TIMES LOCAL , 0.90
		TIMES LOCAL:1 , 1.60
	CASE 5
		TIMES LOCAL , 1.10
		TIMES LOCAL:1 , 1.80
	CASE 6
		TIMES LOCAL , 1.20
		TIMES LOCAL:1 , 2.00
	CASE 7
		TIMES LOCAL , 1.40
		TIMES LOCAL:1 , 2.20
	CASE 8
		TIMES LOCAL , 1.60
		TIMES LOCAL:1 , 2.40
	CASE 9
		TIMES LOCAL , 1.80
		TIMES LOCAL:1 , 2.60
	CASEELSE
		LOCAL = LOCAL * (ABL:ARG:技巧 * 20) / 100
		LOCAL:1 = LOCAL:1 * (ABL:ARG:技巧 * 20 + 80) / 100
ENDSELECT

CUP:ARG:習得 += LOCAL
CUP:ARG:歌唱 += LOCAL:1
RETURN 0

;FileName_SOURCE1.ERB ------------------------------ Rev1.00
;被写のソース処理
;CALL		USER
;ARG		キャラNO
;RETURN		VOID
;COMMENT	
;-----------------------------------------------------------
@SOURCE_被写(ARG)
VARSET LOCAL
LOCAL = SOURCE:ARG:被写
LOCAL:1 = SOURCE:ARG:被写

SIF TALENT:ARG:ビューティフル
	TIMES LOCAL:1 , 1.50
SIF TALENT:ARG:地味
	TIMES LOCAL:1 , 0.50
SIF TALENT:ARG:美姫
	TIMES LOCAL:1 , 2.00

;ABL:従順をみる
SELECTCASE ABL:ARG:親密
	CASE 0
		TIMES LOCAL , 0.20
		TIMES LOCAL:1 , 0.60
	CASE 1
		TIMES LOCAL , 0.30
		TIMES LOCAL:1 , 0.80
	CASE 2
		TIMES LOCAL , 0.40
		TIMES LOCAL:1 , 1.00
	CASE 3
		TIMES LOCAL , 0.50
		TIMES LOCAL:1 , 1.10
	CASE 4
		TIMES LOCAL , 0.60
		TIMES LOCAL:1 , 1.20
	CASE 5
		TIMES LOCAL , 0.70
		TIMES LOCAL:1 , 1.30
	CASE 6
		TIMES LOCAL , 0.90
		TIMES LOCAL:1 , 1.40
	CASE 7
		TIMES LOCAL , 1.20
		TIMES LOCAL:1 , 1.50
	CASE 8
		TIMES LOCAL , 1.40
		TIMES LOCAL:1 , 1.60
	CASE 9
		TIMES LOCAL , 1.60
		TIMES LOCAL:1 , 1.80
	CASEELSE
		LOCAL = LOCAL * (ABL:ARG:親密 * 10 + 80) / 100
		LOCAL = LOCAL * (ABL:ARG:親密 * 10 + 100) / 100
ENDSELECT

;ABL:技巧をみる
SELECTCASE ABL:ARG:技巧
	CASE 0
		TIMES LOCAL , 0.40
		TIMES LOCAL:1 , 0.80
	CASE 1
		TIMES LOCAL , 0.50
		TIMES LOCAL:1 , 1.00
	CASE 2
		TIMES LOCAL , 0.60
		TIMES LOCAL:1 , 1.20
	CASE 3
		TIMES LOCAL , 0.70
		TIMES LOCAL:1 , 1.40
	CASE 4
		TIMES LOCAL , 0.90
		TIMES LOCAL:1 , 1.60
	CASE 5
		TIMES LOCAL , 1.10
		TIMES LOCAL:1 , 1.80
	CASE 6
		TIMES LOCAL , 1.20
		TIMES LOCAL:1 , 2.00
	CASE 7
		TIMES LOCAL , 1.40
		TIMES LOCAL:1 , 2.20
	CASE 8
		TIMES LOCAL , 1.60
		TIMES LOCAL:1 , 2.40
	CASE 9
		TIMES LOCAL , 1.80
		TIMES LOCAL:1 , 2.60
	CASEELSE
		LOCAL = LOCAL * (ABL:ARG:技巧 * 20) / 100
		LOCAL:1 = LOCAL:1 * (ABL:ARG:技巧 * 20 + 80) / 100
ENDSELECT

CUP:ARG:習得 += LOCAL
CUP:ARG:被写 += LOCAL:1

RETURN 0

;FileName_SOURCE1.ERB ------------------------------ Rev1.00
;舞踊のソース処理
;CALL		USER
;ARG		キャラNO
;RETURN		VOID
;COMMENT	
;-----------------------------------------------------------
@SOURCE_舞踊(ARG)
VARSET LOCAL
LOCAL = SOURCE:ARG:舞踊
LOCAL:1 = SOURCE:ARG:舞踊

SIF TALENT:ARG:舞踊の才
	TIMES LOCAL:1 , 1.50
SIF TALENT:ARG:大ドジ
	TIMES LOCAL:1 , 0.50
SIF TALENT:ARG:舞姫
	TIMES LOCAL:1 , 2.00

;ABL:従順をみる
SELECTCASE ABL:ARG:親密
	CASE 0
		TIMES LOCAL , 0.20
		TIMES LOCAL:1 , 0.60
	CASE 1
		TIMES LOCAL , 0.30
		TIMES LOCAL:1 , 0.80
	CASE 2
		TIMES LOCAL , 0.40
		TIMES LOCAL:1 , 1.00
	CASE 3
		TIMES LOCAL , 0.50
		TIMES LOCAL:1 , 1.10
	CASE 4
		TIMES LOCAL , 0.60
		TIMES LOCAL:1 , 1.20
	CASE 5
		TIMES LOCAL , 0.70
		TIMES LOCAL:1 , 1.30
	CASE 6
		TIMES LOCAL , 0.90
		TIMES LOCAL:1 , 1.40
	CASE 7
		TIMES LOCAL , 1.20
		TIMES LOCAL:1 , 1.50
	CASE 8
		TIMES LOCAL , 1.40
		TIMES LOCAL:1 , 1.60
	CASE 9
		TIMES LOCAL , 1.60
		TIMES LOCAL:1 , 1.80
	CASEELSE
		LOCAL = LOCAL * (ABL:ARG:親密 * 10 + 80) / 100
		LOCAL = LOCAL * (ABL:ARG:親密 * 10 + 100) / 100
ENDSELECT

;ABL:技巧をみる
SELECTCASE ABL:ARG:技巧
	CASE 0
		TIMES LOCAL , 0.40
		TIMES LOCAL:1 , 0.80
	CASE 1
		TIMES LOCAL , 0.50
		TIMES LOCAL:1 , 1.00
	CASE 2
		TIMES LOCAL , 0.60
		TIMES LOCAL:1 , 1.20
	CASE 3
		TIMES LOCAL , 0.70
		TIMES LOCAL:1 , 1.40
	CASE 4
		TIMES LOCAL , 0.90
		TIMES LOCAL:1 , 1.60
	CASE 5
		TIMES LOCAL , 1.10
		TIMES LOCAL:1 , 1.80
	CASE 6
		TIMES LOCAL , 1.20
		TIMES LOCAL:1 , 2.00
	CASE 7
		TIMES LOCAL , 1.40
		TIMES LOCAL:1 , 2.20
	CASE 8
		TIMES LOCAL , 1.60
		TIMES LOCAL:1 , 2.40
	CASE 9
		TIMES LOCAL , 1.80
		TIMES LOCAL:1 , 2.60
	CASEELSE
		LOCAL = LOCAL * (ABL:ARG:技巧 * 20) / 100
		LOCAL:1 = LOCAL:1 * (ABL:ARG:技巧 * 20 + 80) / 100
ENDSELECT

CUP:ARG:習得 += LOCAL
CUP:ARG:舞踊 += LOCAL:1


RETURN 0

;---------------------------------------------------
;マイナスSOURCE
;---------------------------------------------------
;FileName_SOURCE1.ERB ------------------------------ Rev1.00
;懐疑のソース処理
;CALL		USER
;ARG		キャラNO
;RETURN		VOID
;COMMENT	
;-----------------------------------------------------------
@SOURCE_懐疑(ARG)
VARSET LOCAL
LOCAL = SOURCE:ARG:懐疑
LOCAL:1 = SOURCE:ARG:懐疑

;欲望
SELECTCASE ABL:ARG:親密
	CASE 0
		TIMES LOCAL:1 , 0.80
	CASE 1
		TIMES LOCAL:1 , 0.70
	CASE 2
		TIMES LOCAL:1 , 0.55
	CASE 3
		TIMES LOCAL:1 , 0.45
	CASE 4
		TIMES LOCAL:1 , 0.35
	CASE 5
		TIMES LOCAL:1 , 0.30
	CASE 6
		TIMES LOCAL:1 , 0.25
	CASE 7
		TIMES LOCAL:1 , 0.20
	CASE 8
		TIMES LOCAL:1 , 0.15
	CASE 9
		TIMES LOCAL:1 , 0.10
	CASEELSE
		LOCAL:1 = LOCAL:1 *  (100 - GET_REVISION(ABL:ARG:露出癖, 100, 50)) / 1000
ENDSELECT

;好感度を見る
SELECTCASE CFLAG:ARG:好感度
	CASE IS <= 10
		TIMES LOCAL , 1.50
		TIMES LOCAL:1 , 2.50
	CASE IS <= 50
		TIMES LOCAL , 1.00
		TIMES LOCAL:1 , 1.50
	CASE IS <= 100
		TIMES LOCAL , 0.60
		TIMES LOCAL:1 , 1.00
	CASE IS <= 300
		TIMES LOCAL , 0.50
		TIMES LOCAL:1 , 0.60
	CASE IS <= 500
		TIMES LOCAL , 0.50
		TIMES LOCAL:1 , 0.40
	CASE IS <= 700
		TIMES LOCAL , 0.50
		TIMES LOCAL:1 , 0.30
	CASE IS <= 1000
		TIMES LOCAL , 0.50
		TIMES LOCAL:1 , 0.20
	CASE IS <= 3000
		TIMES LOCAL , 0.40
		TIMES LOCAL:1 , 0.10
	CASE IS <= 5000
		TIMES LOCAL , 0.40
		TIMES LOCAL:1 , 0.05
	CASEELSE
		LOCAL:0 = LOCAL:1 *  (300 - GET_REVISION(CFLAG:ARG:好感度, 300, 10000)) / 1000
		LOCAL:1 = LOCAL:1 *  (500 - GET_REVISION(CFLAG:ARG:好感度, 50, 10000)) / 1000
ENDSELECT


CUP:ARG:不快 += LOCAL
CUP:ARG:恐怖 += LOCAL:1

RETURN 0

;FileName_SOURCE1.ERB ------------------------------ Rev1.00
;不安のソース処理
;CALL		USER
;ARG		キャラNO
;RETURN		VOID
;COMMENT	
;-----------------------------------------------------------
@SOURCE_不安(ARG)
;ここで手に入る恐怖は、お化け屋敷で女の子がくっついてきて「怖かったよー」とか言うイメージなので
;弱気だったり好感度が高かったりすると多く手に入るという事で
VARSET LOCAL
;天気:大雨
SIF TIME:5 == 4
	SOURCE:ARG:不安 *= 2
	
LOCAL = SOURCE:ARG:不安
LOCAL:1 = SOURCE:ARG:不安 / 5

;臆病(重複前提)
IF TALENT:ARG:臆病
	TIMES LOCAL , 1.50
	TIMES LOCAL:1 , 2.00
ENDIF

;大人しい
SIF TALENT:ARG:大人しい
	TIMES LOCAL , 1.20

;無関心・感情乏しい
SIF TALENT:ARG:無関心 || TALENT:ARG:感情乏しい
	TIMES LOCAL , 0.70

;親密
SELECTCASE ABL:ARG:親密
	CASE 0
		TIMES LOCAL:1 , 0.80
	CASE 1
		TIMES LOCAL:1 , 0.70
	CASE 2
		TIMES LOCAL:1 , 0.55
	CASE 3
		TIMES LOCAL:1 , 0.45
	CASE 4
		TIMES LOCAL:1 , 0.35
	CASE 5
		TIMES LOCAL:1 , 0.30
	CASE 6
		TIMES LOCAL:1 , 0.25
	CASE 7
		TIMES LOCAL:1 , 0.20
	CASE 8
		TIMES LOCAL:1 , 0.15
	CASE 9
		TIMES LOCAL:1 , 0.10
	CASEELSE
		TIMES LOCAL:1 , 0.01
ENDSELECT

;好感度を見る
SELECTCASE CFLAG:ARG:好感度
	CASE IS <= 10
		TIMES LOCAL , 0.50
		TIMES LOCAL:1 , 2.50
	CASE IS <= 50
		TIMES LOCAL , 0.70
		TIMES LOCAL:1 , 1.50
	CASE IS <= 100
		TIMES LOCAL , 0.90
		TIMES LOCAL:1 , 1.00
	CASE IS <= 300
		TIMES LOCAL , 1.00
		TIMES LOCAL:1 , 0.60
	CASE IS <= 500
		TIMES LOCAL , 1.20
		TIMES LOCAL:1 , 0.40
	CASE IS <= 700
		TIMES LOCAL , 1.50
		TIMES LOCAL:1 , 0.30
	CASE IS <= 1000
		TIMES LOCAL , 1.70
		TIMES LOCAL:1 , 0.20
	CASE IS <= 3000
		TIMES LOCAL , 2.00
		TIMES LOCAL:1 , 0.10
	CASE IS <= 5000
		TIMES LOCAL , 2.25
		TIMES LOCAL:1 , 0.05
	CASEELSE
		LOCAL = LOCAL * (20 + CFLAG:ARG:好感度 / 1000) / 10
		LOCAL:1 = LOCAL:1 *  (50 - GET_REVISION(CFLAG:ARG:好感度, 50, 10000)) / 1000
ENDSELECT

CUP:ARG:恐怖 += LOCAL
CUP:ARG:反感 += LOCAL:1

RETURN 0

;FileName_SOURCE1.ERB ------------------------------ Rev1.00
;不潔のソース処理
;CALL		USER
;ARG		キャラNO
;RETURN		VOID
;COMMENT	
;-----------------------------------------------------------
@SOURCE_不潔(ARG)
VARSET LOCAL
LOCAL = SOURCE:ARG:不潔

;ABL:従順をみる
SELECTCASE ABL:ARG:親密
	CASE 0
		TIMES LOCAL , 0.60
		TIMES LOCAL:1 , 1.00
	CASE 1
		TIMES LOCAL , 0.55
		TIMES LOCAL:1 , 0.50
	CASE 2
		TIMES LOCAL , 0.50
		TIMES LOCAL:1 , 0.80
	CASE 3
		TIMES LOCAL , 0.45
		TIMES LOCAL:1 , 0.70
	CASE 4
		TIMES LOCAL , 0.40
		TIMES LOCAL:1 , 0.60
	CASE 5
		TIMES LOCAL , 0.35
		TIMES LOCAL:1 , 0.50
	CASE 6
		TIMES LOCAL , 0.30
		TIMES LOCAL:1 , 0.40
	CASE 7
		TIMES LOCAL , 0.25
		TIMES LOCAL:1 , 0.30
	CASE 8
		TIMES LOCAL , 0.20
		TIMES LOCAL:1 , 0.20
	CASE 9
		TIMES LOCAL , 0.15
		TIMES LOCAL:1 , 0.10
	CASEELSE
		LOCAL = LOCAL *  (150 - GET_REVISION(ABL:ARG:親密, 150, 50)) / 1000
		LOCAL:1 = LOCAL:1 *  (100 - GET_REVISION(ABL:ARG:親密, 100, 50)) / 1000
ENDSELECT

CUP:ARG:反感 += LOCAL
CUP:ARG:不快 += LOCAL:1

RETURN 0

;FileName_SOURCE1.ERB ------------------------------ Rev1.00
;逸脱のソース処理
;CALL		USER
;ARG		キャラNO
;RETURN		VOID
;COMMENT	
;-----------------------------------------------------------
@SOURCE_逸脱(ARG)
VARSET LOCAL
;好奇心と保守的はここで処理
SIF TALENT:ARG:好奇心
	TIMES SOURCE:ARG:逸脱 , 0.80
SIF TALENT:ARG:保守的
	TIMES SOURCE:ARG:逸脱 , 2.00

LOCAL = SOURCE:ARG:逸脱

;ABL:従順をみる
SELECTCASE ABL:ARG:親密
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 0.80
	CASE 2
		TIMES LOCAL , 0.60
	CASE 3
		TIMES LOCAL , 0.40
	CASE 4
		TIMES LOCAL , 0.30
	CASE 5
		TIMES LOCAL , 0.20
	CASE 6
		TIMES LOCAL , 0.10
	CASE 7
		TIMES LOCAL , 0.08
	CASE 8
		TIMES LOCAL , 0.06
	CASE 9
		TIMES LOCAL , 0.04
	CASEELSE
		LOCAL = LOCAL *  (5 - GET_REVISION(ABL:ARG:親密, 5, 50)) / 1000
ENDSELECT

;ABL:マゾっ気をみる
SELECTCASE ABL:ARG:マゾっ気
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 0.90
	CASE 2
		TIMES LOCAL , 0.80
	CASE 3
		TIMES LOCAL , 0.70
	CASE 4
		TIMES LOCAL , 0.60
	CASE 5
		TIMES LOCAL , 0.50
	CASE 6
		TIMES LOCAL , 0.40
	CASE 7
		TIMES LOCAL , 0.30
	CASE 8
		TIMES LOCAL , 0.20
	CASE 9
		TIMES LOCAL , 0.10
	CASEELSE
		LOCAL = LOCAL *  (100 - GET_REVISION(ABL:ARG:マゾっ気, 100, 50)) / 1000
ENDSELECT

;マゾ
SIF TALENT:ARG:マゾ
	TIMES LOCAL , 0.50

CUP:ARG:反感 += LOCAL

;FileName_SOURCE1.ERB ------------------------------ Rev1.00
;反感のソース処理
;CALL		USER
;ARG		キャラNO
;RETURN		VOID
;COMMENT	
;-----------------------------------------------------------
@SOURCE_反感(ARG)
VARSET LOCAL
LOCAL = SOURCE:ARG:反感

;ABL:ARG:従順
SELECTCASE ABL:ARG:親密
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 0.80
	CASE 2
		TIMES LOCAL , 0.60
	CASE 3
		TIMES LOCAL , 0.40
	CASE 4
		TIMES LOCAL , 0.30
	CASE 5
		TIMES LOCAL , 0.20
	CASE 6
		TIMES LOCAL , 0.10
	CASE 7
		TIMES LOCAL , 0.08
	CASE 8
		TIMES LOCAL , 0.06
	CASE 9
		TIMES LOCAL , 0.04
	CASEELSE
		LOCAL = LOCAL *  (4 - GET_REVISION(ABL:ARG:親密, 4, 50)) / 1000
ENDSELECT

;ABL:奉仕精神をみる
SELECTCASE ABL:ARG:奉仕精神
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 0.90
	CASE 2
		TIMES LOCAL , 0.80
	CASE 3
		TIMES LOCAL , 0.70
	CASE 4
		TIMES LOCAL , 0.60
	CASE 5
		TIMES LOCAL , 0.50
	CASE 6
		TIMES LOCAL , 0.40
	CASE 7
		TIMES LOCAL , 0.30
	CASE 8
		TIMES LOCAL , 0.20
	CASE 9
		TIMES LOCAL , 0.10
	CASEELSE
		LOCAL = LOCAL *  (100 - GET_REVISION(ABL:ARG:奉仕精神, 100, 50)) / 1000
ENDSELECT

;ABL:マゾっ気をみる
SELECTCASE ABL:ARG:マゾっ気
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 0.90
	CASE 2
		TIMES LOCAL , 0.80
	CASE 3
		TIMES LOCAL , 0.70
	CASE 4
		TIMES LOCAL , 0.60
	CASE 5
		TIMES LOCAL , 0.50
	CASE 6
		TIMES LOCAL , 0.40
	CASE 7
		TIMES LOCAL , 0.30
	CASE 8
		TIMES LOCAL , 0.20
	CASE 9
		TIMES LOCAL , 0.10
	CASEELSE
		LOCAL = LOCAL *  (100 - GET_REVISION(ABL:ARG:マゾっ気, 100, 50)) / 1000
ENDSELECT
CUP:ARG:反感 += LOCAL


;FileName_SOURCE1.ERB ------------------------------ Rev1.01
;素質等に寄るソース変動処理
;CALL		USER
;ARG		キャラNO
;RETURN		VOID
;COMMENT	
;-----------------------------------------------------------
@SOURCE_EXTRA(ARG)
VARSET LOCAL
;-------------------------------------------------
;装備系（薬等）
;-------------------------------------------------
;媚薬
IF TEQUIP:ARG:媚薬
	TIMES CUP:ARG:恭順 , 1.20
	TIMES CUP:ARG:欲情 , 2.00
	TIMES CUP:ARG:屈服 , 1.20
	TIMES CUP:ARG:反感 , 0.75
	TIMES CUP:ARG:不快 , 0.75
ENDIF

;利尿剤
IF TEQUIP:ARG:利尿剤
	TIMES CUP:ARG:恭順 , 0.80
	TIMES CUP:ARG:欲情 , 0.80
	TIMES CUP:ARG:恥情 , 1.20
	TIMES CUP:ARG:反感 , 1.50
	TIMES CUP:ARG:不快 , 1.20
ENDIF

;-------------------------------------------------
;経験
;-------------------------------------------------
;異常経験(＝淫乱度合とみなす)による、抑鬱の軽減
IF EXP:ARG:異常経験 <= 0
	TIMES CUP:ARG:抑鬱 , 1.30
ELSEIF EXP:ARG:異常経験 < 10
	TIMES CUP:ARG:抑鬱 , 1.10
ELSEIF EXP:ARG:異常経験 < 50
	TIMES CUP:ARG:抑鬱 , 0.90
ELSEIF EXP:ARG:異常経験 < 100
	TIMES CUP:ARG:抑鬱 , 0.70
ELSEIF EXP:ARG:異常経験 < 200
	TIMES CUP:ARG:抑鬱 , 0.40
ELSEIF EXP:ARG:異常経験 < 400
	TIMES CUP:ARG:抑鬱 , 0.10
ELSEIF EXP:ARG:異常経験 < 700
	TIMES CUP:ARG:抑鬱 , 0.01
ELSEIF EXP:ARG:異常経験 < 1500
	TIMES CUP:ARG:抑鬱 , 0.001
ELSE
	TIMES CUP:ARG:抑鬱 , 0.0001
ENDIF

;-------------------------------------------------
;陥落素質
;-------------------------------------------------
;恋慕
IF TALENT:ARG:恋慕 && ASSIPLAY == 0
	CUP:ARG:恭順 = CUP:ARG:恭順 * (10 + 5 * TALENT:ARG:恋慕) / 10
	CUP:ARG:屈服 = CUP:ARG:屈服 * (10 + 5 * TALENT:ARG:恋慕) / 10
	SIF CUP:ARG:好意 < 999999999
		CUP:ARG:好意 = CUP:ARG:好意 * (10 + 2 * TALENT:ARG:恋慕) / 10
	CUP:ARG:反感 = CUP:ARG:反感 * (10 - 4 * TALENT:ARG:恋慕) / 10
	CUP:ARG:不快 = CUP:ARG:不快 * (10 - 4 * TALENT:ARG:恋慕) / 10
	TIMES CUP:ARG:抑鬱 , 0.50
	TIMES CUP:ARG:生活 , 1.50
ELSEIF TALENT:ARG:恋慕 && ASSIPLAY > 0
	TIMES CUP:ARG:恭順 , 0.80
	TIMES CUP:ARG:反感 , 1.20
	TIMES CUP:ARG:不快 , 1.20
ENDIF

;親愛
IF TALENT:ARG:親愛 && ASSIPLAY == 0
	SIF CUP:ARG:恭順 < 999999999
		TIMES CUP:ARG:恭順 , 2.00
	TIMES CUP:ARG:屈服 , 3.00
	TIMES CUP:ARG:反感 , 0.20
	TIMES CUP:ARG:不快 , 0.20
	TIMES CUP:ARG:抑鬱 , 0.20
	SIF CUP:ARG:好意 < 999999999
		TIMES CUP:ARG:好意 , 2.00
	TIMES CUP:ARG:生活 , 2.50
ENDIF

;恋人
IF TALENT:ARG:恋人 && ASSIPLAY == 0
	TIMES CUP:ARG:屈服 , 1.50
	TIMES CUP:ARG:反感 , 0.75
	TIMES CUP:ARG:不快 , 0.75
	SIF CUP:好意 < 999999999
		TIMES CUP:ARG:好意 , 1.30
	TIMES CUP:ARG:生活 , 1.50
ENDIF

;相愛
IF TALENT:ARG:相愛
	TIMES CUP:ARG:反感 , 0.50
	TIMES CUP:ARG:不快 , 0.50
	TIMES CUP:ARG:抑鬱 , 0.50
ENDIF

;成功判定
IF TFLAG:成功判定 == -1
	TIMES CUP:ARG:反感 , 1.30
	TIMES CUP:ARG:不快 , 1.30
	TIMES CUP:ARG:抑鬱 , 1.30
	TIMES CUP:ARG:好意 , 0.80
ELSEIF TFLAG:成功判定 == 1
	TIMES CUP:ARG:反感 , 0.10
	TIMES CUP:ARG:不快 , 0.10
	TIMES CUP:ARG:抑鬱 , 0.10
	SIF CUP:ARG:恭順 < 999999999
		TIMES CUP:ARG:恭順 , 1.50
	TIMES CUP:ARG:欲情 , 3.00
	SIF CUP:ARG:好意 < 999999999
		TIMES CUP:ARG:好意 , 1.50
	TIMES CUP:ARG:生活 , 1.50
	TIMES CUP:ARG:優越 , 1.75
ENDIF

;淫乱
IF TALENT:ARG:淫乱
	CUP:ARG:恭順 = CUP:ARG:恭順 * (10 + 2 * TALENT:ARG:淫乱) / 10
	CUP:ARG:屈服 = CUP:ARG:屈服 * (10 + 2 * TALENT:ARG:淫乱) / 10
	CUP:ARG:反感 = CUP:ARG:反感 * (10 - 2 * TALENT:ARG:淫乱) / 10
	CUP:ARG:不快 = CUP:ARG:不快 * (10 - 2 * TALENT:ARG:淫乱) / 10
	TIMES CUP:ARG:抑鬱 , 0.40
ENDIF
;-------------------------------------------------
;素質
;-------------------------------------------------
;気丈
IF TALENT:ARG:気丈
	TIMES CUP:ARG:恭順 , 0.80
	TIMES CUP:ARG:欲情 , 0.80
	TIMES CUP:ARG:屈服 , 0.80
	TIMES CUP:ARG:恐怖 , 0.80
	TIMES CUP:ARG:好意 , 0.80
	TIMES CUP:ARG:反感 , 1.20
	TIMES CUP:ARG:抑鬱 , 1.20
ENDIF
;臆病
IF TALENT:ARG:臆病
	TIMES CUP:ARG:恐怖 , 1.20
	TIMES CUP:ARG:反感 , 1.20
ENDIF
;反抗的（恋慕、親愛で無効）
IF TALENT:ARG:反抗的 && (TALENT:ARG:恋慕^^TALENT:ARG:親愛)
	TIMES CUP:ARG:恭順 , 0.80
	TIMES CUP:ARG:屈服 , 0.80
	TIMES CUP:ARG:好意 , 0.80
	TIMES CUP:ARG:反感 , 1.20
ENDIF
;素直
IF TALENT:ARG:素直
	TIMES CUP:ARG:恭順 , 1.20
	TIMES CUP:ARG:反感 , 0.80
	SIF CUP:ARG:好意 < 999999999
		TIMES CUP:ARG:好意 , 1.50
ENDIF
;生意気
IF TALENT:ARG:生意気
	TIMES CUP:ARG:恭順 , 0.80
	TIMES CUP:ARG:屈服 , 0.80
	TIMES CUP:ARG:反感 , 1.20
ENDIF
;大人しい
IF TALENT:ARG:大人しい
	TIMES CUP:ARG:恭順 , 0.80
	TIMES CUP:ARG:反感 , 0.80
ENDIF
;プライド高い
IF TALENT:ARG:プライド高い
	TIMES CUP:ARG:屈服 , 0.80
	TIMES CUP:ARG:恐怖 , 0.80
	TIMES CUP:ARG:反感 , 1.20
	TIMES CUP:ARG:優越 , 1.50
ENDIF
;プライド低い
IF TALENT:ARG:プライド低い
	TIMES CUP:ARG:屈服 , 1.20
	TIMES CUP:ARG:恐怖 , 1.20
	TIMES CUP:ARG:反感 , 0.80
	TIMES CUP:ARG:優越 , 0.80
ENDIF
;ツンデレ
IF TALENT:ARG:ツンデレ
	;陥落素質がある場合と無い場合で変化する
	IF TALENT:ARG:恋慕 || TALENT:ARG:淫乱
		TIMES CUP:ARG:恭順 , 1.20
		TIMES CUP:ARG:屈服 , 1.20
		TIMES CUP:ARG:反感 , 0.80
	ELSE
		TIMES CUP:ARG:恭順 , 0.80
		TIMES CUP:ARG:屈服 , 0.80
		TIMES CUP:ARG:反感 , 1.20
	ENDIF
ENDIF

;自制心
IF TALENT:ARG:自制心
	TIMES CUP:ARG:屈服 , 0.80
	TIMES CUP:ARG:恐怖 , 0.80
	TIMES CUP:ARG:反感 , 1.20
ENDIF
;無関心
IF TALENT:ARG:無関心
	TIMES CUP:ARG:恭順 , 0.80
	TIMES CUP:ARG:欲情 , 0.80
	TIMES CUP:ARG:屈服 , 0.80
	TIMES CUP:ARG:好意 , 0.80
	TIMES CUP:ARG:恐怖 , 0.80
	TIMES CUP:ARG:反感 , 0.80
	TIMES CUP:ARG:生活 , 0.80
ENDIF
;感情乏しい
IF TALENT:ARG:感情乏しい
	TIMES CUP:ARG:恭順 , 0.80
	TIMES CUP:ARG:欲情 , 0.80
	TIMES CUP:ARG:屈服 , 0.80
	TIMES CUP:ARG:恥情 , 0.80
	TIMES CUP:ARG:恐怖 , 0.80
	TIMES CUP:ARG:好意 , 0.80
	TIMES CUP:ARG:生活 , 0.80
	TIMES CUP:ARG:反感 , 0.80
	TIMES CUP:ARG:不快 , 0.80
	TIMES CUP:ARG:抑鬱 , 0.80
ENDIF
;好奇心
SIF TALENT:ARG:好奇心
	TIMES CUP:ARG:習得 , 1.20
;保守的
SIF TALENT:ARG:保守的
	TIMES CUP:ARG:習得 , 0.80
;楽観的
SIF TALENT:ARG:楽観的
	TIMES CUP:ARG:抑鬱 , 0.80
;悲観的
SIF TALENT:ARG:悲観的
	TIMES CUP:ARG:抑鬱 , 1.20
;目立ちたがり
SIF TALENT:ARG:目立ちたがり
	TIMES CUP:ARG:恭順 , 1.20

;抑圧
IF TALENT:ARG:抑圧
	TIMES CUP:ARG:欲情 , 0.80
	TIMES CUP:ARG:反感 , 1.20
	TIMES CUP:ARG:抑鬱 , 1.20
ENDIF
;解放
IF TALENT:ARG:解放
	TIMES CUP:ARG:欲情 , 1.20
	TIMES CUP:ARG:屈服 , 1.20
ENDIF
;抵抗
IF TALENT:ARG:抵抗
	TIMES CUP:ARG:恭順 , 0.80
	TIMES CUP:ARG:反感 , 1.20
	TIMES CUP:ARG:抑鬱 , 1.20
ENDIF

;痛覚
;CUP:ARG:苦痛 = CUP:ARG:苦痛 * (10 + 2 * TALENT:ARG:痛みに弱い) / 10

;習得速度
;CUP:ARG:習得 = CUP:ARG:習得 * (10 + 2 * TALENT:ARG:習得早い) / 10

;痛みに弱い
IF TALENT:ARG:痛みに弱い
	TIMES CUP:ARG:恐怖 , 2.00
	TIMES CUP:ARG:反感 , 1.50
ENDIF
;痛みに強い
IF TALENT:ARG:痛みに強い
	TIMES CUP:ARG:恐怖 , 0.50
	TIMES CUP:ARG:反感 , 0.75
ENDIF

;習得早い
IF TALENT:ARG:習得早い
	TIMES CUP:ARG:習得 , 2.00
	TIMES CUP:ARG:生活 , 1.50
ENDIF
;習得遅い
IF TALENT:ARG:習得遅い
	TIMES CUP:ARG:習得 , 0.50
	TIMES CUP:ARG:生活 , 0.50
ENDIF

;献身的
SIF TALENT:ARG:献身的
	TIMES CUP:ARG:屈服 , 1.20

;快感に素直
SIF TALENT:ARG:快感に素直
	TIMES CUP:ARG:欲情 , 1.20
;快感の否定（淫乱、娼婦で無効）
SIF TALENT:ARG:快感の否定 && !TALENT:ARG:淫乱
	TIMES CUP:ARG:欲情 , 0.80
;即落ち
IF TALENT:ARG:即落ち
	TIMES CUP:ARG:恭順 , 2.00
	TIMES CUP:ARG:欲情 , 2.00
	TIMES CUP:ARG:屈服 , 2.00
	TIMES CUP:ARG:習得 , 2.00
	TIMES CUP:ARG:恥情 , 2.00
	TIMES CUP:ARG:恐怖 , 2.00
	TIMES CUP:ARG:反感 , 0.50
	TIMES CUP:ARG:不快 , 0.50
	TIMES CUP:ARG:抑鬱 , 0.50
ENDIF
;陰核
SIF TALENT:ARG:淫核
	TIMES CUP:ARG:欲情 , 1.20
;淫壺
SIF TALENT:ARG:淫壷
	TIMES CUP:ARG:恭順 , 1.20
;尻穴狂い
SIF TALENT:ARG:尻穴狂い
	TIMES CUP:ARG:屈服 , 1.20
;淫乳
SIF TALENT:ARG:淫乳
	TIMES CUP:ARG:恥情 , 1.20

;倒錯的
IF TALENT:ARG:倒錯的
	TIMES CUP:ARG:屈服 , 1.20
	TIMES CUP:ARG:恥情 , 1.20
ENDIF
;男嫌い（女性のみ恋慕、親愛で無効）
IF TALENT:ARG:男嫌い && !TALENT:PLAYER:オトコ && (!TALENT:ARG:恋慕 || PLAYER != MASTER)
	TIMES CUP:ARG:恭順 , 0.80
	TIMES CUP:ARG:欲情 , 0.80
	TIMES CUP:ARG:屈服 , 0.80
	TIMES CUP:ARG:習得 , 0.80
	TIMES CUP:ARG:反感 , 1.20
	TIMES CUP:ARG:不快 , 1.20
ENDIF
;サド
IF TALENT:ARG:サド
	TIMES CUP:ARG:優越 , 2.00
	TIMES CUP:ARG:屈服 , 0.80
	TIMES CUP:ARG:恐怖 , 0.80
ENDIF
;マゾ
IF TALENT:ARG:マゾ
	TIMES CUP:ARG:屈服 , 1.20
	TIMES CUP:ARG:恐怖 , 1.20
	TIMES CUP:ARG:抑鬱 , 0.80
ENDIF
IF TALENT:ARG:小悪魔
	TIMES CUP:ARG:優越 , 1.50
ENDIF
;妄信
IF TALENT:ARG:妄信
	TIMES CUP:ARG:屈服 , 1.20
	TIMES CUP:ARG:反感 , 0.80
ENDIF
;女嫌い（男性のみ恋慕、親愛で無効）
;IF TALENT:ARG:性別嗜好 & 2 && (TALENT:PLAYER:オトコ) && (!TALENT:ARG:恋慕 || PLAYER != MASTER )
;	TIMES CUP:ARG:恭順 , 0.80
;	TIMES CUP:ARG:欲情 , 0.80
;	TIMES CUP:ARG:屈服 , 0.80
;	TIMES CUP:ARG:習得 , 0.80
;	TIMES CUP:ARG:反感 , 1.20
;	TIMES CUP:ARG:不快 , 1.20
;ENDIF


;-------------------------------------------------
;その他
;-------------------------------------------------
;苦痛依存
IF MARK:ARG:苦痛依存 == 3
	TIMES CUP:ARG:苦痛 , 1.30
	TIMES CUP:ARG:恐怖 , 1.30
ELSEIF MARK:ARG:苦痛依存 == 2
	TIMES CUP:ARG:苦痛 , 1.20
	TIMES CUP:ARG:恐怖 , 1.20
ELSEIF MARK:ARG:苦痛依存 == 1
	TIMES CUP:ARG:苦痛 , 1.10
	TIMES CUP:ARG:恐怖 , 1.10
ENDIF

;快楽依存
IF MARK:ARG:快楽依存 == 3
	TIMES CUP:ARG:欲情 , 1.30
	TIMES CUP:ARG:習得 , 1.30
ELSEIF MARK:ARG:快楽依存 == 2
	TIMES CUP:ARG:欲情 , 1.20
	TIMES CUP:ARG:習得 , 1.20
ELSEIF MARK:ARG:快楽依存 == 1
	TIMES CUP:ARG:欲情 , 1.10
	TIMES CUP:ARG:習得 , 1.10
ENDIF

;不埒刻印
;IF MARK:ARG:不埒刻印 == 3
;	TIMES CUP:ARG:恭順 , 1.30
;	TIMES CUP:ARG:屈服 , 1.30
;ELSEIF MARK:ARG:不埒刻印 == 2
;	TIMES CUP:ARG:恭順 , 1.20
;	TIMES CUP:ARG:屈服 , 1.20
;ELSEIF MARK:ARG:不埒刻印 == 1
;	TIMES CUP:ARG:恭順 , 1.10
;	TIMES CUP:ARG:屈服 , 1.10
;ENDIF

;反発感情
IF MARK:ARG:反発感情 == 3
	TIMES CUP:ARG:恭順 , 0.10
	TIMES CUP:ARG:反感 , 1.30
	TIMES CUP:ARG:優越 , 2.00
ELSEIF MARK:ARG:反発感情 == 2
	TIMES CUP:ARG:恭順 , 0.40
	TIMES CUP:ARG:反感 , 1.20
	TIMES CUP:ARG:優越 , 1.70
ELSEIF MARK:ARG:反発感情 == 1
	TIMES CUP:ARG:恭順 , 0.60
	TIMES CUP:ARG:反感 , 1.10
	TIMES CUP:ARG:優越 , 1.50
ENDIF
;-------------------------------------------------
;難易度などによる上下の処理
;-------------------------------------------------
;CUP:ARG:潤滑 = CUP:ARG:潤滑 * (16 - 4 * FLAG:4) / 10
;CUP:ARG:恭順 = CUP:ARG:恭順 * (16 - 4 * FLAG:4) / 10
;CUP:ARG:欲情 = CUP:ARG:欲情 * (16 - 4 * FLAG:4) / 10
;CUP:ARG:屈服 = CUP:ARG:屈服 * (16 - 4 * FLAG:4) / 10
;CUP:ARG:習得 = CUP:ARG:習得 * (16 - 4 * FLAG:4) / 10
;CUP:ARG:恥情 = CUP:ARG:恥情 * (16 - 4 * FLAG:4) / 10
;CUP:ARG:苦痛 = CUP:ARG:苦痛 * (16 - 4 * FLAG:4) / 10
;CUP:ARG:恐怖 = CUP:ARG:恐怖 * (16 - 4 * FLAG:4) / 10
;CUP:ARG:好意 = CUP:ARG:好意 * (16 - 4 * FLAG:4) / 10
;CUP:ARG:優越 = CUP:ARG:優越 * (16 - 4 * FLAG:4) / 10
;CUP:ARG:反感 = CUP:ARG:反感 * (8 +  4 * FLAG:4) / 10
;CUP:ARG:不快 = CUP:ARG:不快 * (8 + 4 * FLAG:4) / 10
;CUP:ARG:抑鬱 = CUP:ARG:抑鬱 * (8 + 4 * FLAG:4) / 10

;EASY
IF FLAG:難易度 == 0
	TIMES CUP:ARG:好意 , 1.20
	TIMES CUP:ARG:潤滑 , 1.20
	TIMES CUP:ARG:恭順 , 1.20
	TIMES CUP:ARG:欲情 , 1.20
	TIMES CUP:ARG:屈服 , 1.20
	TIMES CUP:ARG:習得 , 1.20
	TIMES CUP:ARG:生活 , 1.20
	TIMES CUP:ARG:恥情 , 1.20
	TIMES CUP:ARG:苦痛 , 1.20
	TIMES CUP:ARG:恐怖 , 1.20
	TIMES CUP:ARG:反感 , 0.90
	TIMES CUP:ARG:不快 , 0.90
	TIMES CUP:ARG:抑鬱 , 0.90
;NORMAL
ELSEIF FLAG:難易度 == 1
;	TIMES CUP:ARG:潤滑 , 1.20
;	TIMES CUP:ARG:恭順 , 1.20
;	TIMES CUP:ARG:欲情 , 1.20
;	TIMES CUP:ARG:屈服 , 1.20
;	TIMES CUP:ARG:習得 , 1.20
;	TIMES CUP:ARG:恥情 , 1.20
;	TIMES CUP:ARG:苦痛 , 1.20
;	TIMES CUP:ARG:恐怖 , 1.20
;	TIMES CUP:ARG:反感 , 1.20
;	TIMES CUP:ARG:不快 , 1.20
;	TIMES CUP:ARG:抑鬱 , 1.20
;HARD
ELSEIF FLAG:難易度 == 2
	TIMES CUP:ARG:好意 , 0.80
	TIMES CUP:ARG:潤滑 , 0.80
	TIMES CUP:ARG:恭順 , 0.80
	TIMES CUP:ARG:欲情 , 0.80
	TIMES CUP:ARG:屈服 , 0.80
	TIMES CUP:ARG:習得 , 0.80
	TIMES CUP:ARG:生活 , 0.80
	TIMES CUP:ARG:恥情 , 0.80
	TIMES CUP:ARG:苦痛 , 0.80
	TIMES CUP:ARG:恐怖 , 0.80
	TIMES CUP:ARG:反感 , 1.60
	TIMES CUP:ARG:不快 , 1.60
	TIMES CUP:ARG:抑鬱 , 1.60
;MASTER
ELSEIF FLAG:難易度 == 3
	TIMES CUP:ARG:好意 , 0.50
	TIMES CUP:ARG:潤滑 , 0.50
	TIMES CUP:ARG:恭順 , 0.50
	TIMES CUP:ARG:欲情 , 0.50
	TIMES CUP:ARG:屈服 , 0.50
	TIMES CUP:ARG:習得 , 0.50
	TIMES CUP:ARG:生活 , 0.50
	TIMES CUP:ARG:恥情 , 0.50
	TIMES CUP:ARG:苦痛 , 0.50
	TIMES CUP:ARG:恐怖 , 0.50
	TIMES CUP:ARG:反感 , 2.00
	TIMES CUP:ARG:不快 , 2.00
	TIMES CUP:ARG:抑鬱 , 2.00
ENDIF

;-------------------------------------------------
;相性による上下の処理
;-------------------------------------------------
R = NO:PLAYER
IF RELATION:ARG:R != 0
	CUP:ARG:欲情 *= RELATION:ARG:R
	CUP:ARG:欲情 /= 100
	CUP:ARG:屈服 *= RELATION:ARG:R
	CUP:ARG:屈服 /= 100
	CUP:ARG:恥情 *= RELATION:ARG:R
	CUP:ARG:恥情 /= 100
	CUP:ARG:反感 *= 100
	CUP:ARG:反感 /= RELATION:ARG:R
	CUP:ARG:不快 *= 100
	CUP:ARG:不快 /= RELATION:ARG:R
	CUP:ARG:抑鬱 *= 100
	CUP:ARG:抑鬱 /= RELATION:ARG:R
ENDIF

;-------------------------------------------------
;気力０による上下の処理
;-------------------------------------------------
IF BASE:ARG:1 <= 0
	;UP:0,1,2は絶頂に絡むので先に処理してある
	CUP:ARG:欲情 /= 2
	CUP:ARG:恭順 /= 2
	CUP:ARG:屈服 /= 2
	CUP:ARG:習得 /= 2
	CUP:ARG:恥情 /= 2
	CUP:ARG:恐怖 /= 2
	CUP:ARG:苦痛 /= 2

	DOWNBASE:ARG:体力 *= 2
	DOWNBASE:ARG:体力 += 80

ENDIF

;-------------------------------------------------
;苦痛からくる体力・気力の減少
;-------------------------------------------------
LOCAL = CUP:ARG:苦痛 / 20
;ABL:マゾっ気をみる
SELECTCASE ABL:ARG:マゾっ気
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 0.95
	CASE 2
		TIMES LOCAL , 0.90
	CASE 3
		TIMES LOCAL , 0.80
	CASE 4
		TIMES LOCAL , 0.65
	CASEELSE
		TIMES LOCAL , 0.50
ENDSELECT
;痛覚
;LOCAL = LOCAL * (10 + TALENT:ARG:痛覚 * 2) / 10

DOWNBASE:ARG:体力 += LOCAL
DOWNBASE:ARG:気力 += LOCAL
;DOWNBASE:ARG:疲労 += LOCAL

;FileName_SOURCE1.ERB ------------------------------ Rev1.02
;体力、気力の減少処理
;CALL		USER
;ARG		キャラNO
;RETURN		VOID
;COMMENT	
;-----------------------------------------------------------
@SOURCE_DOWNBASE(ARG)
IF ARG != NO:MASTER && TALENT:ARG:恋人 && TFLAG:うふふ
	DOWNBASE:ARG:体力 = (DOWNBASE:ARG:体力 / 10) * 7
	DOWNBASE:ARG:気力 = (DOWNBASE:ARG:気力 / 10) * 8
ENDIF
IF ARG != NO:MASTER && TEQUIP:ARG:デート中 && TFLAG:うふふ
	DOWNBASE:ARG:気力 = (DOWNBASE:ARG:気力 / 10) * 8
ENDIF

BASE:ARG:体力 = MAX(0,BASE:ARG:体力 - DOWNBASE:ARG:体力)
BASE:ARG:気力 = MAX(0,BASE:ARG:気力 - DOWNBASE:ARG:気力)

