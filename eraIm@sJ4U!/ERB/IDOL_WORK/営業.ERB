;ARG	仕事番号
@EIGYO(ARG)
;暫定
VARSET LOCAL

CALL 朝会話
PRINTL 
PRINTW ・・・・・
PRINTL 
PRINTW ・・・
PRINTL 
PRINTW ・
CALL BGM("WORK", "営業")
CALL 団結値上昇(2)

IF TIME == 0 && TIME:12 == 0
	FLAG:仕事地方 = FLAG:朝の仕事地方
ELSEIF TIME == 0 && TIME:12 == 1
	FLAG:仕事地方 = FLAG:昼の仕事地方
ELSEIF TIME == 1 && TIME:12 == 0
	FLAG:仕事地方 = FLAG:夕の仕事地方
ELSEIF TIME == 1 && TIME:12 == 1
	FLAG:仕事地方 = FLAG:夜の仕事地方
ENDIF

TSTR = %GET_WORK_NAME(ARG:0)%

IF ARG == 1302 || ARG == 1331 || ARG == 1350
	TFLAG:600 = 17
	CALL KOJO_MESSAGE_SEND("JUN")
ENDIF

PRINTFORMW 今日の%CALLNAME:TARGET%達の営業は%TSTR%だ

PRINTFORMW %CALLNAME:TARGET%達は張り切って仕事に臨んだ

PRINTFORMW ・・・・・
PRINTFORMW ・・・・
PRINTFORMW ・・・
PRINTFORMW ・・
PRINTFORMW ！
A = RAND:100
IF A <= 5
	FLAG:仕事成功 = 1
	PRINTFORMW %CALLNAME:TARGET%達の仕事は非の打ちどころの無い、完璧なモノであった！
	B = 1
ELSEIF A <= 20
	FLAG:仕事成功 = 1
	PRINTFORMW %CALLNAME:TARGET%達の仕事はなかなか上手くいったようだ！
	B = 2
ELSEIF A<= 80
	FLAG:仕事成功 = 1
	PRINTFORMW %CALLNAME:TARGET%達の仕事は問題なく終わった
	B = 3
ELSE
	PRINTFORMW %CALLNAME:TARGET%達の仕事は失敗してしまった……
	B = 4
ENDIF
;好感度30アップ
;原作では思い出アップなので代わりに
FOR LOCAL, 1080, 1085
	SIF FLAG:(LOCAL) > 0
		CFLAG:(FLAG:(LOCAL)):2 += 30
NEXT


VARSET LOCAL
;仕事番号を取得
LOCAL:1 = ARG
CALL GET_WORK_FAN(LOCAL:1)
LOCAL:4 = RESULT
CALL GET_WORK_GUARANTEE(LOCAL:1)
LOCAL:5 = RESULT
;注目度
LOCAL:6 = 36
LOCAL:1 = 0
FOR LOCAL:0, 1080, 1085
	SIF FLAG:(LOCAL:0) > 0
		LOCAL:1 += 1
NEXT
IF B == 1
	TIMES LOCAL:4, 1.50
	TIMES LOCAL:5, 1.50
ELSEIF B == 2
 	TIMES LOCAL:4, 1.20
	TIMES LOCAL:5, 1.20
ELSEIF B == 3

ELSEIF B == 4
	TIMES LOCAL:4, 0.80
	TIMES LOCAL:5, 0.80
	LOCAL:6 = 22
ENDIF
FOR LOCAL , 1080, 1085
	IF FLAG:LOCAL > 0
		SELECTCASE ABL:(FLAG:(LOCAL:0)):アイドルランク
			CASE 0
				
			CASE 1
				TIMES LOCAL:4 , 1.10
				TIMES LOCAL:5 , 1.10
			CASE 2
				TIMES LOCAL:4 , 1.20
				TIMES LOCAL:5 , 1.20
			CASE 3
				TIMES LOCAL:4 , 1.30
				TIMES LOCAL:5 , 1.30
			CASE 4
				TIMES LOCAL:4 , 1.40
				TIMES LOCAL:5 , 1.40
			CASE 5
				TIMES LOCAL:4 , 1.50
				TIMES LOCAL:5 , 1.50
			CASE 6
				TIMES LOCAL:5 , 1.60
				TIMES LOCAL:4 , 1.60
			CASE 7
				TIMES LOCAL:5 , 1.70
				TIMES LOCAL:4 , 1.70
			CASE 8
				TIMES LOCAL:5 , 1.80
				TIMES LOCAL:4 , 1.80
			CASE 9
				TIMES LOCAL:5 , 1.90
				TIMES LOCAL:4 , 1.90
			CASEELSE
				TIMES LOCAL:5 , 2.00
				TIMES LOCAL:4 , 2.00
		ENDSELECT
	ENDIF
NEXT
PRINTFORML 今回の営業で以上の結果が得られました
;PRINTFORM ファン人数　{LOCAL:4} ×(
FOR LOCAL:0, 1080, 1085
	IF FLAG:(LOCAL:0) > 0
;		PRINTFORM %CALLNAME:(FLAG:(LOCAL:0))%（{ABL:(FLAG:(LOCAL:0)):親密 + 1}）+
		LOCAL:2 += (ABL:(FLAG:(LOCAL:0)):親密 + 1)
	ENDIF
NEXT

;PRINTFORM 100) / 100 / {LOCAL:1}

PRINTL
A = LOCAL:4 * (100 + LOCAL:2) / 100 / LOCAL:1

FOR LOCAL:0, 1080, 1085
	IF FLAG:(LOCAL:0) > 0
		PRINTFORML %CALLNAME:(FLAG:(LOCAL:0))%のファン数+%ADD_COMMA(A)%人
		SELECTCASE FLAG:仕事地方
			CASE 0
				ABL:(FLAG:(LOCAL)):首都ファン数 += A
			CASE 1
				ABL:(FLAG:(LOCAL)):北東ファン数 += A
			CASE 2
				ABL:(FLAG:(LOCAL)):中央ファン数 += A
			CASE 3
				ABL:(FLAG:(LOCAL)):上方ファン数 += A
			CASE 4
				ABL:(FLAG:(LOCAL)):西ファン数 += A
			CASE 5
				ABL:(FLAG:(LOCAL)):南ファン数 += A
			CASEELSE
				PRINTFORMW エラー！不明な地方{FLAG:仕事地方}が選ばれました(EIGYO)
		ENDSELECT
	ENDIF
NEXT
PRINTL
PRINTW
PRINTFORM 報酬として%ADD_COMMA(LOCAL:5)%Ｇ獲得
MONEY:0 += LOCAL:5

SELECTCASE FLAG:仕事地方
	CASE 0
		FLAG:首都注目度 += LOCAL:6
	CASE 1
		FLAG:北東注目度 += LOCAL:6
	CASE 2
		FLAG:中央注目度 += LOCAL:6
	CASE 3
		FLAG:上方注目度 += LOCAL:6
	CASE 4
		FLAG:西注目度 += LOCAL:6
	CASE 5
		FLAG:南注目度 += LOCAL:6
	CASEELSE
		PRINTFORMW エラー！不明な地方{FLAG:仕事地方}が選ばれました(EIGYO)
ENDSELECT
;済んだ仕事はリストから消す
FOR LOCAL:0, 0, 100
	FOR LOCAL:1, 0, 100
		FOR LOCAL:2, 0, 100
			SIF TA:(LOCAL:0):(LOCAL:1):(LOCAL:2) == ARG
				TA:(LOCAL:0):(LOCAL:1):(LOCAL:2) = 0
		NEXT
	NEXT
NEXT
PRINTFORMW
