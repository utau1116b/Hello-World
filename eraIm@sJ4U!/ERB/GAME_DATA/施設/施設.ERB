@HOME_EXTEND
;LOCAL:0 設置可能フラグ
VARSET A
VARSET B
DRAWLINE
PRINTFORML どの施設を設置しますか？
;EXP:MASTER:開発Pt = 50
PRINTFORML 残りPP：{EXP:MASTER:開発Pt}Pt
DRAWLINE
;ABL:MASTER:Pランク = 5
REPEAT 35
	IF FLAG:(800 + COUNT) == 0 && COUNT == 0
		CALL PRINT_FACILITY(40, COUNT)
	ENDIF
	IF FLAG:(800 + COUNT) == 0 && COUNT == 1
		CALL PRINT_FACILITY(40, COUNT)
	ENDIF
	IF FLAG:(800 + COUNT) == 0 && COUNT == 2 && ABL:MASTER:Pランク >= 1
		CALL PRINT_FACILITY(50, COUNT)
	ENDIF
	IF FLAG:(800 + COUNT) == 0 && COUNT == 3 && ABL:MASTER:Pランク >= 1
		CALL PRINT_FACILITY(100, COUNT)
	ENDIF
	IF FLAG:(800 + COUNT) == 0 && COUNT == 4 && ABL:MASTER:Pランク >= 1
		CALL PRINT_FACILITY(50, COUNT)
	ENDIF
	IF FLAG:(800 + COUNT) == 0 && COUNT == 5 && ABL:MASTER:Pランク >= 1
		CALL PRINT_FACILITY(50, COUNT)
	ENDIF
	IF FLAG:(800 + COUNT) == 0 && COUNT == 6 && ABL:MASTER:Pランク >= 2
		CALL PRINT_FACILITY(80, COUNT)
	ENDIF
	IF FLAG:(800 + COUNT) == 0 && COUNT == 7 && ABL:MASTER:Pランク >= 2
		CALL PRINT_FACILITY(80, COUNT)
	ENDIF
	IF FLAG:(800 + COUNT) == 0 && COUNT == 8 && ABL:MASTER:Pランク >= 2
		CALL PRINT_FACILITY(100, COUNT)
	ENDIF
	IF FLAG:(800 + COUNT) == 0 && COUNT == 9 && ABL:MASTER:Pランク >= 3
		CALL PRINT_FACILITY(100, COUNT)
	ENDIF
	IF FLAG:(800 + COUNT) == 0 && COUNT == 10 && ABL:MASTER:Pランク >= 3
		CALL PRINT_FACILITY(50, COUNT)
	ENDIF
	IF FLAG:(800 + COUNT) == 0 && COUNT == 11 && ABL:MASTER:Pランク >= 3
		CALL PRINT_FACILITY(150, COUNT)
	ENDIF
	IF FLAG:(800 + COUNT) == 0 && COUNT == 12 && ABL:MASTER:Pランク >= 4
		CALL PRINT_FACILITY(140, COUNT)
	ENDIF
	IF FLAG:(800 + COUNT) == 0 && COUNT == 13 && ABL:MASTER:Pランク >= 4 && CFLAG:11:勧誘状況 == -1
		CALL PRINT_FACILITY(100, COUNT)
	ENDIF
	IF FLAG:(800 + COUNT) == 0 && COUNT == 14 && ABL:MASTER:Pランク >= 5
		CALL PRINT_FACILITY(150, COUNT)
	ENDIF
	IF FLAG:(800 + COUNT) == 0 && COUNT == 15 && ABL:MASTER:Pランク >= 5
		CALL PRINT_FACILITY(140, COUNT)
	ENDIF
	IF FLAG:(800 + COUNT) == 0 && COUNT == 16 && ABL:MASTER:Pランク >= 5
		CALL PRINT_FACILITY(150, COUNT)
	ENDIF
	IF FLAG:(800 + COUNT) == 0 && COUNT == 17 && ABL:MASTER:Pランク >= 7
		CALL PRINT_FACILITY(300, COUNT)
	ENDIF
	;IF FLAG:(800 + COUNT) == 0 && COUNT == 20
	;	CALL PRINT_FACILITY(40, COUNT)
	;ENDIF
	;IF FLAG:(800 + COUNT) == 0 && COUNT == 21 && ABL:MASTER:Pランク >= 2
	;	CALL PRINT_FACILITY(80, COUNT)
	;ENDIF
REND
PRINTFORML [100] 戻る
$INPUT_LOOP
INPUT
IF RESULT == 100
	RETURN
ELSEIF FLAG:(800 + RESULT) == 1
	REUSELASTLINE その施設は既に設置されています
	GOTO INPUT_LOOP
ELSEIF RESULT >= 0 && RESULT <= 35 && A:RESULT == 1
	CALL BUILD_FACILITY(B:RESULT, RESULT)
ELSEIF RESULT >= 0 && RESULT <= 35 && A:RESULT == 0
	REUSELASTLINE 条件を満たしていません
	GOTO INPUT_LOOP
ELSE
	REUSELASTLINE 入力値が不正です。再入力してください
	GOTO INPUT_LOOP
ENDIF
RESTART


;ARG:0	必要なポイント
;ARG:1	カウント
@PRINT_FACILITY(ARG:0, ARG:1)
;A		開発OKフラグ
;B		開発に必要なポイント
SIF EXP:MASTER:開発Pt < ARG:0
	SETCOLOR COLOR("light-gray")
PRINTFORMLC [{ARG:1,2}] %(FLAGNAME:(800 + ARG:1))%
RESETCOLOR
IF ARG:1 == 5 || ARG:1 == 8|| ARG:1 == 11
	PRINTFORM 必要Pt：
ELSEIF ARG:1 == 14
	PRINTFORM   必要Pt：
ELSE
	PRINTFORM    必要Pt：
ENDIF
SIF EXP:MASTER:開発Pt < ARG:0
	SETCOLOR 0xFF0000
PRINTFORML {ARG:0}
A:(ARG:1) = 1
B:(ARG:1) = ARG:0
RESETCOLOR

;ARG:0	必要ポイント
;ARG:1	リザルト
@BUILD_FACILITY(ARG:0, ARG:1)
IF EXP:MASTER:開発Pt >= ARG:0
	TRYCALLFORM FACILITY_EXPLAIN_{ARG:1}
ELSE
	PRINTFORMW ポイントが足りません
	RETURN
ENDIF
DRAWLINE
PRINTFORML この施設を建設しますか？
PRINTL [0] はい
PRINTL [1] いいえ
$INPUT_LOOP
INPUT
IF RESULT == 0
	EXP:MASTER:開発Pt -= ARG:0
	FLAG:(800 + ARG:1) = 1
	CALL GET_FACILITY_BONUS(ARG:1)
	PRINTFORMW %RESULTS%を建設しました
	RETURN
ELSEIF RESULT == 1
	RETURN
ELSE
	REUSELASTLINE 正しい値を入力してください
	GOTO INPUT_LOOP
ENDIF
RESTART

;ARG:0	新しく建った施設
@GET_FACILITY_BONUS(ARG:0)
IF ARG:0 == 2
ELSEIF ARG:0 == 1
	ABL:MASTER:81 = 1
ELSEIF ARG:0 == 7
	ABL:MASTER:81 = 2
ELSEIF ARG:0 == 15
	ABL:MASTER:81 = 3
ELSEIF ARG:0 == 3
	TALENT:0:55 = 1
	ABL:0:2 += 2
	ABL:0:123 += 2
ELSEIF ARG:0 == 5
	FOR LOCAL:0, 11, (11 + FLAG:キャラ数)
		IF CFLAG:(LOCAL:0):勧誘状況 == -1
		ENDIF
	NEXT
ELSEIF ARG:0 == 6
ELSEIF ARG:0 == 8
	FOR LOCAL:0, 11, (11 + FLAG:キャラ数)
		IF CFLAG:(LOCAL:0):勧誘状況 == -1
		ENDIF
	NEXT
ELSEIF ARG:0 == 10
ELSEIF ARG:0 == 11
ELSEIF ARG:0 == 12
ELSEIF ARG:0 == 13
ELSEIF ARG:0 == 14
ELSEIF ARG:0 == 16
ELSE
	RETURN
ENDIF
