@CLOTH_CHANGE(ARG)
VARSET LOCAL
DRAWLINE
PRINTFORML %CALLNAME:ARG%の衣装を着せ替えます
DRAWLINE
TSTR = 
REPEAT 22
	IF COUNT == 1
		;コスプレはウフフ中のみ可。ただし、最初からコスプレ服を着ている子は除く
		LOCALS = コスプレ服
		PRINTPLAINFORM [{COUNT,2}]%LOCALS,12,LEFT%：\@ TEQUIP:ARG:LOCALS > 0 ? %COSPLAY(ARG),24,LEFT% # %TSTR,24,LEFT% \@
		LOCAL:COUNT = 1
	ELSEIF COUNT == 2 && EQUIP:ARG:インナー > 0
		LOCALS = インナー
		PRINTPLAINFORM [{COUNT,2}]%LOCALS,12,LEFT%：\@ TEQUIP:ARG:LOCALS > 0 ? %OUTER_T2(ARG),24,LEFT% # %TSTR,24,LEFT% \@
		LOCAL:COUNT = 1
	ELSEIF COUNT == 3 && EQUIP:ARG:アウター > 0
		LOCALS = アウター
		PRINTPLAINFORM [{COUNT,2}]アウター　　：\@ TEQUIP:ARG:LOCALS > 0 ? %OUTER_T(ARG),24,LEFT% # %TSTR,24,LEFT% \@
		LOCAL:COUNT = 1
	ELSEIF COUNT == 4  && EQUIP:ARG:ボトムス > 0
		LOCALS = ボトムス
		PRINTPLAINFORM [{COUNT,2}]ボトムス　　：\@ TEQUIP:ARG:LOCALS > 0 ? %OUTER_B(ARG),24,LEFT% # %TSTR,24,LEFT% \@
		LOCAL:COUNT = 1
	ELSEIF COUNT == 5 && EQUIP:ARG:上下一体服 > 0
		LOCALS = 上下一体服
		PRINTPLAINFORM [{COUNT,2}]上下一体服　：\@ TEQUIP:ARG:LOCALS > 0 ? %DRESS(ARG),24,LEFT% # %TSTR,24,LEFT% \@
		LOCAL:COUNT = 1
	ELSEIF COUNT == 6 && EQUIP:ARG:下着（上） > 0
		LOCALS = 下着（上）
		PRINTPLAINFORM [{COUNT,2}]下着(胸)　　：\@ TEQUIP:ARG:LOCALS > 0 ? %INNER_T(ARG),24,LEFT% # %TSTR,24,LEFT% \@
		LOCAL:COUNT = 1
	ELSEIF COUNT == 7 && EQUIP:ARG:下着（下） > 0
		LOCALS = 下着（下）
		PRINTPLAINFORM [{COUNT,2}]下着(秘所)　：\@ TEQUIP:ARG:LOCALS > 0 ? %INNER_B(ARG),24,LEFT% # %TSTR,24,LEFT% \@
		LOCAL:COUNT = 1
	ELSEIF COUNT == 8 && EQUIP:ARG:下着（上下一体） > 0
		LOCALS = 下着（上下一体）
		PRINTPLAINFORM [{COUNT,2}]上下一体下着：\@ TEQUIP:ARG:LOCALS > 0 ? %INNER_TB(ARG),24,LEFT% # %TSTR,24,LEFT% \@
		LOCAL:COUNT = 1
	ELSEIF COUNT == 9 && EQUIP:ARG:頭 > 0
		LOCALS = 頭
		PRINTPLAINFORM [{COUNT,2}]頭　　　　　：\@ TEQUIP:ARG:LOCALS > 0 ? %HEAD(ARG),24,LEFT% # %TSTR,24,LEFT% \@
		LOCAL:COUNT = 1
	ELSEIF COUNT == 10 && EQUIP:ARG:手 > 0
		LOCALS = 手
		PRINTPLAINFORM [{COUNT,2}]手　　　　　：\@ TEQUIP:ARG:LOCALS > 0 ? %GLOVES(ARG),24,LEFT% # %TSTR,24,LEFT% \@
		LOCAL:COUNT = 1
	ELSEIF COUNT == 11 && EQUIP:ARG:靴下 > 0
		LOCALS = 靴下
		PRINTPLAINFORM [{COUNT,2}]靴下　　　　：\@ TEQUIP:ARG:LOCALS > 0 ? %SOCKS(ARG),24,LEFT% # %TSTR,24,LEFT% \@
		LOCAL:COUNT = 1
	;ELSEIF COUNT == 12 && CFLAG:ARG:靴 > 0
		;LOCALS = 靴
		;PRINTPLAINFORM [{COUNT,2}]靴　　　　　：\@ TEQUIP:ARG:LOCALS > 0 ? %OUTER_T2(ARG),24,LEFT% # %TSTR,24,LEFT% \@
		;LOCAL:COUNT = 1
	ELSEIF COUNT == 13 && EQUIP:ARG:オプション1 > 0
		LOCALS = オプション1
		PRINTPLAINFORM [{COUNT,2}]オプション１：\@ TEQUIP:ARG:LOCALS > 0 ? %ACCESSORY1(ARG),24,LEFT% # %TSTR,24,LEFT% \@
		LOCAL:COUNT = 1
	ELSEIF COUNT == 14 && EQUIP:ARG:オプション2 > 0
		LOCALS = オプション2
		PRINTPLAINFORM [{COUNT,2}]オプション２：\@ TEQUIP:ARG:LOCALS > 0 ? %ACCESSORY1(ARG, , 2),24,LEFT% # %TSTR,24,LEFT% \@
		LOCAL:COUNT = 1
	ELSEIF COUNT == 15 && EQUIP:ARG:オプション3 > 0
		LOCALS = オプション3
		PRINTPLAINFORM [{COUNT,2}]オプション３：\@ TEQUIP:ARG:LOCALS > 0 ? %ACCESSORY1(ARG, , 3),24,LEFT% # %TSTR,24,LEFT% \@
		LOCAL:COUNT = 1
	ELSEIF COUNT == 16 && EQUIP:ARG:オプション4 > 0
		LOCALS = オプション4
		PRINTPLAINFORM [{COUNT,2}]オプション４：\@ TEQUIP:ARG:LOCALS > 0 ? %ACCESSORY1(ARG, , 4),24,LEFT% # %TSTR,24,LEFT% \@
		LOCAL:COUNT = 1
	ELSEIF COUNT == 17 && EQUIP:ARG:オプション5 > 0
		LOCALS = オプション5
		PRINTPLAINFORM [{COUNT,2}]オプション５：\@ TEQUIP:ARG:LOCALS > 0 ? %ACCESSORY1(ARG, , 5),24,LEFT% # %TSTR,24,LEFT% \@
		LOCAL:COUNT = 1
	;ここから下は、TEQUIP:ARG:膣にＰ挿入中時など、ソース計算に関わってくるため、
	;上までと少し処理が違う（未実装）
	;膣に靴下やネクタイを詰め込むプレイとか？
	ELSEIF COUNT == 18
		LOCALS = 胸
		PRINTPLAINFORM [{COUNT,2}]乳首　　　　：\@ TEQUIP:ARG:LOCALS > 0 ? %ACCESSORY1(ARG, , 5),24,LEFT% # %TSTR,24,LEFT% \@
		LOCAL:COUNT = 1
	ELSEIF COUNT == 19
		IF TALENT:ARG:オトコ || TALENT:ARG:ふたなり
			LOCALS = ペニス
		ELSE
			LOCALS = クリトリス
		ENDIF
		PRINTPLAINFORM [{COUNT,2}]%LOCALS,12,LEFT%：\@ TEQUIP:ARG:LOCALS > 0 ? %ACCESSORY1(ARG, , 5),24,LEFT% # %TSTR,24,LEFT% \@
		LOCAL:COUNT = 1
	ELSEIF COUNT == 20
		LOCALS = 膣
		PRINTPLAINFORM [{COUNT,2}]膣　　　　　：\@ TEQUIP:ARG:LOCALS > 0 ? %ACCESSORY1(ARG, , 5),24,LEFT% # %TSTR,24,LEFT% \@
		LOCAL:COUNT = 1
	ELSEIF COUNT == 21
		LOCALS = アナル
		PRINTPLAINFORM [{COUNT,2}]アナル　　　：\@ TEQUIP:ARG:LOCALS > 0 ? %ACCESSORY1(ARG, , 5),24,LEFT% # %TSTR,24,LEFT% \@
		LOCAL:COUNT = 1
	ENDIF
	IF LOCAL:COUNT == 1 && COUNT < 18
		SIF TEQUIP:LOCALS > 0
			SETCOLOR COLOR("PASTEL-PURPLE")
		PRINTBUTTON "[着衣]",COUNT*100+1
		RESETCOLOR
		PRINT 　　　
		SIF TEQUIP:LOCALS <= 0
			SETCOLOR COLOR("PASTEL-PURPLE")
		PRINTBUTTON "[脱衣]",COUNT*100+2
		RESETCOLOR
		PRINTL
	ELSEIF LOCAL:COUNT == 1
		PRINTL
	ENDIF
REND
PRINTFORML [50]全部脱がす
PRINTFORML [51]全部着せる
PRINTFORML [ 0]着せ替え終了
;PRINTFORML [1] 全裸にする(アクセサリー以外)
;PRINTFORML [2] 上半身裸にする
;PRINTFORML [3] 下半身裸にする
;PRINTFORML [4] 全裸にする(アクセサリー込み)
;PRINTFORML [5] 靴下だけ履かせる
;PRINTFORML [6] 下着だけにする
;PRINTFORML [0] 戻る
$INPUT_LOOP
INPUT
IF RESULT == 0
	RETURN
ELSEIF RESULT <= 100 && RESULT!=50 && RESULT!=51
		REUSELASTLINE 入力値が不正です
		GOTO INPUT_LOOP
ELSE
	;IF RESULT %10!=(1|2)
	;	REUSELASTLINE 入力値が不正です
	;	GOTO INPUT_LOOP
	;ENDIF
	;一旦Aにリザルトを格納
	A = RESULT
	CALL CLOTHES_SETUP(ARG)
	SIF ASSI != 0 && ASSI != -1
		CALL CLOTHES_SETUP(ASSI)
	;結婚指輪は外せない
	;TEQUIP:ARG:エンゲージリング = EQUIP:ARG:エンゲージリング
	;着衣の場合
	IF A > 100
		IF A % 10 == 1
			SELECTCASE A/100
				CASE 13
					TEQUIP:ARG:オプション1 = EQUIP:ARG:オプション1
				CASE 14
					TEQUIP:ARG:オプション2 = EQUIP:ARG:オプション2
				CASE 15
					TEQUIP:ARG:オプション3 = EQUIP:ARG:オプション3
				CASE 16
					TEQUIP:ARG:オプション4 = EQUIP:ARG:オプション4
				CASE 17
					TEQUIP:ARG:オプション5 = EQUIP:ARG:オプション5
				CASE 9
					TEQUIP:ARG:頭 = EQUIP:ARG:頭
				CASE 10
					TEQUIP:ARG:手 = EQUIP:ARG:手
				CASE 11
					TEQUIP:ARG:靴下 = EQUIP:ARG:靴下
				CASE 7
					TEQUIP:ARG:下着（下） = EQUIP:ARG:下着（下）
				CASE 6
					TEQUIP:ARG:下着（上） = EQUIP:ARG:下着（上）
				CASE 8
					TEQUIP:ARG:下着（上下一体） = EQUIP:ARG:下着（上下一体）
				CASE 4
					TEQUIP:ARG:ボトムス = EQUIP:ARG:ボトムス
				CASE 2
					TEQUIP:ARG:インナー = EQUIP:ARG:インナー
				CASE 3
					TEQUIP:ARG:アウター = EQUIP:ARG:アウター
				CASE 5
					TEQUIP:ARG:上下一体服 = EQUIP:ARG:上下一体服
				CASE 1
					TEQUIP:ARG:コスプレ服 = EQUIP:ARG:コスプレ服
			ENDSELECT
		;脱衣の場合
		ELSEIF A%10 == 2
			;LOCAL初期化
			VARSET LOCAL
			;調教対象、調教者脱衣部位確認
			FOR LOCAL, 1, 3
				 SELECTCASE A/100
					 CASE 9
						SETBIT LOCAL:LOCAL, 0
					CASE 10
						SETBIT LOCAL:LOCAL, 1
					CASE 11
						SETBIT LOCAL:LOCAL, 2
					CASE 7
						SETBIT LOCAL:LOCAL, 3
					CASE 6
						SETBIT LOCAL:LOCAL, 4
					CASE 8
						SETBIT LOCAL:LOCAL, 5
					CASE 4
						SETBIT LOCAL:LOCAL, 6
					CASE 2
						SETBIT LOCAL:LOCAL, 7
					CASE 3
						SETBIT LOCAL:LOCAL, 8
					CASE 5
						SETBIT LOCAL:LOCAL, 9
					CASE 1
						SETBIT LOCAL:LOCAL, 10
					CASE 13
						SETBIT LOCAL:LOCAL, 11
					CASE 14
						SETBIT LOCAL:LOCAL, 12
					CASE 15
						SETBIT LOCAL:LOCAL, 13
					CASE 16
						SETBIT LOCAL:LOCAL, 14
					CASE 17
						SETBIT LOCAL:LOCAL, 15
					 CASEELSE
					 	PRINTFORMW エラー！不明なスタイル({A})が選択されました(CLOTH_CHANGE)
				ENDSELECT
			NEXT
		ENDIF
	;全部脱衣
	ELSEIF A == 50
		;LOCAL初期化
		VARSET LOCAL
		FOR LOCAL, 1, 3
			SETBIT LOCAL:LOCAL, 0
			SETBIT LOCAL:LOCAL, 1
			SETBIT LOCAL:LOCAL, 2
			SETBIT LOCAL:LOCAL, 3
			SETBIT LOCAL:LOCAL, 4
			SETBIT LOCAL:LOCAL, 5
			SETBIT LOCAL:LOCAL, 6
			SETBIT LOCAL:LOCAL, 7
			SETBIT LOCAL:LOCAL, 8
			SETBIT LOCAL:LOCAL, 9
			SETBIT LOCAL:LOCAL, 10
			SETBIT LOCAL:LOCAL, 11
			SETBIT LOCAL:LOCAL, 12
			SETBIT LOCAL:LOCAL, 13
			SETBIT LOCAL:LOCAL, 14
			SETBIT LOCAL:LOCAL, 15
		NEXT
	;全部着衣
	ELSEIF A == 51
		TEQUIP:ARG:オプション1 = EQUIP:ARG:オプション1
		TEQUIP:ARG:オプション2 = EQUIP:ARG:オプション2
		TEQUIP:ARG:オプション3 = EQUIP:ARG:オプション3
		TEQUIP:ARG:オプション4 = EQUIP:ARG:オプション4
		TEQUIP:ARG:オプション5 = EQUIP:ARG:オプション5
		TEQUIP:ARG:頭 = EQUIP:ARG:頭
		TEQUIP:ARG:手 = EQUIP:ARG:手
		TEQUIP:ARG:靴下 = EQUIP:ARG:靴下
		TEQUIP:ARG:下着（下） = EQUIP:ARG:下着（下）
		TEQUIP:ARG:下着（上） = EQUIP:ARG:下着（上）
		TEQUIP:ARG:下着（上下一体） = EQUIP:ARG:下着（上下一体）
		TEQUIP:ARG:ボトムス = EQUIP:ARG:ボトムス
		TEQUIP:ARG:インナー = EQUIP:ARG:インナー
		TEQUIP:ARG:アウター = EQUIP:ARG:アウター
		TEQUIP:ARG:上下一体服 = EQUIP:ARG:上下一体服
		TEQUIP:ARG:コスプレ服 = EQUIP:ARG:コスプレ服
	ENDIF
	;脱衣対象最適化処理(脱衣指定箇所に着衣が存在しなければ指定を解除)
	FOR LOCAL, 0, 16
		SIF GETBIT(LOCAL:2, LOCAL) && !TEQUIP:ARG:(LOCAL + 130) 
			CLEARBIT LOCAL:2, LOCAL
	NEXT
	CALLF CLOTHE_SAVE(ARG)
	;脱衣処理(実際の脱衣はここで行われる)
	FOR LOCAL, 0, 16
		SIF GETBIT(LOCAL:2, LOCAL)
			TEQUIP:ARG:(LOCAL + 130) = 0
	NEXT
	CALL DATUI_ANIME(ARG)
ENDIF
RESTART
